---
layout: post
title: Using Controller Class in Developing SSRS Reports in Microsoft Dynamics AX
  2012
date: 2014-12-17 17:35:00.000000000 +07:00
type: post
published: true
status: publish
categories: []
tags:
- Controller Class
- Microsoft Dynamics AX 2012 
- reporting services
- SrsReportRunController
meta:
  _publicize_pending: '1'
author:
  login: luannx
  email: luan52@outlook.com
  display_name: luannx
  first_name: ''
  last_name: ''
---
<h2 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.875em;color:rgb(48,49,49);">Overview</h2>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">Controller class is used to control the report execution as well as preprocessing of the report data. The SSRS reporting framework uses this class to modify the report dialogs, calling the SQL Server reporting services, as well preprocessing parameters for the report.</p>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">Following are the scenarios where Controller class can be used:</p>
<ol style="margin-bottom:1.25em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;">Modifying a report query based on the input data</li>
<li style="line-height:1.75em;">Modifying report contract data based on the input data</li>
<li style="line-height:1.75em;">Control a report parameters dialog</li>
<li style="line-height:1.75em;">Open different reports/designs from the same menu item based on the input data</li>
<li style="line-height:1.75em;">Reports that are opened from a form</li>
</ol>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">To create a controller class, extend it with&nbsp;<b>SrsReportRunController</b>.</p>
<h2 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.875em;color:rgb(48,49,49);">Prerequisites</h2>
<ol style="margin-bottom:1.25em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;">Microsoft Dynamics AX 2012</li>
<li style="line-height:1.75em;">Reporting services extensions must be installed in Dynamics AX</li>
</ol>
<h2 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.875em;color:rgb(48,49,49);">Sample Controller Class</h2>
<ol style="margin-bottom:1.25em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;">Create a new class. Open AOT → Classes</li>
<li style="line-height:1.75em;">Right Click on&nbsp;<b>Classes</b>&nbsp;and select&nbsp;<b>New Class</b>. Name it as&nbsp;<b>SSRSDemoController</b>.</li>
</ol>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;"><img class="alignnone size-full wp-image-2123" alt="example of creating a new class in Dynamics AX" src="{{ site.baseurl }}/assets/new-class-ax.png?f5308f" width="319" height="229" style="height:auto;" /><br />&nbsp;</p>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Open the Class declaration by right clicking on it and selecting&nbsp;<b>View code</b>.</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;"><img class="alignnone size-full wp-image-2124" alt="example of viewing code in AOT class AX" src="{{ site.baseurl }}/assets/aot-classes-view-code.png?f5308f" width="370" height="321" style="height:auto;" /><br />&nbsp;</p>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Now write the following code:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">class SSRSDemoController extends SrsReportRunController

{

}</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Create a new method and write the following code:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">public static client void main(Args args)

{

//define the new object for controller class

SSRSDemoController ssrsDemoController;

ssrsDemoController = new SSRSDemoController();

//pass the caller args to the controller

ssrsDemoController.parmArgs(args);

//set the report name and report design to run

ssrsDemoController.parmReportName(ssrsReportStr(SSRSSessionQuery,Design));

//execute the report

ssrsDemoController.startOperation();

}</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<h2 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.875em;color:rgb(48,49,49);">Examples of Controller Class Usage</h2>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">Based on different scenarios, different methods are overridden as shown in the following examples:</p>
<ol style="margin-bottom:1.25em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;">
<h3 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.25em;">Modifying report query based on the input data</h3>
</li>
</ol>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Used in those scenarios where a report query needs to be modified based on the caller args parameters or recorded before the report parameter dialog is rendered.</li>
<li style="line-height:1.75em;margin-bottom:.5em;">Override prePromptModifyContract method to modify the report query as shown below:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">public void prePromptModifyContract()
{
    //add a range in the report query  
      SrsReportHelper::addParameterValueRangeToQuery(this.getFirstQuery(),tableNum(SSRSReportDemo),fieldNum(SSRSReportDemo, RecId),SysQuery::value(this.parmArgs().record().RecId));
}</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;"><em>Note: prePromptModifyContract is called by report controller before the parameter dialog is shown to the User.</em></p>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">
<h3 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.25em;">Modifying report contract data based on the input data</h3>
</li>
</ul>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Used in those scenarios where report contract parameters need to be modified based on the caller args prior to the execution of the report.</li>
<li style="line-height:1.75em;margin-bottom:.5em;">Override preRunModifyContract method to modify the report contract as shown below:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">protected void preRunModifyContract()
{    
    //define object for report contract
    SSRSDemoContract contract;

    //get the reference of the current contract object
    contract = this.parmReportContract().parmRdpContract() as SSRSDemoContract;

    //modify the parameter value of the contract
    contract.parmType(this.parmArgs().parm()); 
}</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;"><em>Note: preRunModifyContract is called by report controller before the report is run.</em></p>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">
<h3 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.25em;">Control report parameters dialog</h3>
</li>
</ul>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">In some scenarios, a report parameter dialog should not be visible to the end user. Controller class is also used to control the visibility of the report parameter UI.</li>
<li style="line-height:1.75em;margin-bottom:.5em;">Add the following code in the main method of the controller class before startOperation method call to hide/show the report parameter UI:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">//hide the report parameter dialog
ssrsDemoController.parmShowDialog(false);</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">
<h3 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.25em;">Open different reports from the same menu item based on the input data</h3>
</li>
</ul>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">It is used in those scenarios where different reports or different designs of a same report need to be opened from a same menu item depending upon the caller args.</li>
<li style="line-height:1.75em;margin-bottom:.5em;">Write the following code in main method to achieve this scenario:</li>
</ul>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<pre class="crayon-plain-tag" style="font-family:monospace, serif;font-size:12px;white-space:pre-wrap;color:rgb(48,49,49);background-color:rgb(255,255,255);">public static client void main(Args args)
{    
    //define the new object for controller class
    SSRSDemoController ssrsDemoController;
   
    ssrsDemoController = new SSRSDemoController();
    
    //pass the caller args to the controller
    ssrsDemoController.parmArgs(args);
        
    //if report is run from edit mode then run the EditDesign of the report otherwise run the NewDesign of the report
    if(args.parmEnum() == FormOpenMode::ForEdit)
    {
        //set the report name and report design to run
        ssrsDemoController.parmReportName(ssrsReportStr(SSRSSessionQuery,EditDesign));    
    }
    else
    {
        //set the report name and report design to run
        ssrsDemoController.parmReportName(ssrsReportStr(SSRSSessionQuery,NewDesign));    
    }   
    
    //execute the report
    ssrsDemoController.startOperation();   
}</pre>
<p style="margin-bottom:.5em;line-height:1.625em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;">
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">
<h3 style="font-family:'Segoe UI Light', 'Segoe UI', Segoe, Tahoma, Arial;line-height:1.2em;margin-top:0;margin-bottom:.33em;font-size:1.25em;">Reports that are opened from a form</h3>
</li>
</ul>
<ul style="margin-bottom:.5em;color:rgb(48,49,49);font-family:'Segoe UI', Tahoma, Arial, sans-serif;font-size:16px;line-height:17.4545px;">
<li style="line-height:1.75em;margin-bottom:.5em;">Controller class is also used when reports are opened from a form and are needed to show selected record details.</li>
<li style="line-height:1.75em;margin-bottom:.5em;">Use either prePromptModifyContract method or preRunModifyContract method to achieve this scenario.</li>
</ul>
