---
layout: post
title: Create and write to XML file in Dynamics AX
date: 2015-02-04 08:46:00.000000000 +07:00
type: post
published: true
status: publish
categories: []
tags: []
meta:
  _publicize_pending: '1'
author:
  login: luannx
  email: luan52@outlook.com
  display_name: luannx
  first_name: ''
  last_name: ''
---
<p>[ad]</p>
<p>In this post let’s explore creating XML using X++ code in Dynamics AX.&nbsp;</p>
<p>The following example shows how to create and write data to an XML file by using the&nbsp;<span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;font-style:italic;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;font-weight:bold;">XmlDocument</span>,&nbsp;<span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;font-style:italic;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;font-weight:bold;">XmlElement</span>, and&nbsp;<span style="font-style:italic;font-weight:bold;"><span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XmlWriter</span>&nbsp;</span>classes. It loops through all of the records in the&nbsp;<span style="font-style:italic;font-weight:bold;"><span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">CarTable</span>&nbsp;</span>and find all the fields in the table automatically by using <span style="font-weight:bold;font-style:italic;">the<span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DictTable</span>&nbsp;</span>and&nbsp;<span style="font-style:italic;font-weight:bold;"><span style="border-image-source:initial;border-image-slice:initial;border-image-width:initial;border-image-outset:initial;border-image-repeat:initial;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DictField</span>&nbsp;</span>classes.</p>
<p>[more]</p>
<p></p>
<div style="border:0;margin:0 0 0 24pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<table border="0" style="border:1px solid rgb(231,231,231);margin:0 0 22px;padding:0;vertical-align:baseline;width:612px;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<tbody style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<tr style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<td style="border:1pt solid rgb(163,163,163);margin:0;padding:5px;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="line-height:1.42857143;background-color:transparent;">static void WriteXml(Args _args)</span></div>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<p style="text-align:justify;border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XmlDocument xmlDoc;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XmlElement xmlRoot;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XmlElement xmlField;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XmlElement xmlRecord;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">XMLWriter xmlWriter;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">CarTable carTable;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DictTable dTable = new DictTable(tablenum(CarTable));</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DictField dField;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int i, fieldId;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">str value;</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">;</span><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></p></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">#CarsXmlTags<span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></p></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Create a new object of the XmlDocument class</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlDoc = XmlDocument::newBlank();</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div>
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Create the root node</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRoot = xmlDoc.createElement(#CarRootNode);</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div>
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Loop through all the records in the carTable</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">while select carTable</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Create a XmlElement (record) to hold the</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// contents of the current record.</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRecord = xmlDoc.createElement(#CarRecords);</p>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div>
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Loop through all the fields in the record</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for (i=1; i&lt;=dTable.fieldCnt(); i++)</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Get the fieldId from the field-count</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">fieldId = dTable.fieldCnt2Id(i);</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Find the DictField object that matches the fieldId</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">dField = dTable.fieldObject(fieldId);</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div>
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Skip system fields</span></p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if (dField.isSystem())</p>
<p style="text-align:justify;border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">continue;</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<div style="text-align:justify;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></div>
<p>&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Create a new XmlElement (field) and</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// have the name equal to the name of the</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// dictField</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlField = xmlDoc.createElement(<span class="skimlinks-unlinked" style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">dField.name</span>());</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Convert values to string. I have just added</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// a couple of conversion as an example.</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Use tableName.(fieldId) instead of fieldname</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// to get the content of the field.</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">switch (dField.baseType())</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">case Types::Int64 :</p>
<p style="border:0;margin-bottom:20px;margin-left:135pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">value = int642str(carTable.(fieldId));</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">break;</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">case Types::Integer :</p>
<p style="border:0;margin-bottom:20px;margin-left:135pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">value = int2str(carTable.(fieldId));</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">break;</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">default :</p>
<p style="border:0;margin-bottom:20px;margin-left:135pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">value = carTable.(fieldId);</p>
<p style="border:0;margin-bottom:20px;margin-left:108pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">break;</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Set the innerText of the XmlElement (field)</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// to the value from the table</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlField.innerText(value);</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Append the field as a child node to the record</span></p>
<p style="border:0;margin-bottom:20px;margin-left:81pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRecord.appendChild(xmlField);</p>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}</p>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Add the record as a child node to the root</span></p>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRoot.appendChild(xmlRecord);</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Add the root to the XmlDocument</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlDoc.appendChild(xmlRoot);</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Create a new object of the XmlWriter class</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// in order to be able to write the xml to a file</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlWriter = XMLWriter::newFile(@”c:temp<span class="skimlinks-unlinked" style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">cars.xml</span>”);</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Write the content of the XmlDocument to the</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// file as specified by the XmlWriter</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlDoc.writeTo(xmlWriter);</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}</p>
</td>
</tr>
</tbody>
</table>
</div>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">The file that is created looks like the one in the following screenshot(only first part of the file is shown):</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</p>
<div style="border:0;margin:0 0 0 24pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><img src="{{ site.baseurl }}/assets/create-and-write-to-file-in-dynamics-ax_1.png" style="width:352px;" /></div>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">As you can see, this file is based on a standard XML format with tags and values only. You can, however, use tag attributes as well. To put the values from the table into tag attributes instead of their own tags, simply change the following code snippet in the example above</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<div style="border:0;margin:0 0 0 50pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<table border="0" style="border:1px solid rgb(231,231,231);margin:0 0 22px;padding:0;vertical-align:baseline;width:577px;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<colgroup>
<col span="1" style="width:313px;" /></colgroup>
<tbody style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<tr style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<td style="border:1pt solid rgb(163,163,163);margin:0;padding:5px;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Set the innerText of the XmlElement (field)</span>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"></p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// to the value from the table</span></p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlField.innerText(value);</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-size:14px;line-height:1.42857143;background-color:transparent;">&nbsp;</span></p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Append the field as a child node to the record</span></p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRecord.appendChild(xmlField);</p>
</td>
</tr>
</tbody>
</table>
</div>
<p style="border:0;margin-bottom:20px;margin-left:54pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;<br />&nbsp;</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">With these lines:</p>
<div style="border:0;margin:0 0 0 50pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<table border="0" style="border:1px solid rgb(231,231,231);margin:0 0 22px;padding:0;vertical-align:baseline;width:577px;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<colgroup>
<col span="1" style="width:299px;" /></colgroup>
<tbody style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<tr style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">
<td style="border:1pt solid rgb(163,163,163);margin:0;padding:5px;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="font-style:italic;">// Add the attribute to the record</span>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"></p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">xmlRecord.setAttribute(<span class="skimlinks-unlinked" style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">dField.name</span>(), value);</p>
</td>
</tr>
</tbody>
</table>
</div>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;</p>
<p style="border:0;margin-bottom:20px;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">The file that is created now looks like the one in the following screenshot:<span style="line-height:1.42857143;">&nbsp;</span></p>
<p style="border:0;margin-bottom:20px;margin-left:27pt;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="border:0;margin:0;padding:0;vertical-align:baseline;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><img src="{{ site.baseurl }}/assets/create-and-write-to-file-in-dynamics-ax.png" style="width:576px;" /><br /></span></p>
<div></div>
