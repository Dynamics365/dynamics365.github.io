---
layout: post
title: Execute Stored Procedure from X++ code
date: 2015-05-12 16:28:00.000000000 +07:00
type: post
published: true
status: publish
categories: []
tags:
- Server method
- Stored Procedure
- X++ code
meta:
  _publicize_pending: '1'
author:
  login: luannx
  email: luan52@outlook.com
  display_name: luannx
  first_name: ''
  last_name: ''
---
<p><span style="color:rgb(17,17,17);font-family:'Segoe UI', Arial, sans-serif;line-height:normal;">To execute a stored procedure from X++ use the&nbsp;</span><strong style="margin:0;padding:0;border:0;color:rgb(17,17,17);font-family:'Segoe UI', Arial, sans-serif;line-height:normal;">Server</strong><span style="color:rgb(17,17,17);font-family:'Segoe UI', Arial, sans-serif;line-height:normal;">&nbsp;method, the Client method does not have permissions. Following is the screen shot of the code from Server method. you don't require any special privileges or permissions to execute a stored procedure. if used other then Server method, a message should appear like this 'Request for the permission of type 'SqlStatementExecutePermission failed.'</span></p>
<blockquote><p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">static</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> main(</span><span style="font-size:9.5pt;font-family:Consolas;color:rgb(43,145,175);background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">AssemblyLoadEventArgs</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> _args)</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; Connection<br />
con = </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Connection();</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; Statement<br />
stmt = </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Con.createStatement();</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; ResultSet r;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; str sql;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;<br />
SqlStatementExecutePermission perm;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; sql = stmt(</span><span style="font-size:9.5pt;font-family:Consolas;color:rgb(163,21,21);background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">'EXEC [StoreprocedureName]'</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; perm = </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> SqlStatementExecutePermission(sql);</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;<br />
perm.assert();</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"></span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; {</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />
stmt.executeUpdate(sql);</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; }</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; </span><span style="font-size:9.5pt;font-family:Consolas;color:blue;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (Exception::Error)</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; {</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; print </span><span style="font-size:9.5pt;font-family:Consolas;color:rgb(163,21,21);background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"An error occured in the<br />
query"</span><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; pause;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp; }</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;</span></p>
<p class="MsoNormal" style="margin-bottom:0;margin-bottom:.0001pt;line-height:normal;"><span style="font-size:9.5pt;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&nbsp;&nbsp;&nbsp;<br />
CodeAccessPermission::revertAssert();</span></p>
<p class="MsoNormal"><span style="font-size:9.5pt;line-height:115%;font-family:Consolas;color:black;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}</span></p>
</blockquote>
<p style="font-family:'Segoe UI', Arial, sans-serif;line-height:normal;color:rgb(17,17,17);">create a job and write the above code</p>
<p style="font-family:'Segoe UI', Arial, sans-serif;line-height:normal;color:rgb(17,17,17);">When creating a table from AOT in Dynamics AX, developers often forget to right click and save the table, specially the developers habituated to SQL Server. There could be column names conflict if not saved in AOT and eventually the changes might be lost and cause other problems.</p>
<p style="font-family:'Segoe UI', Arial, sans-serif;line-height:normal;color:rgb(17,17,17);">Note : If creating a table from AOT in Dynamics AX then there will be couple of default columns added to your table like&nbsp;<strong style="margin:0;padding:0;border:0;">RECID</strong>,&nbsp;<strong style="margin:0;padding:0;border:0;">RECVERSION</strong>,&nbsp;<strong style="margin:0;padding:0;border:0;">DATAAREAID</strong>&nbsp;and etc. Make sure to include and insert values into those fields.</p>
