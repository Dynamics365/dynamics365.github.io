<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Useful functions to use in AX 2012 - Dynamics 365 Finance & Operations | nuxulu.com</title><meta name=Description content="Useful functions to use in AX 2012"><meta property="og:title" content="Useful functions to use in AX 2012"><meta property="og:description" content="Useful functions to use in AX 2012"><meta property="og:type" content="article"><meta property="og:url" content="https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/"><meta property="og:image" content="https://nuxulu.com/Icon/mstile-150x150.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2016-12-30T00:00:00+00:00"><meta property="article:modified_time" content="2016-12-30T00:00:00+00:00"><meta property="og:site_name" content="Dynamics 365 Finance & Operations"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nuxulu.com/Icon/mstile-150x150.png"><meta name=twitter:title content="Useful functions to use in AX 2012"><meta name=twitter:description content="Useful functions to use in AX 2012"><meta name=application-name content="Dynamics 365 Finance & Operations"><meta name=apple-mobile-web-app-title content="Dynamics 365 Finance & Operations"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel=icon href=/Icon/favicon.ico><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/><link rel=prev href=https://nuxulu.com/2016-12-29-crud-purchase-requisition-using-aif-in-dynamics-ax-2012-r3/><link rel=next href=https://nuxulu.com/2017-01-01-difference-between-queryfilter-and-querybuildrange/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="f08c47fec0942fa0"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Useful functions to use in AX 2012","inLanguage":"en","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/nuxulu.com\/2016-12-30-useful-functions-to-use-in-ax-2012\/"},"image":[{"@type":"ImageObject","url":"https:\/\/nuxulu.com\/images\/Apple-Devices-Preview.png","width":3200,"height":2048}],"genre":"posts","keywords":"xpp","wordcount":4335,"url":"https:\/\/nuxulu.com\/2016-12-30-useful-functions-to-use-in-ax-2012\/","datePublished":"2016-12-30T00:00:00+00:00","dateModified":"2016-12-30T00:00:00+00:00","publisher":{"@type":"Organization","name":"xxxx","logo":{"@type":"ImageObject","url":"https:\/\/nuxulu.com\/images\/avatar.png","width":528,"height":560}},"author":{"@type":"Person","name":"Max Nguyen"},"description":"Useful functions to use in AX 2012"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3534873375492458" crossorigin=anonymous></script>
<a href=/ title="Dynamics 365 Finance & Operations | nuxulu.com"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/Icon/favicon-32x32.png data-srcset="/Icon/favicon-32x32.png, /Icon/favicon-32x32.png 1.5x, /Icon/favicon-32x32.png 2x" data-sizes=auto alt=/Icon/favicon-32x32.png title=/Icon/favicon-32x32.png><span class=header-title-pre> </span>Dynamics 365 Finance & Operations</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>Posts </a><a class=menu-item href=/tags/>Tags </a><a class=menu-item href=/categories/>Categories </a><a class=menu-item href=/finopsnews/>D365 Feed </a><a class=menu-item href=/erd/default.htm>AX ERD </a><a class=menu-item href=/posts/index.xml>RSS </a><a class=menu-item href=/lab/>Labs </a><a class=menu-item href=/about/>About me </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder="Search titles or contents..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3534873375492458" crossorigin=anonymous></script>
<a href=/ title="Dynamics 365 Finance & Operations | nuxulu.com"><img class="lazyload logo" src=/svg/loading.min.svg data-src=/Icon/favicon-32x32.png data-srcset="/Icon/favicon-32x32.png, /Icon/favicon-32x32.png 1.5x, /Icon/favicon-32x32.png 2x" data-sizes=auto alt=/Icon/favicon-32x32.png title=/Icon/favicon-32x32.png><span class=header-title-pre> </span>Dynamics 365 Finance & Operations</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Search titles or contents..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=Search><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Clear><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Cancel</a></div><a class=menu-item href=/posts/ title>Posts</a><a class=menu-item href=/tags/ title>Tags</a><a class=menu-item href=/categories/ title>Categories</a><a class=menu-item href=/finopsnews/ title>D365 Feed</a><a class=menu-item href=/erd/default.htm title>AX ERD</a><a class=menu-item href=/posts/index.xml title>RSS</a><a class=menu-item href=/lab/ title>Labs</a><a class=menu-item href=/about/ title>About me</a><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme">
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Useful functions to use in AX 2012</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/about/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Max Nguyen</a></span>&nbsp;<span class=post-category>included in <a href=/categories/ax2012/><i class="far fa-folder fa-fw" aria-hidden=true></i>AX2012</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime="December 30, 2016">December 30, 2016</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;4335 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;21 minutes&nbsp;</div></div><div class=content id=content><p>Useful functions to use in AX 2012</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>   1
</span><span class=lnt>   2
</span><span class=lnt>   3
</span><span class=lnt>   4
</span><span class=lnt>   5
</span><span class=lnt>   6
</span><span class=lnt>   7
</span><span class=lnt>   8
</span><span class=lnt>   9
</span><span class=lnt>  10
</span><span class=lnt>  11
</span><span class=lnt>  12
</span><span class=lnt>  13
</span><span class=lnt>  14
</span><span class=lnt>  15
</span><span class=lnt>  16
</span><span class=lnt>  17
</span><span class=lnt>  18
</span><span class=lnt>  19
</span><span class=lnt>  20
</span><span class=lnt>  21
</span><span class=lnt>  22
</span><span class=lnt>  23
</span><span class=lnt>  24
</span><span class=lnt>  25
</span><span class=lnt>  26
</span><span class=lnt>  27
</span><span class=lnt>  28
</span><span class=lnt>  29
</span><span class=lnt>  30
</span><span class=lnt>  31
</span><span class=lnt>  32
</span><span class=lnt>  33
</span><span class=lnt>  34
</span><span class=lnt>  35
</span><span class=lnt>  36
</span><span class=lnt>  37
</span><span class=lnt>  38
</span><span class=lnt>  39
</span><span class=lnt>  40
</span><span class=lnt>  41
</span><span class=lnt>  42
</span><span class=lnt>  43
</span><span class=lnt>  44
</span><span class=lnt>  45
</span><span class=lnt>  46
</span><span class=lnt>  47
</span><span class=lnt>  48
</span><span class=lnt>  49
</span><span class=lnt>  50
</span><span class=lnt>  51
</span><span class=lnt>  52
</span><span class=lnt>  53
</span><span class=lnt>  54
</span><span class=lnt>  55
</span><span class=lnt>  56
</span><span class=lnt>  57
</span><span class=lnt>  58
</span><span class=lnt>  59
</span><span class=lnt>  60
</span><span class=lnt>  61
</span><span class=lnt>  62
</span><span class=lnt>  63
</span><span class=lnt>  64
</span><span class=lnt>  65
</span><span class=lnt>  66
</span><span class=lnt>  67
</span><span class=lnt>  68
</span><span class=lnt>  69
</span><span class=lnt>  70
</span><span class=lnt>  71
</span><span class=lnt>  72
</span><span class=lnt>  73
</span><span class=lnt>  74
</span><span class=lnt>  75
</span><span class=lnt>  76
</span><span class=lnt>  77
</span><span class=lnt>  78
</span><span class=lnt>  79
</span><span class=lnt>  80
</span><span class=lnt>  81
</span><span class=lnt>  82
</span><span class=lnt>  83
</span><span class=lnt>  84
</span><span class=lnt>  85
</span><span class=lnt>  86
</span><span class=lnt>  87
</span><span class=lnt>  88
</span><span class=lnt>  89
</span><span class=lnt>  90
</span><span class=lnt>  91
</span><span class=lnt>  92
</span><span class=lnt>  93
</span><span class=lnt>  94
</span><span class=lnt>  95
</span><span class=lnt>  96
</span><span class=lnt>  97
</span><span class=lnt>  98
</span><span class=lnt>  99
</span><span class=lnt> 100
</span><span class=lnt> 101
</span><span class=lnt> 102
</span><span class=lnt> 103
</span><span class=lnt> 104
</span><span class=lnt> 105
</span><span class=lnt> 106
</span><span class=lnt> 107
</span><span class=lnt> 108
</span><span class=lnt> 109
</span><span class=lnt> 110
</span><span class=lnt> 111
</span><span class=lnt> 112
</span><span class=lnt> 113
</span><span class=lnt> 114
</span><span class=lnt> 115
</span><span class=lnt> 116
</span><span class=lnt> 117
</span><span class=lnt> 118
</span><span class=lnt> 119
</span><span class=lnt> 120
</span><span class=lnt> 121
</span><span class=lnt> 122
</span><span class=lnt> 123
</span><span class=lnt> 124
</span><span class=lnt> 125
</span><span class=lnt> 126
</span><span class=lnt> 127
</span><span class=lnt> 128
</span><span class=lnt> 129
</span><span class=lnt> 130
</span><span class=lnt> 131
</span><span class=lnt> 132
</span><span class=lnt> 133
</span><span class=lnt> 134
</span><span class=lnt> 135
</span><span class=lnt> 136
</span><span class=lnt> 137
</span><span class=lnt> 138
</span><span class=lnt> 139
</span><span class=lnt> 140
</span><span class=lnt> 141
</span><span class=lnt> 142
</span><span class=lnt> 143
</span><span class=lnt> 144
</span><span class=lnt> 145
</span><span class=lnt> 146
</span><span class=lnt> 147
</span><span class=lnt> 148
</span><span class=lnt> 149
</span><span class=lnt> 150
</span><span class=lnt> 151
</span><span class=lnt> 152
</span><span class=lnt> 153
</span><span class=lnt> 154
</span><span class=lnt> 155
</span><span class=lnt> 156
</span><span class=lnt> 157
</span><span class=lnt> 158
</span><span class=lnt> 159
</span><span class=lnt> 160
</span><span class=lnt> 161
</span><span class=lnt> 162
</span><span class=lnt> 163
</span><span class=lnt> 164
</span><span class=lnt> 165
</span><span class=lnt> 166
</span><span class=lnt> 167
</span><span class=lnt> 168
</span><span class=lnt> 169
</span><span class=lnt> 170
</span><span class=lnt> 171
</span><span class=lnt> 172
</span><span class=lnt> 173
</span><span class=lnt> 174
</span><span class=lnt> 175
</span><span class=lnt> 176
</span><span class=lnt> 177
</span><span class=lnt> 178
</span><span class=lnt> 179
</span><span class=lnt> 180
</span><span class=lnt> 181
</span><span class=lnt> 182
</span><span class=lnt> 183
</span><span class=lnt> 184
</span><span class=lnt> 185
</span><span class=lnt> 186
</span><span class=lnt> 187
</span><span class=lnt> 188
</span><span class=lnt> 189
</span><span class=lnt> 190
</span><span class=lnt> 191
</span><span class=lnt> 192
</span><span class=lnt> 193
</span><span class=lnt> 194
</span><span class=lnt> 195
</span><span class=lnt> 196
</span><span class=lnt> 197
</span><span class=lnt> 198
</span><span class=lnt> 199
</span><span class=lnt> 200
</span><span class=lnt> 201
</span><span class=lnt> 202
</span><span class=lnt> 203
</span><span class=lnt> 204
</span><span class=lnt> 205
</span><span class=lnt> 206
</span><span class=lnt> 207
</span><span class=lnt> 208
</span><span class=lnt> 209
</span><span class=lnt> 210
</span><span class=lnt> 211
</span><span class=lnt> 212
</span><span class=lnt> 213
</span><span class=lnt> 214
</span><span class=lnt> 215
</span><span class=lnt> 216
</span><span class=lnt> 217
</span><span class=lnt> 218
</span><span class=lnt> 219
</span><span class=lnt> 220
</span><span class=lnt> 221
</span><span class=lnt> 222
</span><span class=lnt> 223
</span><span class=lnt> 224
</span><span class=lnt> 225
</span><span class=lnt> 226
</span><span class=lnt> 227
</span><span class=lnt> 228
</span><span class=lnt> 229
</span><span class=lnt> 230
</span><span class=lnt> 231
</span><span class=lnt> 232
</span><span class=lnt> 233
</span><span class=lnt> 234
</span><span class=lnt> 235
</span><span class=lnt> 236
</span><span class=lnt> 237
</span><span class=lnt> 238
</span><span class=lnt> 239
</span><span class=lnt> 240
</span><span class=lnt> 241
</span><span class=lnt> 242
</span><span class=lnt> 243
</span><span class=lnt> 244
</span><span class=lnt> 245
</span><span class=lnt> 246
</span><span class=lnt> 247
</span><span class=lnt> 248
</span><span class=lnt> 249
</span><span class=lnt> 250
</span><span class=lnt> 251
</span><span class=lnt> 252
</span><span class=lnt> 253
</span><span class=lnt> 254
</span><span class=lnt> 255
</span><span class=lnt> 256
</span><span class=lnt> 257
</span><span class=lnt> 258
</span><span class=lnt> 259
</span><span class=lnt> 260
</span><span class=lnt> 261
</span><span class=lnt> 262
</span><span class=lnt> 263
</span><span class=lnt> 264
</span><span class=lnt> 265
</span><span class=lnt> 266
</span><span class=lnt> 267
</span><span class=lnt> 268
</span><span class=lnt> 269
</span><span class=lnt> 270
</span><span class=lnt> 271
</span><span class=lnt> 272
</span><span class=lnt> 273
</span><span class=lnt> 274
</span><span class=lnt> 275
</span><span class=lnt> 276
</span><span class=lnt> 277
</span><span class=lnt> 278
</span><span class=lnt> 279
</span><span class=lnt> 280
</span><span class=lnt> 281
</span><span class=lnt> 282
</span><span class=lnt> 283
</span><span class=lnt> 284
</span><span class=lnt> 285
</span><span class=lnt> 286
</span><span class=lnt> 287
</span><span class=lnt> 288
</span><span class=lnt> 289
</span><span class=lnt> 290
</span><span class=lnt> 291
</span><span class=lnt> 292
</span><span class=lnt> 293
</span><span class=lnt> 294
</span><span class=lnt> 295
</span><span class=lnt> 296
</span><span class=lnt> 297
</span><span class=lnt> 298
</span><span class=lnt> 299
</span><span class=lnt> 300
</span><span class=lnt> 301
</span><span class=lnt> 302
</span><span class=lnt> 303
</span><span class=lnt> 304
</span><span class=lnt> 305
</span><span class=lnt> 306
</span><span class=lnt> 307
</span><span class=lnt> 308
</span><span class=lnt> 309
</span><span class=lnt> 310
</span><span class=lnt> 311
</span><span class=lnt> 312
</span><span class=lnt> 313
</span><span class=lnt> 314
</span><span class=lnt> 315
</span><span class=lnt> 316
</span><span class=lnt> 317
</span><span class=lnt> 318
</span><span class=lnt> 319
</span><span class=lnt> 320
</span><span class=lnt> 321
</span><span class=lnt> 322
</span><span class=lnt> 323
</span><span class=lnt> 324
</span><span class=lnt> 325
</span><span class=lnt> 326
</span><span class=lnt> 327
</span><span class=lnt> 328
</span><span class=lnt> 329
</span><span class=lnt> 330
</span><span class=lnt> 331
</span><span class=lnt> 332
</span><span class=lnt> 333
</span><span class=lnt> 334
</span><span class=lnt> 335
</span><span class=lnt> 336
</span><span class=lnt> 337
</span><span class=lnt> 338
</span><span class=lnt> 339
</span><span class=lnt> 340
</span><span class=lnt> 341
</span><span class=lnt> 342
</span><span class=lnt> 343
</span><span class=lnt> 344
</span><span class=lnt> 345
</span><span class=lnt> 346
</span><span class=lnt> 347
</span><span class=lnt> 348
</span><span class=lnt> 349
</span><span class=lnt> 350
</span><span class=lnt> 351
</span><span class=lnt> 352
</span><span class=lnt> 353
</span><span class=lnt> 354
</span><span class=lnt> 355
</span><span class=lnt> 356
</span><span class=lnt> 357
</span><span class=lnt> 358
</span><span class=lnt> 359
</span><span class=lnt> 360
</span><span class=lnt> 361
</span><span class=lnt> 362
</span><span class=lnt> 363
</span><span class=lnt> 364
</span><span class=lnt> 365
</span><span class=lnt> 366
</span><span class=lnt> 367
</span><span class=lnt> 368
</span><span class=lnt> 369
</span><span class=lnt> 370
</span><span class=lnt> 371
</span><span class=lnt> 372
</span><span class=lnt> 373
</span><span class=lnt> 374
</span><span class=lnt> 375
</span><span class=lnt> 376
</span><span class=lnt> 377
</span><span class=lnt> 378
</span><span class=lnt> 379
</span><span class=lnt> 380
</span><span class=lnt> 381
</span><span class=lnt> 382
</span><span class=lnt> 383
</span><span class=lnt> 384
</span><span class=lnt> 385
</span><span class=lnt> 386
</span><span class=lnt> 387
</span><span class=lnt> 388
</span><span class=lnt> 389
</span><span class=lnt> 390
</span><span class=lnt> 391
</span><span class=lnt> 392
</span><span class=lnt> 393
</span><span class=lnt> 394
</span><span class=lnt> 395
</span><span class=lnt> 396
</span><span class=lnt> 397
</span><span class=lnt> 398
</span><span class=lnt> 399
</span><span class=lnt> 400
</span><span class=lnt> 401
</span><span class=lnt> 402
</span><span class=lnt> 403
</span><span class=lnt> 404
</span><span class=lnt> 405
</span><span class=lnt> 406
</span><span class=lnt> 407
</span><span class=lnt> 408
</span><span class=lnt> 409
</span><span class=lnt> 410
</span><span class=lnt> 411
</span><span class=lnt> 412
</span><span class=lnt> 413
</span><span class=lnt> 414
</span><span class=lnt> 415
</span><span class=lnt> 416
</span><span class=lnt> 417
</span><span class=lnt> 418
</span><span class=lnt> 419
</span><span class=lnt> 420
</span><span class=lnt> 421
</span><span class=lnt> 422
</span><span class=lnt> 423
</span><span class=lnt> 424
</span><span class=lnt> 425
</span><span class=lnt> 426
</span><span class=lnt> 427
</span><span class=lnt> 428
</span><span class=lnt> 429
</span><span class=lnt> 430
</span><span class=lnt> 431
</span><span class=lnt> 432
</span><span class=lnt> 433
</span><span class=lnt> 434
</span><span class=lnt> 435
</span><span class=lnt> 436
</span><span class=lnt> 437
</span><span class=lnt> 438
</span><span class=lnt> 439
</span><span class=lnt> 440
</span><span class=lnt> 441
</span><span class=lnt> 442
</span><span class=lnt> 443
</span><span class=lnt> 444
</span><span class=lnt> 445
</span><span class=lnt> 446
</span><span class=lnt> 447
</span><span class=lnt> 448
</span><span class=lnt> 449
</span><span class=lnt> 450
</span><span class=lnt> 451
</span><span class=lnt> 452
</span><span class=lnt> 453
</span><span class=lnt> 454
</span><span class=lnt> 455
</span><span class=lnt> 456
</span><span class=lnt> 457
</span><span class=lnt> 458
</span><span class=lnt> 459
</span><span class=lnt> 460
</span><span class=lnt> 461
</span><span class=lnt> 462
</span><span class=lnt> 463
</span><span class=lnt> 464
</span><span class=lnt> 465
</span><span class=lnt> 466
</span><span class=lnt> 467
</span><span class=lnt> 468
</span><span class=lnt> 469
</span><span class=lnt> 470
</span><span class=lnt> 471
</span><span class=lnt> 472
</span><span class=lnt> 473
</span><span class=lnt> 474
</span><span class=lnt> 475
</span><span class=lnt> 476
</span><span class=lnt> 477
</span><span class=lnt> 478
</span><span class=lnt> 479
</span><span class=lnt> 480
</span><span class=lnt> 481
</span><span class=lnt> 482
</span><span class=lnt> 483
</span><span class=lnt> 484
</span><span class=lnt> 485
</span><span class=lnt> 486
</span><span class=lnt> 487
</span><span class=lnt> 488
</span><span class=lnt> 489
</span><span class=lnt> 490
</span><span class=lnt> 491
</span><span class=lnt> 492
</span><span class=lnt> 493
</span><span class=lnt> 494
</span><span class=lnt> 495
</span><span class=lnt> 496
</span><span class=lnt> 497
</span><span class=lnt> 498
</span><span class=lnt> 499
</span><span class=lnt> 500
</span><span class=lnt> 501
</span><span class=lnt> 502
</span><span class=lnt> 503
</span><span class=lnt> 504
</span><span class=lnt> 505
</span><span class=lnt> 506
</span><span class=lnt> 507
</span><span class=lnt> 508
</span><span class=lnt> 509
</span><span class=lnt> 510
</span><span class=lnt> 511
</span><span class=lnt> 512
</span><span class=lnt> 513
</span><span class=lnt> 514
</span><span class=lnt> 515
</span><span class=lnt> 516
</span><span class=lnt> 517
</span><span class=lnt> 518
</span><span class=lnt> 519
</span><span class=lnt> 520
</span><span class=lnt> 521
</span><span class=lnt> 522
</span><span class=lnt> 523
</span><span class=lnt> 524
</span><span class=lnt> 525
</span><span class=lnt> 526
</span><span class=lnt> 527
</span><span class=lnt> 528
</span><span class=lnt> 529
</span><span class=lnt> 530
</span><span class=lnt> 531
</span><span class=lnt> 532
</span><span class=lnt> 533
</span><span class=lnt> 534
</span><span class=lnt> 535
</span><span class=lnt> 536
</span><span class=lnt> 537
</span><span class=lnt> 538
</span><span class=lnt> 539
</span><span class=lnt> 540
</span><span class=lnt> 541
</span><span class=lnt> 542
</span><span class=lnt> 543
</span><span class=lnt> 544
</span><span class=lnt> 545
</span><span class=lnt> 546
</span><span class=lnt> 547
</span><span class=lnt> 548
</span><span class=lnt> 549
</span><span class=lnt> 550
</span><span class=lnt> 551
</span><span class=lnt> 552
</span><span class=lnt> 553
</span><span class=lnt> 554
</span><span class=lnt> 555
</span><span class=lnt> 556
</span><span class=lnt> 557
</span><span class=lnt> 558
</span><span class=lnt> 559
</span><span class=lnt> 560
</span><span class=lnt> 561
</span><span class=lnt> 562
</span><span class=lnt> 563
</span><span class=lnt> 564
</span><span class=lnt> 565
</span><span class=lnt> 566
</span><span class=lnt> 567
</span><span class=lnt> 568
</span><span class=lnt> 569
</span><span class=lnt> 570
</span><span class=lnt> 571
</span><span class=lnt> 572
</span><span class=lnt> 573
</span><span class=lnt> 574
</span><span class=lnt> 575
</span><span class=lnt> 576
</span><span class=lnt> 577
</span><span class=lnt> 578
</span><span class=lnt> 579
</span><span class=lnt> 580
</span><span class=lnt> 581
</span><span class=lnt> 582
</span><span class=lnt> 583
</span><span class=lnt> 584
</span><span class=lnt> 585
</span><span class=lnt> 586
</span><span class=lnt> 587
</span><span class=lnt> 588
</span><span class=lnt> 589
</span><span class=lnt> 590
</span><span class=lnt> 591
</span><span class=lnt> 592
</span><span class=lnt> 593
</span><span class=lnt> 594
</span><span class=lnt> 595
</span><span class=lnt> 596
</span><span class=lnt> 597
</span><span class=lnt> 598
</span><span class=lnt> 599
</span><span class=lnt> 600
</span><span class=lnt> 601
</span><span class=lnt> 602
</span><span class=lnt> 603
</span><span class=lnt> 604
</span><span class=lnt> 605
</span><span class=lnt> 606
</span><span class=lnt> 607
</span><span class=lnt> 608
</span><span class=lnt> 609
</span><span class=lnt> 610
</span><span class=lnt> 611
</span><span class=lnt> 612
</span><span class=lnt> 613
</span><span class=lnt> 614
</span><span class=lnt> 615
</span><span class=lnt> 616
</span><span class=lnt> 617
</span><span class=lnt> 618
</span><span class=lnt> 619
</span><span class=lnt> 620
</span><span class=lnt> 621
</span><span class=lnt> 622
</span><span class=lnt> 623
</span><span class=lnt> 624
</span><span class=lnt> 625
</span><span class=lnt> 626
</span><span class=lnt> 627
</span><span class=lnt> 628
</span><span class=lnt> 629
</span><span class=lnt> 630
</span><span class=lnt> 631
</span><span class=lnt> 632
</span><span class=lnt> 633
</span><span class=lnt> 634
</span><span class=lnt> 635
</span><span class=lnt> 636
</span><span class=lnt> 637
</span><span class=lnt> 638
</span><span class=lnt> 639
</span><span class=lnt> 640
</span><span class=lnt> 641
</span><span class=lnt> 642
</span><span class=lnt> 643
</span><span class=lnt> 644
</span><span class=lnt> 645
</span><span class=lnt> 646
</span><span class=lnt> 647
</span><span class=lnt> 648
</span><span class=lnt> 649
</span><span class=lnt> 650
</span><span class=lnt> 651
</span><span class=lnt> 652
</span><span class=lnt> 653
</span><span class=lnt> 654
</span><span class=lnt> 655
</span><span class=lnt> 656
</span><span class=lnt> 657
</span><span class=lnt> 658
</span><span class=lnt> 659
</span><span class=lnt> 660
</span><span class=lnt> 661
</span><span class=lnt> 662
</span><span class=lnt> 663
</span><span class=lnt> 664
</span><span class=lnt> 665
</span><span class=lnt> 666
</span><span class=lnt> 667
</span><span class=lnt> 668
</span><span class=lnt> 669
</span><span class=lnt> 670
</span><span class=lnt> 671
</span><span class=lnt> 672
</span><span class=lnt> 673
</span><span class=lnt> 674
</span><span class=lnt> 675
</span><span class=lnt> 676
</span><span class=lnt> 677
</span><span class=lnt> 678
</span><span class=lnt> 679
</span><span class=lnt> 680
</span><span class=lnt> 681
</span><span class=lnt> 682
</span><span class=lnt> 683
</span><span class=lnt> 684
</span><span class=lnt> 685
</span><span class=lnt> 686
</span><span class=lnt> 687
</span><span class=lnt> 688
</span><span class=lnt> 689
</span><span class=lnt> 690
</span><span class=lnt> 691
</span><span class=lnt> 692
</span><span class=lnt> 693
</span><span class=lnt> 694
</span><span class=lnt> 695
</span><span class=lnt> 696
</span><span class=lnt> 697
</span><span class=lnt> 698
</span><span class=lnt> 699
</span><span class=lnt> 700
</span><span class=lnt> 701
</span><span class=lnt> 702
</span><span class=lnt> 703
</span><span class=lnt> 704
</span><span class=lnt> 705
</span><span class=lnt> 706
</span><span class=lnt> 707
</span><span class=lnt> 708
</span><span class=lnt> 709
</span><span class=lnt> 710
</span><span class=lnt> 711
</span><span class=lnt> 712
</span><span class=lnt> 713
</span><span class=lnt> 714
</span><span class=lnt> 715
</span><span class=lnt> 716
</span><span class=lnt> 717
</span><span class=lnt> 718
</span><span class=lnt> 719
</span><span class=lnt> 720
</span><span class=lnt> 721
</span><span class=lnt> 722
</span><span class=lnt> 723
</span><span class=lnt> 724
</span><span class=lnt> 725
</span><span class=lnt> 726
</span><span class=lnt> 727
</span><span class=lnt> 728
</span><span class=lnt> 729
</span><span class=lnt> 730
</span><span class=lnt> 731
</span><span class=lnt> 732
</span><span class=lnt> 733
</span><span class=lnt> 734
</span><span class=lnt> 735
</span><span class=lnt> 736
</span><span class=lnt> 737
</span><span class=lnt> 738
</span><span class=lnt> 739
</span><span class=lnt> 740
</span><span class=lnt> 741
</span><span class=lnt> 742
</span><span class=lnt> 743
</span><span class=lnt> 744
</span><span class=lnt> 745
</span><span class=lnt> 746
</span><span class=lnt> 747
</span><span class=lnt> 748
</span><span class=lnt> 749
</span><span class=lnt> 750
</span><span class=lnt> 751
</span><span class=lnt> 752
</span><span class=lnt> 753
</span><span class=lnt> 754
</span><span class=lnt> 755
</span><span class=lnt> 756
</span><span class=lnt> 757
</span><span class=lnt> 758
</span><span class=lnt> 759
</span><span class=lnt> 760
</span><span class=lnt> 761
</span><span class=lnt> 762
</span><span class=lnt> 763
</span><span class=lnt> 764
</span><span class=lnt> 765
</span><span class=lnt> 766
</span><span class=lnt> 767
</span><span class=lnt> 768
</span><span class=lnt> 769
</span><span class=lnt> 770
</span><span class=lnt> 771
</span><span class=lnt> 772
</span><span class=lnt> 773
</span><span class=lnt> 774
</span><span class=lnt> 775
</span><span class=lnt> 776
</span><span class=lnt> 777
</span><span class=lnt> 778
</span><span class=lnt> 779
</span><span class=lnt> 780
</span><span class=lnt> 781
</span><span class=lnt> 782
</span><span class=lnt> 783
</span><span class=lnt> 784
</span><span class=lnt> 785
</span><span class=lnt> 786
</span><span class=lnt> 787
</span><span class=lnt> 788
</span><span class=lnt> 789
</span><span class=lnt> 790
</span><span class=lnt> 791
</span><span class=lnt> 792
</span><span class=lnt> 793
</span><span class=lnt> 794
</span><span class=lnt> 795
</span><span class=lnt> 796
</span><span class=lnt> 797
</span><span class=lnt> 798
</span><span class=lnt> 799
</span><span class=lnt> 800
</span><span class=lnt> 801
</span><span class=lnt> 802
</span><span class=lnt> 803
</span><span class=lnt> 804
</span><span class=lnt> 805
</span><span class=lnt> 806
</span><span class=lnt> 807
</span><span class=lnt> 808
</span><span class=lnt> 809
</span><span class=lnt> 810
</span><span class=lnt> 811
</span><span class=lnt> 812
</span><span class=lnt> 813
</span><span class=lnt> 814
</span><span class=lnt> 815
</span><span class=lnt> 816
</span><span class=lnt> 817
</span><span class=lnt> 818
</span><span class=lnt> 819
</span><span class=lnt> 820
</span><span class=lnt> 821
</span><span class=lnt> 822
</span><span class=lnt> 823
</span><span class=lnt> 824
</span><span class=lnt> 825
</span><span class=lnt> 826
</span><span class=lnt> 827
</span><span class=lnt> 828
</span><span class=lnt> 829
</span><span class=lnt> 830
</span><span class=lnt> 831
</span><span class=lnt> 832
</span><span class=lnt> 833
</span><span class=lnt> 834
</span><span class=lnt> 835
</span><span class=lnt> 836
</span><span class=lnt> 837
</span><span class=lnt> 838
</span><span class=lnt> 839
</span><span class=lnt> 840
</span><span class=lnt> 841
</span><span class=lnt> 842
</span><span class=lnt> 843
</span><span class=lnt> 844
</span><span class=lnt> 845
</span><span class=lnt> 846
</span><span class=lnt> 847
</span><span class=lnt> 848
</span><span class=lnt> 849
</span><span class=lnt> 850
</span><span class=lnt> 851
</span><span class=lnt> 852
</span><span class=lnt> 853
</span><span class=lnt> 854
</span><span class=lnt> 855
</span><span class=lnt> 856
</span><span class=lnt> 857
</span><span class=lnt> 858
</span><span class=lnt> 859
</span><span class=lnt> 860
</span><span class=lnt> 861
</span><span class=lnt> 862
</span><span class=lnt> 863
</span><span class=lnt> 864
</span><span class=lnt> 865
</span><span class=lnt> 866
</span><span class=lnt> 867
</span><span class=lnt> 868
</span><span class=lnt> 869
</span><span class=lnt> 870
</span><span class=lnt> 871
</span><span class=lnt> 872
</span><span class=lnt> 873
</span><span class=lnt> 874
</span><span class=lnt> 875
</span><span class=lnt> 876
</span><span class=lnt> 877
</span><span class=lnt> 878
</span><span class=lnt> 879
</span><span class=lnt> 880
</span><span class=lnt> 881
</span><span class=lnt> 882
</span><span class=lnt> 883
</span><span class=lnt> 884
</span><span class=lnt> 885
</span><span class=lnt> 886
</span><span class=lnt> 887
</span><span class=lnt> 888
</span><span class=lnt> 889
</span><span class=lnt> 890
</span><span class=lnt> 891
</span><span class=lnt> 892
</span><span class=lnt> 893
</span><span class=lnt> 894
</span><span class=lnt> 895
</span><span class=lnt> 896
</span><span class=lnt> 897
</span><span class=lnt> 898
</span><span class=lnt> 899
</span><span class=lnt> 900
</span><span class=lnt> 901
</span><span class=lnt> 902
</span><span class=lnt> 903
</span><span class=lnt> 904
</span><span class=lnt> 905
</span><span class=lnt> 906
</span><span class=lnt> 907
</span><span class=lnt> 908
</span><span class=lnt> 909
</span><span class=lnt> 910
</span><span class=lnt> 911
</span><span class=lnt> 912
</span><span class=lnt> 913
</span><span class=lnt> 914
</span><span class=lnt> 915
</span><span class=lnt> 916
</span><span class=lnt> 917
</span><span class=lnt> 918
</span><span class=lnt> 919
</span><span class=lnt> 920
</span><span class=lnt> 921
</span><span class=lnt> 922
</span><span class=lnt> 923
</span><span class=lnt> 924
</span><span class=lnt> 925
</span><span class=lnt> 926
</span><span class=lnt> 927
</span><span class=lnt> 928
</span><span class=lnt> 929
</span><span class=lnt> 930
</span><span class=lnt> 931
</span><span class=lnt> 932
</span><span class=lnt> 933
</span><span class=lnt> 934
</span><span class=lnt> 935
</span><span class=lnt> 936
</span><span class=lnt> 937
</span><span class=lnt> 938
</span><span class=lnt> 939
</span><span class=lnt> 940
</span><span class=lnt> 941
</span><span class=lnt> 942
</span><span class=lnt> 943
</span><span class=lnt> 944
</span><span class=lnt> 945
</span><span class=lnt> 946
</span><span class=lnt> 947
</span><span class=lnt> 948
</span><span class=lnt> 949
</span><span class=lnt> 950
</span><span class=lnt> 951
</span><span class=lnt> 952
</span><span class=lnt> 953
</span><span class=lnt> 954
</span><span class=lnt> 955
</span><span class=lnt> 956
</span><span class=lnt> 957
</span><span class=lnt> 958
</span><span class=lnt> 959
</span><span class=lnt> 960
</span><span class=lnt> 961
</span><span class=lnt> 962
</span><span class=lnt> 963
</span><span class=lnt> 964
</span><span class=lnt> 965
</span><span class=lnt> 966
</span><span class=lnt> 967
</span><span class=lnt> 968
</span><span class=lnt> 969
</span><span class=lnt> 970
</span><span class=lnt> 971
</span><span class=lnt> 972
</span><span class=lnt> 973
</span><span class=lnt> 974
</span><span class=lnt> 975
</span><span class=lnt> 976
</span><span class=lnt> 977
</span><span class=lnt> 978
</span><span class=lnt> 979
</span><span class=lnt> 980
</span><span class=lnt> 981
</span><span class=lnt> 982
</span><span class=lnt> 983
</span><span class=lnt> 984
</span><span class=lnt> 985
</span><span class=lnt> 986
</span><span class=lnt> 987
</span><span class=lnt> 988
</span><span class=lnt> 989
</span><span class=lnt> 990
</span><span class=lnt> 991
</span><span class=lnt> 992
</span><span class=lnt> 993
</span><span class=lnt> 994
</span><span class=lnt> 995
</span><span class=lnt> 996
</span><span class=lnt> 997
</span><span class=lnt> 998
</span><span class=lnt> 999
</span><span class=lnt>1000
</span><span class=lnt>1001
</span><span class=lnt>1002
</span><span class=lnt>1003
</span><span class=lnt>1004
</span><span class=lnt>1005
</span><span class=lnt>1006
</span><span class=lnt>1007
</span><span class=lnt>1008
</span><span class=lnt>1009
</span><span class=lnt>1010
</span><span class=lnt>1011
</span><span class=lnt>1012
</span><span class=lnt>1013
</span><span class=lnt>1014
</span><span class=lnt>1015
</span><span class=lnt>1016
</span><span class=lnt>1017
</span><span class=lnt>1018
</span><span class=lnt>1019
</span><span class=lnt>1020
</span><span class=lnt>1021
</span><span class=lnt>1022
</span><span class=lnt>1023
</span><span class=lnt>1024
</span><span class=lnt>1025
</span><span class=lnt>1026
</span><span class=lnt>1027
</span><span class=lnt>1028
</span><span class=lnt>1029
</span><span class=lnt>1030
</span><span class=lnt>1031
</span><span class=lnt>1032
</span><span class=lnt>1033
</span><span class=lnt>1034
</span><span class=lnt>1035
</span><span class=lnt>1036
</span><span class=lnt>1037
</span><span class=lnt>1038
</span><span class=lnt>1039
</span><span class=lnt>1040
</span><span class=lnt>1041
</span><span class=lnt>1042
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C# data-lang=C#><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>container</span> <span class=n>list2Con</span> <span class=p>(</span><span class=n>List</span> <span class=n>_list</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span> <span class=n>con</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ListEnumerator</span> <span class=n>listEnum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>listEnum</span> <span class=p>=</span> <span class=n>_list</span><span class=p>.</span><span class=n>getEnumerator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>listEnum</span><span class=p>.</span><span class=n>moveNext</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>con</span> <span class=p>+=</span> <span class=n>listEnum</span><span class=p>.</span><span class=n>current</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>con</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>///Creates a file named _file with the content specified in _content parameter.</span>
</span></span><span class=line><span class=cl><span class=c1>//See the class SysImportUtil class for file related functions like get temfolder,tempfilename..etc.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=k>void</span> <span class=n>createFile</span><span class=p>(</span><span class=n>str</span> <span class=n>_file</span><span class=p>,</span> <span class=n>str</span> <span class=n>_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>File</span>
</span></span><span class=line><span class=cl>    <span class=n>TextIo</span> <span class=n>file</span> <span class=p>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>FileIOPermission</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=err>#</span><span class=n>io_write</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// BP Deviation Documented</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span> <span class=p>=</span> <span class=k>new</span> <span class=n>TextIo</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=err>#</span><span class=n>io_write</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=n>_content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span><span class=p>.</span><span class=n>finalize</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>///Creates an XML file named _file with the content specified in _content parameter. If the XML file</span>
</span></span><span class=line><span class=cl><span class=cs>///can&#39;t be created then it will try to create a normal file by calling createFile method.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=k>void</span> <span class=n>createXmlFile</span><span class=p>(</span><span class=n>str</span> <span class=n>_file</span><span class=p>,</span> <span class=n>str</span> <span class=n>_content</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>File</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>XmlDocument</span> <span class=n>document</span> <span class=p>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span> <span class=p>=</span> <span class=n>XmlDocument</span><span class=p>::</span><span class=n>newXml</span><span class=p>(</span><span class=n>_content</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>FileIOPermission</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=err>#</span><span class=n>io_write</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// BP Deviation Documented</span>
</span></span><span class=line><span class=cl>        <span class=n>document</span><span class=p>.</span><span class=n>save</span><span class=p>(</span><span class=n>_file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>SysImportUtil</span><span class=p>::</span><span class=n>createFile</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=n>_content</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>///Reads an XML file specified by _file parameter.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>readXmlFile</span><span class=p>(</span><span class=n>str</span> <span class=n>_file</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>File</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>XmlDocument</span> <span class=n>file</span> <span class=p>=</span> <span class=k>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>new</span> <span class=n>FileIOPermission</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=err>#</span><span class=n>io_read</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=c1>// BP Deviation Documented</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span> <span class=p>=</span> <span class=n>XmlDocument</span><span class=p>::</span><span class=n>newFile</span><span class=p>(</span><span class=n>_file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>file</span><span class=p>.</span><span class=n>xml</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Opens Bing maps with the address.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;_address&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// The address to map.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=k>void</span> <span class=n>mapIt</span><span class=p>(</span><span class=n>LogisticsPostalAddress</span> <span class=n>_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>DEFINE</span><span class=p>.</span><span class=n>MapURL</span><span class=p>(</span><span class=err>&#39;</span><span class=n>http</span><span class=p>:</span><span class=c1>//maps.bing.com/default.aspx?where1=\%1&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>DEFINE</span><span class=p>.</span><span class=n>comma</span><span class=p>(</span><span class=sc>&#39;,&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>DEFINE</span><span class=p>.</span><span class=n>newLine</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>str</span>     <span class=n>address</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_address</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>address</span> <span class=p>=</span> <span class=n>_address</span><span class=p>.</span><span class=n>Street</span> <span class=p>+</span> <span class=err>#</span><span class=n>comma</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>                  <span class=n>_address</span><span class=p>.</span><span class=n>City</span> <span class=p>+</span> <span class=err>#</span><span class=n>comma</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>                  <span class=n>_address</span><span class=p>.</span><span class=n>State</span> <span class=p>+</span> <span class=err>#</span><span class=n>comma</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>                  <span class=n>_address</span><span class=p>.</span><span class=n>ZipCode</span> <span class=p>+</span> <span class=err>#</span><span class=n>comma</span> <span class=p>+</span>
</span></span><span class=line><span class=cl>                  <span class=n>_address</span><span class=p>.</span><span class=n>CountryRegionId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Replace the newline with comma</span>
</span></span><span class=line><span class=cl>        <span class=n>address</span> <span class=p>=</span> <span class=n>strReplace</span><span class=p>(</span><span class=n>address</span><span class=p>,</span> <span class=err>#</span><span class=n>newline</span><span class=p>,</span> <span class=err>#</span><span class=n>comma</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// URL encode</span>
</span></span><span class=line><span class=cl>        <span class=n>address</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Web</span><span class=p>.</span><span class=n>HttpUtility</span><span class=p>::</span><span class=n>UrlEncode</span><span class=p>(</span><span class=n>address</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Add the address to the URL</span>
</span></span><span class=line><span class=cl>        <span class=n>infolog</span><span class=p>.</span><span class=n>urlLookup</span><span class=p>(</span><span class=n>strFmt</span><span class=p>(</span><span class=err>#</span><span class=n>MapURL</span><span class=p>,</span> <span class=n>address</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Function to get the list of Tables in AOT</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// In case the table is derived its parent i.e. base table is appended to it delimited by comma (,)</span>
</span></span><span class=line><span class=cl><span class=cs>/// Output example</span>
</span></span><span class=line><span class=cl><span class=cs>/// :Table1,Table1&#39;s Base Table : Table2 : Table3 : Table4 , Table4&#39;s Base Table</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>str</span> <span class=n>getAOTTables</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNode</span>            <span class=n>node</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNode</span>            <span class=n>childNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNodeIterator</span>    <span class=n>nodeIt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>FilePath</span>            <span class=n>path</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TableId</span>             <span class=n>tableId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Dictionary</span>      <span class=n>dict</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Dictionary</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>parentName</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>fieldArr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>path</span>        <span class=p>=</span> <span class=err>@&#39;\</span><span class=n>Data</span> <span class=n>dictionary</span><span class=err>\</span><span class=n>Tables</span><span class=err>&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>node</span>        <span class=p>=</span> <span class=n>TreeNode</span><span class=p>::</span><span class=n>findNode</span><span class=p>(</span><span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>nodeIt</span>      <span class=p>=</span> <span class=n>node</span><span class=p>.</span><span class=n>AOTiterator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>childNode</span>   <span class=p>=</span> <span class=n>nodeIt</span><span class=p>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>fieldArr</span> <span class=p>=</span><span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>childNode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>tableId</span> <span class=p>=</span> <span class=n>tableName2id</span><span class=p>(</span><span class=n>childNode</span><span class=p>.</span><span class=n>treeNodeName</span><span class=p>());</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span> <span class=p>!</span><span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableId</span><span class=p>).</span><span class=n>isTmp</span><span class=p>()</span>  <span class=p>&amp;&amp;</span> <span class=p>!</span><span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableId</span><span class=p>).</span><span class=n>isMap</span><span class=p>()</span> <span class=p>&amp;&amp;</span> <span class=p>!</span><span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableId</span><span class=p>).</span><span class=n>isView</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>parentName</span> <span class=p>=</span> <span class=n>RetailUtils</span><span class=p>::</span><span class=n>getAOTTableParentName</span><span class=p>(</span><span class=n>tableId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>parentName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=c1>//Creating formated output , refer explaination and example on header</span>
</span></span><span class=line><span class=cl>                <span class=n>fieldArr</span> <span class=p>=</span> <span class=n>fieldArr</span> <span class=p>+</span> <span class=sc>&#39;:&#39;</span> <span class=p>+</span> <span class=n>strUpr</span><span class=p>(</span><span class=n>childNode</span><span class=p>.</span><span class=n>treeNodeName</span><span class=p>())</span> <span class=p>+</span> <span class=s>&#34;,&#34;</span> <span class=p>+</span> <span class=n>strUpr</span><span class=p>(</span><span class=n>parentName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>fieldArr</span> <span class=p>=</span> <span class=n>fieldArr</span> <span class=p>+</span> <span class=sc>&#39;:&#39;</span> <span class=p>+</span> <span class=n>strUpr</span><span class=p>(</span><span class=n>childNode</span><span class=p>.</span><span class=n>treeNodeName</span><span class=p>());</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=n>childNode</span> <span class=p>=</span> <span class=n>nodeIt</span><span class=p>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fieldArr</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// This method receives a table id and find the corresponding Base Table from AOT</span>
</span></span><span class=line><span class=cl><span class=cs>/// This method takes care of Multilevel inheritence</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;tableid&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// tableid of derived table.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Name of parent table.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>str</span> <span class=n>getAOTTableParentName</span><span class=p>(</span><span class=n>TableId</span> <span class=n>tableid</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Dictionary</span>  <span class=n>dict</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Dictionary</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>TableId</span> <span class=n>parentId</span><span class=p>,</span> <span class=n>temp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>parentId</span> <span class=p>=</span> <span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableid</span><span class=p>).</span><span class=n>extends</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Loop until reached to the table for whcih Extends property is not defined</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>parentId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>temp</span> <span class=p>=</span> <span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>parentId</span><span class=p>).</span><span class=n>extends</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>temp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>parentId</span> <span class=p>=</span> <span class=n>temp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>parentId</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=p>=</span> <span class=n>tableId2name</span><span class=p>(</span><span class=n>parentId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>result</span> <span class=p>=</span> <span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>result</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Function to accepts a table name and returns all its field</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;tableName&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Table name for which field are to be retreived.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Field are arranged in a : delimited string and passed back</span>
</span></span><span class=line><span class=cl><span class=cs>/// Fields are read from AOT structure and defaults field are manually added</span>
</span></span><span class=line><span class=cl><span class=cs>/// as those are not present in the tree structure</span>
</span></span><span class=line><span class=cl><span class=cs>/// Example =  :Field1:Field2:Field3:Field4</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>str</span> <span class=n>getAOTTableFields</span><span class=p>(</span><span class=n>str</span> <span class=n>tableName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNode</span>            <span class=n>node</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNode</span>            <span class=n>childNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNodeIterator</span>    <span class=n>nodeIt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>FilePath</span>            <span class=n>path</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TableId</span>             <span class=n>tableId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>fieldArr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Dictionary</span>      <span class=n>dict</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Dictionary</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>fieldArr</span> <span class=p>=</span> <span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>tableName</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>fieldArr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Construct the path till table fields node</span>
</span></span><span class=line><span class=cl>    <span class=n>path</span>        <span class=p>=</span> <span class=err>@&#39;\</span><span class=n>Data</span> <span class=n>dictionary</span><span class=err>\</span><span class=n>Tables</span><span class=err>\\&#39;</span> <span class=p>+</span> <span class=n>tableName</span> <span class=p>+</span> <span class=err>&#39;\\</span><span class=n>Fields</span><span class=err>&#39;</span> <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>node</span>        <span class=p>=</span> <span class=n>TreeNode</span><span class=p>::</span><span class=n>findNode</span><span class=p>(</span><span class=n>path</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>nodeIt</span>      <span class=p>=</span> <span class=n>node</span><span class=p>.</span><span class=n>AOTiterator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>childNode</span>   <span class=p>=</span> <span class=n>nodeIt</span><span class=p>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>childNode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>fieldArr</span> <span class=p>=</span>  <span class=n>fieldArr</span> <span class=p>+</span> <span class=sc>&#39;:&#39;</span> <span class=p>+</span> <span class=n>strUpr</span><span class=p>(</span><span class=n>childNode</span><span class=p>.</span><span class=n>treeNodeName</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>childNode</span> <span class=p>=</span> <span class=n>nodeIt</span><span class=p>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>tableId</span> <span class=p>=</span> <span class=n>tableName2id</span><span class=p>(</span><span class=n>tableName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableId</span><span class=p>).</span><span class=n>dataPrCompany</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//Append the default Fields</span>
</span></span><span class=line><span class=cl>        <span class=n>fieldArr</span> <span class=p>=</span>  <span class=n>fieldArr</span> <span class=p>+</span> <span class=sc>&#39;:&#39;</span> <span class=p>+</span> <span class=err>&#39;</span><span class=n>DATAAREAID</span><span class=err>&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dict</span><span class=p>.</span><span class=n>tableObject</span><span class=p>(</span><span class=n>tableId</span><span class=p>).</span><span class=n>dataPerPartition</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>fieldArr</span> <span class=p>=</span>  <span class=n>fieldArr</span> <span class=p>+</span> <span class=sc>&#39;:&#39;</span> <span class=p>+</span> <span class=err>&#39;</span><span class=n>PARTITION</span><span class=err>&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fieldArr</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// get enum values to container</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=k>void</span> <span class=n>Enum2container</span><span class=p>(</span><span class=n>Args</span> <span class=n>_args</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>    <span class=kt>int</span>         <span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DictEnum</span>    <span class=n>dimCode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span>   <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dimCode</span> <span class=p>=</span> <span class=k>new</span> <span class=n>DictEnum</span><span class=p>(</span><span class=n>enumnum</span><span class=p>(</span><span class=n>SysDimension</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>i</span> <span class=p>&lt;</span> <span class=n>dimCode</span><span class=p>.</span><span class=n>values</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=p>+=</span> <span class=n>dimCode</span><span class=p>.</span><span class=n>index2Name</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=p>++;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=n>info</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;%1&#34;</span><span class=p>,</span><span class=n>con2Str</span><span class=p>(</span><span class=n>ret</span><span class=p>)));</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>boolean</span> <span class=n>checkDateIsInPeriod</span><span class=p>(</span><span class=n>TransDate</span> <span class=n>_transDate</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                            <span class=n>PeriodCode</span>  <span class=n>_periodCode</span> <span class=p>=</span> <span class=n>PeriodCode</span><span class=p>::</span><span class=n>Regular</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>BudgetTransactionManager</span><span class=p>::</span><span class=n>validateTransactionDate</span><span class=p>(</span><span class=n>_transDate</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// New method for returning ledgerperiod last date</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>transDate</span> <span class=n>findLastOpenPeriod</span><span class=p>(</span><span class=n>transdate</span> <span class=n>_ledgerTransDate</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FiscalCalendarRecId</span>     <span class=n>fiscalCalendarRecId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fiscalCalendarRecId</span> <span class=p>=</span> <span class=n>Ledger</span><span class=p>::</span><span class=n>fiscalCalendar</span><span class=p>(</span><span class=n>CompanyInfo</span><span class=p>::</span><span class=n>find</span><span class=p>().</span><span class=n>RecId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>FiscalCalendars</span><span class=p>::</span><span class=n>findLastDayofPeriod</span><span class=p>(</span> <span class=n>fiscalCalendarRecId</span><span class=p>,</span> <span class=n>_ledgerTransDate</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// New method for returning first open ledgerperiod first date</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>transDate</span> <span class=n>findFirstOpenPeriod</span><span class=p>(</span><span class=n>transdate</span> <span class=n>_ledgerTransDate</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FiscalCalendarRecId</span>     <span class=n>fiscalCalendarRecId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fiscalCalendarRecId</span> <span class=p>=</span> <span class=n>Ledger</span><span class=p>::</span><span class=n>fiscalCalendar</span><span class=p>(</span><span class=n>CompanyInfo</span><span class=p>::</span><span class=n>find</span><span class=p>().</span><span class=n>RecId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>FiscalCalendars</span><span class=p>::</span><span class=n>findFirstDayofPeriod</span><span class=p>(</span> <span class=n>fiscalCalendarRecId</span><span class=p>,</span> <span class=n>_ledgerTransDate</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Calculate Hash for the string.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>CalculateHash</span><span class=p>(</span><span class=n>str</span> <span class=n>tb</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>obj</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>md5</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>StringBuilder</span> <span class=n>sBuilder</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>clrStr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>clrStrObject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Exception</span> <span class=n>clrException</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Array</span> <span class=n>resultByteArray</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>arrayLength</span> <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>InteropPermission</span> <span class=n>perm</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>perm</span> <span class=p>=</span> <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>perm</span><span class=p>.</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>obj</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>Encoding</span><span class=p>::</span><span class=n>get_ASCII</span><span class=p>().</span><span class=n>GetBytes</span><span class=p>(</span><span class=n>tb</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>md5</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Security</span><span class=p>.</span><span class=n>Cryptography</span><span class=p>.</span><span class=n>MD5</span><span class=p>::</span><span class=n>Create</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>resultByteArray</span> <span class=p>=</span> <span class=n>md5</span><span class=p>.</span><span class=n>ComputeHash</span><span class=p>(</span><span class=n>obj</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//BP deviation documented</span>
</span></span><span class=line><span class=cl>        <span class=n>sBuilder</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>arrayLength</span> <span class=p>=</span> <span class=n>resultByteArray</span><span class=p>.</span><span class=n>get_Length</span><span class=p>()</span> <span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Loop through each byte of the hashed data</span>
</span></span><span class=line><span class=cl>        <span class=c1>// and format each one as a hexadecimal string.</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span><span class=n>arrayLength</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>clrStrObject</span> <span class=p>=</span> <span class=n>resultByteArray</span><span class=p>.</span><span class=n>GetValue</span><span class=p>(</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>clrStr</span> <span class=p>=</span> <span class=n>clrStrObject</span><span class=p>.</span><span class=n>ToString</span><span class=p>(</span><span class=err>&#39;</span><span class=n>x2</span><span class=err>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>sBuilder</span><span class=p>.</span><span class=n>Append</span><span class=p>(</span><span class=n>clrStr</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Return the hexadecimal string.</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=p>=</span> <span class=n>sBuilder</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span><span class=p>::</span><span class=n>CLRError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//BP deviation documented</span>
</span></span><span class=line><span class=cl>        <span class=n>clrException</span> <span class=p>=</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getLastException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>s</span> <span class=p>=</span> <span class=n>clrException</span><span class=p>.</span><span class=n>get_Message</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span><span class=p>(</span><span class=n>s</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=s>&#34;@SYS106158&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>s</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Transforms xml to another format of xml using xslt.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>transform</span><span class=p>(</span><span class=n>str</span> <span class=n>aifXml</span><span class=p>,</span> <span class=n>str</span> <span class=n>xsltResourceName</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cp>#define.XsltArgumentList(&#34;System.Xml.Xsl.XsltArgumentList&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>AOT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ResourceNode</span> <span class=n>resourceNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>TreeNode</span> <span class=n>resourcesNode</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span> <span class=n>data</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>xsltString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>doXml</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>Xsl</span><span class=p>.</span><span class=n>XslCompiledTransform</span> <span class=n>transform</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>StringBuilder</span>           <span class=n>stringBuilder</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringWriter</span>              <span class=n>stringWriter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringReader</span>              <span class=n>stringReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>XmlTextReader</span>            <span class=n>xmlTextReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringReader</span>              <span class=n>stringReaderForXslt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>XmlTextReader</span>            <span class=n>xmlTextReaderForXslt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>Xsl</span><span class=p>.</span><span class=n>XsltArgumentList</span>     <span class=n>xsltArguments</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IDisposable</span>                  <span class=n>disposableObj</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Get the top Resource node in the AOT</span>
</span></span><span class=line><span class=cl>    <span class=n>resourcesNode</span> <span class=p>=</span> <span class=n>infolog</span><span class=p>.</span><span class=n>findNode</span><span class=p>(</span><span class=err>#</span><span class=n>ResourcesPath</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>resourcesNode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// Get the XML string holding the data from the resource item</span>
</span></span><span class=line><span class=cl>        <span class=n>resourceNode</span> <span class=p>=</span> <span class=n>resourcesNode</span><span class=p>.</span><span class=n>AOTfindChild</span><span class=p>(</span><span class=n>xsltResourceName</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>resourceNode</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>resourceNode</span><span class=p>.</span><span class=n>AOTload</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>data</span> <span class=p>=</span> <span class=n>SysResource</span><span class=p>::</span><span class=n>getResourceNodeData</span><span class=p>(</span><span class=n>resourceNode</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>xsltString</span> <span class=p>=</span> <span class=n>conpeek</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>//Local XSLT</span>
</span></span><span class=line><span class=cl>        <span class=n>transform</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>Xsl</span><span class=p>.</span><span class=n>XslCompiledTransform</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>stringReaderForXslt</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringReader</span><span class=p>(</span><span class=n>xsltString</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>xmlTextReaderForXslt</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>XmlTextReader</span><span class=p>(</span><span class=n>stringReaderForXslt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>transform</span><span class=p>.</span><span class=n>Load</span><span class=p>(</span><span class=n>xmlTextReaderForXslt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>//Transform the input AIF XML</span>
</span></span><span class=line><span class=cl>        <span class=n>stringReader</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringReader</span><span class=p>(</span><span class=n>aifXml</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>xmlTextReader</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Xml</span><span class=p>.</span><span class=n>XmlTextReader</span><span class=p>(</span><span class=n>stringReader</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>stringBuilder</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>StringBuilder</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>stringWriter</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>StringWriter</span><span class=p>(</span><span class=n>stringBuilder</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>xsltArguments</span> <span class=p>=</span> <span class=n>ClrInterop</span><span class=p>::</span><span class=n>Null</span><span class=p>(</span><span class=err>#</span><span class=n>XsltArgumentList</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>transform</span><span class=p>.</span><span class=n>Transform</span><span class=p>(</span><span class=n>xmlTextReader</span><span class=p>,</span> <span class=n>xsltArguments</span><span class=p>,</span> <span class=n>stringWriter</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>doXml</span> <span class=p>=</span> <span class=n>stringBuilder</span><span class=p>.</span><span class=n>ToString</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span><span class=p>::</span><span class=n>CLRError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>Global</span><span class=p>::</span><span class=n>error</span><span class=p>(</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>getLastException</span><span class=p>().</span><span class=n>toString</span><span class=p>());</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>xmlTextReaderForXslt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span> <span class=p>=</span> <span class=n>xmlTextReaderForXslt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>stringReaderForXslt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span> <span class=p>=</span> <span class=n>stringReaderForXslt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>xmlTextReader</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span> <span class=p>=</span> <span class=n>xmlTextReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>stringReader</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span> <span class=p>=</span> <span class=n>stringReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>ClrInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>stringWriter</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span> <span class=p>=</span> <span class=n>stringWriter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>disposableObj</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>doXml</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Converts from string to Time.</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=n>str2Time</span><span class=p>(</span><span class=n>str</span> <span class=m>8</span> <span class=n>_timeStr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>     <span class=n>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>2</span><span class=p>))</span> <span class=p>*</span> <span class=m>3600</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=m>2</span><span class=p>))</span> <span class=p>*</span> <span class=m>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=m>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//This function is used to get xml string from xml file.</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=k>public</span> <span class=n>str</span> <span class=n>getXMLstringFromFile</span><span class=p>(</span><span class=n>str</span> <span class=n>_filepath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>xmlstring</span><span class=p>=</span><span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>XmlDocument</span> <span class=n>document</span><span class=p>=</span><span class=k>new</span> <span class=n>XmlDocument</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>document</span><span class=p>.</span><span class=n>load</span><span class=p>(</span><span class=n>_filepath</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>xmlstring</span><span class=p>=</span><span class=n>document</span><span class=p>.</span><span class=n>innerXml</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>xmlstring</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// this function is used to convert string to array.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>Array</span> <span class=n>str2array</span><span class=p>(</span><span class=n>str</span> <span class=n>_inputString</span><span class=p>,</span> <span class=n>str</span> <span class=n>_delimiter</span> <span class=p>=</span> <span class=err>&#39;</span><span class=s>&#34;,&#34;</span><span class=err>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span>            <span class=n>list</span>        <span class=p>=</span> <span class=n>AmcBankFunctions</span><span class=p>::</span><span class=n>strSplit</span><span class=p>(</span><span class=n>_inputString</span><span class=p>,</span> <span class=n>_delimiter</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ListEnumerator</span>  <span class=n>enumerator</span>  <span class=p>=</span> <span class=n>list</span><span class=p>.</span><span class=n>getEnumerator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Array</span>           <span class=n>a</span>           <span class=p>=</span> <span class=k>new</span> <span class=n>Array</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>String</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>             <span class=n>i</span>           <span class=p>=</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span>             <span class=n>tmpString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>strLen</span><span class=p>(</span><span class=n>_inputString</span><span class=p>)</span> <span class=p>==</span> <span class=m>0</span> <span class=p>||</span> <span class=n>strScan</span><span class=p>(</span><span class=n>_inputString</span><span class=p>,</span> <span class=n>_delimiter</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=n>strLen</span><span class=p>(</span><span class=n>_inputString</span><span class=p>))</span> <span class=p>==</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>a</span><span class=p>;</span> <span class=c1>// this is not a XTL record</span>
</span></span><span class=line><span class=cl>    <span class=n>enumerator</span><span class=p>.</span><span class=n>reset</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>enumerator</span><span class=p>.</span><span class=n>moveNext</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>tmpString</span> <span class=p>=</span> <span class=n>enumerator</span><span class=p>.</span><span class=n>current</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Removes first substring&#39;s preceding &#34; and last substring&#39;s succeeding &#34;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>strLen</span><span class=p>(</span><span class=n>tmpString</span><span class=p>)</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=p>==</span> <span class=m>1</span> <span class=p>&amp;&amp;</span> <span class=n>tmpString</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=n>tmpString</span> <span class=p>=</span> <span class=n>subStr</span><span class=p>(</span><span class=n>tmpString</span><span class=p>,</span> <span class=m>2</span><span class=p>,</span> <span class=n>strLen</span><span class=p>(</span><span class=n>tmpString</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>i</span> <span class=p>==</span> <span class=n>list</span><span class=p>.</span><span class=n>elements</span><span class=p>())</span>
</span></span><span class=line><span class=cl>                <span class=n>tmpString</span> <span class=p>=</span> <span class=n>subStr</span><span class=p>(</span><span class=n>tmpString</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=n>strLen</span><span class=p>(</span><span class=n>tmpString</span><span class=p>)-</span><span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>a</span><span class=p>.</span><span class=k>value</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>tmpString</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>i</span><span class=p>++;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>a</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///     Prefixes a string with a parameter provided character</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;inputString&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///     The integer that is to be converted into a string</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;outputStringLength&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///     The length of the final string being returned</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;prefixWithChar&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///     The character which to prefix the output string with</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///     The converted integer as a string with the parameter provided length (possible prefixed with provided</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>char</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>prefixString</span><span class=p>(</span><span class=n>str</span> <span class=n>inputString</span><span class=p>,</span> <span class=kt>int</span> <span class=n>outputStringLength</span><span class=p>,</span> <span class=n>str</span> <span class=m>1</span> <span class=n>prefixWithChar</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>outputString</span> <span class=p>=</span> <span class=n>inputString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>prefixWithChar</span> <span class=p>==</span> <span class=err>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>outputString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>strLen</span><span class=p>(</span><span class=n>outputString</span><span class=p>)</span> <span class=p>&lt;</span> <span class=n>outputStringLength</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>outputString</span> <span class=p>=</span> <span class=n>prefixWithChar</span> <span class=p>+</span> <span class=n>outputString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>outputString</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// to test that we have access right for the the file or folder.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>client</span> <span class=n>IO_Status</span> <span class=n>writeFileAndClose</span><span class=p>(</span><span class=n>Filename</span> <span class=n>filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>TextIo</span> <span class=n>textIo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>FileIOPermission</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=err>&#39;</span><span class=n>rw</span><span class=err>&#39;</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>textIo</span> <span class=p>=</span> <span class=k>new</span> <span class=n>TextIo</span><span class=p>(</span><span class=n>filename</span><span class=p>,</span><span class=sc>&#39;w&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>textIo</span><span class=p>!=</span><span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>textIo</span><span class=p>.</span><span class=n>write</span><span class=p>(</span><span class=err>&#39;</span><span class=n>This</span> <span class=k>is</span> <span class=n>a</span> <span class=n>test</span> <span class=n>file</span> <span class=k>for</span> <span class=n>checking</span> <span class=n>the</span> <span class=n>access</span> <span class=n>rights</span><span class=err>&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>textIo</span><span class=p>!=</span><span class=k>null</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>textIo</span><span class=p>.</span><span class=n>status</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>IO_Status</span><span class=p>::</span><span class=n>WriteError</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// send email using smtp</span>
</span></span><span class=line><span class=cl><span class=c1>//Please change the parameters accordingly for your client</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>boolean</span> <span class=n>emailSmtpSend</span><span class=p>(</span><span class=n>str</span>         <span class=n>_receiver</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                    <span class=n>str</span>         <span class=n>_subject</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                    <span class=n>str</span>         <span class=n>_body</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                    <span class=n>Filename</span>    <span class=n>_attachment</span> <span class=p>=</span> <span class=err>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>AmcBankParameters</span>                       <span class=n>amcBankParameters</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>Attachment</span>              <span class=n>attachment</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>AttachmentCollection</span>    <span class=n>attachmentCollection</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailAddress</span>             <span class=n>mailFrom</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailAddress</span>             <span class=n>mailTo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailMessage</span>             <span class=n>mailMessage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>SmtpClient</span>              <span class=n>smtpClient</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>_receiver</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>checkFailed</span><span class=p>(</span><span class=s>&#34;@ABA32081&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>amcBankParameters</span> <span class=p>=</span> <span class=n>AmcBankParameters</span><span class=p>::</span><span class=n>find</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>try</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>mailFrom</span>    <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailAddress</span><span class=p>(</span><span class=n>amcBankParameters</span><span class=p>.</span><span class=n>SmtpSenderAddress</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>mailTo</span>      <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailAddress</span><span class=p>(</span><span class=n>_receiver</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>mailMessage</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>MailMessage</span><span class=p>(</span><span class=n>mailFrom</span><span class=p>,</span> <span class=n>mailTo</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>mailmessage</span><span class=p>.</span><span class=n>set_Subject</span><span class=p>(</span><span class=n>_subject</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>mailmessage</span><span class=p>.</span><span class=n>set_Body</span><span class=p>(</span><span class=n>_body</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// Adding attachment</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>_attachment</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>attachment</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>Attachment</span><span class=p>(</span><span class=n>_attachment</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>attachmentCollection</span> <span class=p>=</span> <span class=n>mailMessage</span><span class=p>.</span><span class=n>get_Attachments</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=n>attachmentCollection</span><span class=p>.</span><span class=n>Add</span><span class=p>(</span><span class=n>attachment</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>smtpClient</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Net</span><span class=p>.</span><span class=n>Mail</span><span class=p>.</span><span class=n>SmtpClient</span><span class=p>(</span><span class=n>amcBankParameters</span><span class=p>.</span><span class=n>SmtpServerName</span><span class=p>,</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>amcBankParameters</span><span class=p>.</span><span class=n>SmtpPortNumber</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>smtpClient</span><span class=p>.</span><span class=n>Send</span><span class=p>(</span><span class=n>mailmessage</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=p>(</span><span class=n>strFmt</span><span class=p>(</span><span class=s>&#34;@SYS80635&#34;</span><span class=p>,</span> <span class=n>_receiver</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>attachmentCollection</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span> <span class=c1>// Releases attachement resources (files)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span> <span class=p>(</span><span class=n>Exception</span><span class=p>::</span><span class=n>CLRError</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// If a CLR exception occurs it is important that the exceptions is shown (which it is not per default)</span>
</span></span><span class=line><span class=cl>        <span class=n>error</span><span class=p>(</span><span class=n>CLRInterop</span><span class=p>::</span><span class=n>getLastException</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>attachmentCollection</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span> <span class=c1>// Releases attachement resources (files)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>checkFailed</span><span class=p>(</span><span class=n>strFmt</span><span class=p>(</span><span class=s>&#34;@ABA32082&#34;</span><span class=p>,</span>  <span class=n>_receiver</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>catch</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>attachmentCollection</span><span class=p>.</span><span class=n>Dispose</span><span class=p>();</span> <span class=c1>// Releases attachement resources (files)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>checkFailed</span><span class=p>(</span><span class=n>strFmt</span><span class=p>(</span><span class=s>&#34;@ABA32082&#34;</span><span class=p>,</span>  <span class=n>_receiver</span><span class=p>));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>true</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// archive the files.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=k>void</span> <span class=n>fileArchive</span><span class=p>(</span><span class=n>Filename</span> <span class=n>_file</span><span class=p>,</span> <span class=n>FilePath</span> <span class=n>_archivePath</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>Filename</span>            <span class=n>filenameArchive</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>InteropPermission</span>   <span class=n>interopPermission</span> <span class=p>=</span> <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span>                 <span class=n>interopPermissionSet</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Set</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>Class</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>_archivePath</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Granting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>interopPermissionSet</span><span class=p>.</span><span class=k>add</span><span class=p>(</span><span class=n>interopPermission</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>assertMultiple</span><span class=p>(</span><span class=n>interopPermissionSet</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>filenameArchive</span> <span class=p>=</span> <span class=n>_archivePath</span> <span class=p>+</span> <span class=n>AmcBankFile</span><span class=p>::</span><span class=n>getFileNameAndExtension</span><span class=p>(</span><span class=n>_file</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>File</span><span class=p>::</span><span class=n>Delete</span><span class=p>(</span><span class=n>filenameArchive</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>File</span><span class=p>::</span><span class=n>Move</span><span class=p>(</span><span class=n>_file</span><span class=p>,</span> <span class=n>filenameArchive</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Reverting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// getting the filename and extesion in container.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>Filename</span> <span class=n>getFileNameAndExtension</span><span class=p>(</span><span class=n>Filename</span> <span class=n>_filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>_filename</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=err>&#39;&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>strFmt</span><span class=p>(</span><span class=err>&#39;</span><span class=p>%</span><span class=m>1</span><span class=p>%</span><span class=m>2</span><span class=err>&#39;</span><span class=p>,</span> <span class=n>conPeek</span><span class=p>(</span><span class=n>Global</span><span class=p>::</span><span class=n>fileNameSplit</span><span class=p>(</span><span class=n>_filename</span><span class=p>),</span> <span class=m>2</span><span class=p>),</span>     <span class=c1>// Filename</span>
</span></span><span class=line><span class=cl>                          <span class=n>conPeek</span><span class=p>(</span><span class=n>Global</span><span class=p>::</span><span class=n>fileNameSplit</span><span class=p>(</span><span class=n>_filename</span><span class=p>),</span> <span class=m>3</span><span class=p>));</span>    <span class=c1>// File extension (including</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>prefixed</span> <span class=n>dot</span> <span class=p>(.))</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//FolderExists</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>boolean</span> <span class=n>folderExists</span><span class=p>(</span><span class=n>FilePath</span> <span class=n>_directory</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>boolean</span>             <span class=n>dirExists</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>InteropPermission</span>   <span class=n>interopPermission</span> <span class=p>=</span> <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span>                 <span class=n>interopPermissionSet</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Set</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>Class</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Granting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>interopPermissionSet</span><span class=p>.</span><span class=k>add</span><span class=p>(</span><span class=n>interopPermission</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>assertMultiple</span><span class=p>(</span><span class=n>interopPermissionSet</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dirExists</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>Directory</span><span class=p>::</span><span class=n>Exists</span><span class=p>(</span><span class=n>_directory</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Reverting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dirExists</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///  internal use only.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;text&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// A String value.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// A String value.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=n>str</span> <span class=n>trimLeadingTabs</span><span class=p>(</span><span class=n>str</span> <span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>len</span> <span class=p>=</span> <span class=n>strlen</span><span class=p>(</span><span class=n>text</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>start</span> <span class=p>=</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>((</span><span class=n>start</span> <span class=p>&lt;=</span> <span class=n>len</span><span class=p>)</span> <span class=p>&amp;&amp;</span> <span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=m>1</span><span class=p>)</span> <span class=p>==</span> <span class=sc>&#39;\t&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>++;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>text</span> <span class=p>=</span> <span class=n>substr</span><span class=p>(</span><span class=n>text</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>len</span> <span class=p>-</span> <span class=n>start</span> <span class=p>+</span> <span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>text</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///  internal use only.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// A String value.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>getClrErrorMessage</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>File</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>exceptionMessage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Exception</span> <span class=n>exObject</span><span class=p>,</span> <span class=n>innerException</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// BP deviation documented</span>
</span></span><span class=line><span class=cl>    <span class=n>exObject</span> <span class=p>=</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getLastException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>exObject</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// We will ignore the first message since it is always a fixed message of</span>
</span></span><span class=line><span class=cl>        <span class=c1>// &#34;Exception has been thrown from target of invocation&#34;, this is from the reflection API being used</span>
</span></span><span class=line><span class=cl>        <span class=c1>// &#34;ClrObject could not be created.&#34; - This is also of no use in most cases</span>
</span></span><span class=line><span class=cl>        <span class=n>innerException</span> <span class=p>=</span> <span class=n>exObject</span><span class=p>.</span><span class=n>get_InnerException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>innerException</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// BP deviation documented</span>
</span></span><span class=line><span class=cl>            <span class=n>exceptionMessage</span> <span class=p>=</span> <span class=n>exceptionMessage</span> <span class=p>+</span> <span class=err>#</span><span class=n>delimiterSpace</span> <span class=p>+</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getAnyTypeForObject</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>(</span><span class=n>innerException</span><span class=p>.</span><span class=n>get_Message</span><span class=p>());</span>
</span></span><span class=line><span class=cl>            <span class=n>innerException</span> <span class=p>=</span> <span class=n>innerException</span><span class=p>.</span><span class=n>get_InnerException</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>exceptionMessage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Parse date from string</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>date</span> <span class=n>parseDate</span><span class=p>(</span><span class=n>str</span> <span class=n>dateText</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=n>dateTimeText</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>dateTimeObject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>utcdatetime</span> <span class=n>dateTimeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>date</span> <span class=n>dateValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dateTimeText</span> <span class=p>=</span> <span class=n>strFmt</span><span class=p>(</span><span class=err>&#39;</span><span class=p>%</span><span class=m>1</span><span class=n>T00</span><span class=p>:</span><span class=m>00</span><span class=p>:</span><span class=m>00</span><span class=n>Z</span><span class=err>&#39;</span><span class=p>,</span> <span class=n>dateText</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// BP Deviation Documented</span>
</span></span><span class=line><span class=cl>    <span class=n>dateTimeObject</span> <span class=p>=</span> <span class=n>Microsoft</span><span class=p>.</span><span class=n>Dynamics</span><span class=p>.</span><span class=n>IntegrationFramework</span><span class=p>.</span><span class=n>Util</span><span class=p>::</span><span class=n>ParseXmlDateTime</span><span class=p>(</span><span class=n>dateTimeText</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// If the returned object is null, then deserialization failed</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>CLRInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;@SYS112380&#34;</span><span class=p>,</span> <span class=n>dateText</span><span class=p>,</span> <span class=n>enum2str</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>Date</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dateTimeValue</span> <span class=p>=</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getAnyTypeForObject</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// If the utcdatetime value is null, then the value is outside the valid range</span>
</span></span><span class=line><span class=cl>    <span class=c1>// unless the input was a null datetime</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dateTimeValue</span> <span class=p>==</span> <span class=n>utcDateTimeNull</span><span class=p>()</span> <span class=p>&amp;&amp;</span> <span class=p>!</span><span class=n>AifUtil</span><span class=p>::</span><span class=n>isNullDateTime</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;@SYS112380&#34;</span><span class=p>,</span> <span class=n>dateText</span><span class=p>,</span> <span class=n>enum2str</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>Date</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dateValue</span> <span class=p>=</span> <span class=n>DateTimeUtil</span><span class=p>::</span><span class=n>date</span><span class=p>(</span><span class=n>dateTimeValue</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dateValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Parse DateTime from string</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>utcdatetime</span> <span class=n>parseDateTime</span><span class=p>(</span><span class=n>str</span> <span class=n>dateTimeText</span><span class=p>,</span> <span class=n>System</span><span class=p>.</span><span class=n>DateTimeKind</span> <span class=n>expectedDateTimeKind</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>ClrObject</span> <span class=n>dateTimeObject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>utcdatetime</span> <span class=n>dateTimeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>DateTime</span> <span class=n>systemDateTimeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// BP Deviation Documented</span>
</span></span><span class=line><span class=cl>    <span class=n>dateTimeObject</span> <span class=p>=</span> <span class=n>Microsoft</span><span class=p>.</span><span class=n>Dynamics</span><span class=p>.</span><span class=n>IntegrationFramework</span><span class=p>.</span><span class=n>Util</span><span class=p>::</span><span class=n>ParseXmlDateTime</span><span class=p>(</span><span class=n>dateTimeText</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// If the returned object is null, then deserialization failed</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>CLRInterop</span><span class=p>::</span><span class=n>isNull</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;@SYS112380&#34;</span><span class=p>,</span> <span class=n>dateTimeText</span><span class=p>,</span> <span class=n>enum2str</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>UtcDateTime</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dateTimeValue</span> <span class=p>=</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getAnyTypeForObject</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// If the utcdatetime value is null, then the value is outside the valid range</span>
</span></span><span class=line><span class=cl>    <span class=c1>// unless the input was a null datetime</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dateTimeValue</span> <span class=p>==</span> <span class=n>utcDateTimeNull</span><span class=p>()</span> <span class=p>&amp;&amp;</span> <span class=p>!</span><span class=n>AifUtil</span><span class=p>::</span><span class=n>isNullDateTime</span><span class=p>(</span><span class=n>dateTimeObject</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;@SYS112380&#34;</span><span class=p>,</span> <span class=n>dateTimeText</span><span class=p>,</span> <span class=n>enum2str</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>UtcDateTime</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// If the value is of unexpected kind, throw an error.</span>
</span></span><span class=line><span class=cl>    <span class=n>systemDateTimeValue</span> <span class=p>=</span> <span class=n>dateTimeObject</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>systemDateTimeValue</span><span class=p>.</span><span class=n>get_Kind</span><span class=p>()</span> <span class=p>!=</span> <span class=n>expectedDateTimeKind</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strfmt</span><span class=p>(</span><span class=s>&#34;@SYS112380&#34;</span><span class=p>,</span> <span class=n>dateTimeText</span><span class=p>,</span> <span class=n>enum2str</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>UtcDateTime</span><span class=p>)));</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dateTimeValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// get the sequence number for the dateformat.</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=kt>int</span> <span class=n>getSequenceForDateFormat</span><span class=p>(</span> <span class=n>DateFormat</span> <span class=n>_dateFormat</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>switch</span> <span class=p>(</span><span class=n>_dateFormat</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>YMD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>321</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>DMY</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>123</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>DYM</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>132</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>MDY</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>213</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>MYD</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>231</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>case</span> <span class=n>DateFormat</span><span class=p>::</span><span class=n>YDM</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>312</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>default</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=m>123</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// returns time from str.</span>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=n>str2Time</span><span class=p>(</span><span class=n>str</span> <span class=m>8</span> <span class=n>_timeStr</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>     <span class=n>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>0</span><span class=p>,</span><span class=m>2</span><span class=p>))</span> <span class=p>*</span> <span class=m>3600</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>4</span><span class=p>,</span><span class=m>2</span><span class=p>))</span> <span class=p>*</span> <span class=m>60</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span> <span class=p>+=</span> <span class=n>str2int</span><span class=p>(</span><span class=n>substr</span><span class=p>(</span><span class=n>_timeStr</span><span class=p>,</span><span class=m>7</span><span class=p>,</span><span class=m>2</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>time</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// &lt;CostCenter:Department&gt; _dimaatributesString,</span>
</span></span><span class=line><span class=cl><span class=c1>// &lt;1010:MBS&gt; dimValueString</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>RecId</span> <span class=n>generateDefaultDimension</span><span class=p>(</span><span class=n>Str</span>                        <span class=n>_dimValueString</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                             <span class=n>str</span>                        <span class=n>_dimaatributesString</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                             <span class=n>str</span>                        <span class=n>_delimeter</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span>                           <span class=n>dimAttributeList</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                        <span class=n>dimValueList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>                                 <span class=n>j</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>RecId</span>                               <span class=n>defDimRecId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DimensionAttributeValueSetStorage</span>   <span class=n>storage</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_dimaatributesString</span> <span class=p>&amp;&amp;</span> <span class=n>_dimValueString</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>dimAttributeList</span> <span class=p>=</span> <span class=n>str2con</span><span class=p>(</span><span class=n>_sourceProperties</span><span class=p>,</span> <span class=n>_delimeter</span><span class=p>,</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>dimValueList</span>     <span class=p>=</span> <span class=n>str2con</span><span class=p>(</span><span class=n>_dimValueString</span><span class=p>,</span> <span class=n>_delimeter</span><span class=p>,</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=p>(!</span><span class=n>dimValueList</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>throw</span> <span class=n>error</span><span class=p>(</span><span class=n>strFmt</span><span class=p>(</span><span class=s>&#34;This dimvalue string was not available&#34;</span><span class=p>));</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>storage</span> <span class=p>=</span> <span class=k>new</span> <span class=n>DimensionAttributeValueSetStorage</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>j</span><span class=p>=</span><span class=m>1</span><span class=p>;</span><span class=n>j</span><span class=p>&lt;=</span><span class=n>conLen</span><span class=p>(</span><span class=n>dimValueList</span><span class=p>);</span><span class=n>j</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span><span class=p>(</span><span class=n>conPeek</span><span class=p>(</span><span class=n>dimValueList</span><span class=p>,</span><span class=n>j</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>DMFDimensionHelper</span><span class=p>::</span><span class=n>dynamicDimensionCreation</span><span class=p>(</span><span class=n>dimAttributeList</span><span class=p>,</span> <span class=n>dimValueList</span><span class=p>,</span> <span class=n>j</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>storage</span><span class=p>.</span><span class=n>addItem</span><span class=p>(</span><span class=n>DimensionAttributeValue</span><span class=p>::</span><span class=n>findByDimensionAttributeAndValue</span><span class=p>(</span><span class=n>DimensionAttribute</span><span class=p>::</span><span class=n>findByName</span><span class=p>(</span><span class=n>conPeek</span><span class=p>(</span><span class=n>dimAttributeList</span><span class=p>,</span><span class=n>j</span><span class=p>)),</span> <span class=n>conPeek</span><span class=p>(</span><span class=n>dimValueList</span><span class=p>,</span><span class=n>j</span><span class=p>),</span> <span class=k>false</span><span class=p>,</span> <span class=k>true</span><span class=p>));</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>defDimRecId</span> <span class=p>=</span> <span class=n>storage</span><span class=p>.</span><span class=n>save</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>defDimRecId</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Generate the Dimension String from default dimension</span>
</span></span><span class=line><span class=cl><span class=c1>// &lt;CostCenter:Department&gt; dimAttributeString</span>
</span></span><span class=line><span class=cl><span class=c1>// &lt;1010:MBS&gt; dimValueString</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>generateDefaultDimensionStr</span><span class=p>(</span><span class=n>RefRecId</span>  <span class=n>_defaultDimension</span><span class=p>,</span><span class=n>str</span> <span class=n>_dimattrString</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                                  <span class=n>str</span> <span class=n>_delimeter</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>DMFDefaultDimensionStr</span>              <span class=n>defaultDimensionStr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DimensionAttributeValueSetItem</span>      <span class=n>setItem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DimensionAttributeValue</span>             <span class=n>dimAttrValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DimensionAttribute</span>                  <span class=n>dimAttr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span>                           <span class=n>con</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Int</span>                                 <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>DimensionValue</span>                      <span class=n>displayValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>con</span> <span class=p>=</span> <span class=n>str2con</span><span class=p>(</span><span class=n>_dimattrString</span><span class=p>,</span><span class=n>_delimeter</span><span class=p>,</span><span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_dimattrString</span> <span class=p>&amp;&amp;</span> <span class=n>_defaultDimension</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span><span class=p>(</span> <span class=n>i</span> <span class=p>=</span> <span class=m>1</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;=</span> <span class=n>conLen</span><span class=p>(</span><span class=n>con</span><span class=p>);</span> <span class=n>i</span> <span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>displayValue</span> <span class=p>=</span> <span class=n>conPeek</span><span class=p>(</span><span class=n>con</span><span class=p>,</span><span class=n>i</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=k>select</span> <span class=n>RecId</span><span class=p>,</span> <span class=n>DisplayValue</span> <span class=k>from</span> <span class=n>setItem</span> <span class=k>where</span> <span class=n>setItem</span><span class=p>.</span><span class=n>DimensionAttributeValueSet</span> <span class=p>==</span> <span class=n>_defaultDimension</span>
</span></span><span class=line><span class=cl>                <span class=k>join</span> <span class=n>RecId</span> <span class=k>from</span> <span class=n>dimAttrValue</span> <span class=k>where</span>
</span></span><span class=line><span class=cl>                     <span class=n>dimAttrValue</span><span class=p>.</span><span class=n>RecId</span> <span class=p>==</span> <span class=n>setItem</span><span class=p>.</span><span class=n>DimensionAttributeValue</span> <span class=p>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                     <span class=n>dimAttrValue</span><span class=p>.</span><span class=n>IsDeleted</span> <span class=p>==</span> <span class=k>false</span>
</span></span><span class=line><span class=cl>                 <span class=k>join</span> <span class=n>RecId</span> <span class=k>from</span> <span class=n>dimAttr</span>
</span></span><span class=line><span class=cl>                    <span class=k>where</span>  <span class=n>dimAttr</span><span class=p>.</span><span class=n>RecId</span> <span class=p>==</span> <span class=n>dimAttrValue</span><span class=p>.</span><span class=n>DimensionAttribute</span>
</span></span><span class=line><span class=cl>                       <span class=p>&amp;&amp;</span>  <span class=n>dimAttr</span><span class=p>.</span><span class=n>Name</span>  <span class=p>==</span> <span class=n>displayValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>defaultDimensionStr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=n>defaultDimensionStr</span> <span class=p>+=</span> <span class=n>_delimeter</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=n>defaultDimensionStr</span> <span class=p>+=</span> <span class=n>setItem</span><span class=p>.</span><span class=n>DisplayValue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>defaultDimensionStr</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=n>strLineCount</span><span class=p>(</span><span class=n>str</span> <span class=n>freeTxt</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>  <span class=n>start</span>  <span class=p>=</span> <span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>  <span class=n>end</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>  <span class=n>length</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>  <span class=n>lines</span>  <span class=p>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>length</span><span class=p>=</span><span class=n>strLen</span><span class=p>(</span><span class=n>freeTxt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>end</span> <span class=p>=</span> <span class=n>strScan</span><span class=p>(</span><span class=n>freeTxt</span><span class=p>,</span> <span class=sc>&#39;\n&#39;</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>start</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span><span class=p>+=</span><span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>end</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span><span class=p>=</span><span class=n>end</span><span class=p>+</span><span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>end</span> <span class=p>=</span> <span class=n>strScan</span><span class=p>(</span><span class=n>freeTxt</span><span class=p>,</span> <span class=sc>&#39;\n&#39;</span><span class=p>,</span> <span class=n>start</span><span class=p>,</span> <span class=n>length</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=k>else</span>
</span></span><span class=line><span class=cl>            <span class=n>start</span><span class=p>=</span><span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(!</span><span class=n>lines</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span><span class=p>=</span><span class=m>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>lines</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Determines whether the specified string is a date time string.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;_value&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// The string to check.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// true if it is date time; otherwise, false.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;remarks&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Input can have a format like &#34;5/7/2010 12:00:00 AM&#34; or &#34;2010-05-07T00:00:00. Both cases will be</span>
</span></span><span class=line><span class=cl><span class=cs>/// handled.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/remarks&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>boolean</span> <span class=n>isDateTimeStr</span><span class=p>(</span><span class=n>str</span> <span class=n>_value</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>boolean</span> <span class=n>isDateTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>RegularExpressions</span><span class=p>.</span><span class=n>Regex</span> <span class=n>regex</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>RegularExpressions</span><span class=p>.</span><span class=n>Match</span> <span class=n>regexMatch</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cp>#define.MatchTimeRegex(@&#34;[\sT]\d{1,2}:\d{1,2}:\d{1,2}&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=cp>#define.ISODateTimeIdentifier(&#34;T&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=cp>#define.ZeroTime(&#34;00:00:00&#34;)</span>
</span></span><span class=line><span class=cl>    <span class=cp>#define.DefaultLCID(1033)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// check if in ISO format.</span>
</span></span><span class=line><span class=cl>    <span class=n>isDateTime</span> <span class=p>=</span> <span class=n>strFind</span><span class=p>(</span><span class=n>_value</span><span class=p>,</span> <span class=err>#</span><span class=n>ISODateTimeIdentifier</span><span class=p>,</span> <span class=m>0</span><span class=p>,</span> <span class=n>strLen</span><span class=p>(</span><span class=n>_value</span><span class=p>))</span> <span class=p>&gt;</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(!</span><span class=n>isDateTime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// search for a time on the value</span>
</span></span><span class=line><span class=cl>        <span class=c1>// BP deviation documented</span>
</span></span><span class=line><span class=cl>        <span class=n>regex</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>RegularExpressions</span><span class=p>.</span><span class=n>Regex</span><span class=p>(</span><span class=err>#</span><span class=n>MatchTimeRegex</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// BP deviation documented</span>
</span></span><span class=line><span class=cl>        <span class=n>regexMatch</span> <span class=p>=</span> <span class=n>regex</span><span class=p>.</span><span class=n>Match</span><span class=p>(</span><span class=n>_value</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>isDateTime</span> <span class=p>=</span> <span class=n>regexMatch</span><span class=p>.</span><span class=n>get_Success</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>isDateTime</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>//Swapping the key value from map</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Creates a &lt;c&gt;Map&lt;/c&gt; class with the value and key swapped.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;_key2ValueMap&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// Map that has the keys and values swapped.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// A map that has the value switched with the keys.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>Map</span> <span class=n>getValue2KeyMap</span><span class=p>(</span><span class=n>Map</span> <span class=n>_key2ValueMap</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// reverses the valid values map. The original map contains &lt;key, label&gt;, we will create a &lt;label, key&gt;</span>
</span></span><span class=line><span class=cl>    <span class=n>Map</span> <span class=n>value2KeyMap</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>MapEnumerator</span> <span class=n>mapEnum</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span><span class=p>(</span><span class=n>_key2ValueMap</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>value2KeyMap</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Map</span><span class=p>(</span><span class=n>_key2ValueMap</span><span class=p>.</span><span class=n>valueType</span><span class=p>(),</span> <span class=n>_key2ValueMap</span><span class=p>.</span><span class=n>keyType</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=n>mapEnum</span> <span class=p>=</span> <span class=n>_key2ValueMap</span><span class=p>.</span><span class=n>getEnumerator</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span><span class=p>(</span><span class=n>mapEnum</span><span class=p>.</span><span class=n>moveNext</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>value2KeyMap</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>mapEnum</span><span class=p>.</span><span class=n>currentValue</span><span class=p>(),</span> <span class=n>mapEnum</span><span class=p>.</span><span class=n>currentKey</span><span class=p>());</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>value2KeyMap</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c# data-lang=c#><span class=line><span class=cl><span class=c1>//Show viewhistory on form datasources if you have ValidaTimeState Enabled DateTime enabled on the tables of that form. </span>
</span></span><span class=line><span class=cl><span class=c1>//create this method in Global class so you can call whereever you want in form button click as below.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>void</span> <span class=n>clicked</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>buttonHistoryClick</span><span class=p>(</span><span class=n>element</span><span class=p>,</span> <span class=k>this</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Super</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=k>public</span> <span class=k>void</span> <span class=n>buttonHistoryClick</span><span class=p>(</span><span class=n>FormRun</span> <span class=n>_formRun</span><span class=p>,</span> <span class=n>FormButtonControl</span> <span class=n>_fbc</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>void</span> <span class=n>changeDataSources</span><span class=p>(</span><span class=n>ValidTimeStateAutoQuery</span> <span class=n>_from</span><span class=p>,</span> <span class=n>ValidTimeStateAutoQuery</span> <span class=n>_to</span><span class=p>,</span> <span class=n>boolean</span> <span class=n>_allowDelete</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>Counter</span>         <span class=n>dataSourceNo</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>FormDataSource</span>  <span class=n>formDataSource</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>dataSourceNo</span><span class=p>=</span><span class=m>1</span><span class=p>;</span><span class=n>_formRun</span><span class=p>.</span><span class=n>dataSourceCount</span><span class=p>()&gt;=</span><span class=n>dataSourceNo</span><span class=p>;</span><span class=n>dataSourceNo</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>formDataSource</span> <span class=p>=</span> <span class=n>_formRun</span><span class=p>.</span><span class=n>dataSource</span><span class=p>(</span><span class=n>dataSourceNo</span><span class=p>)</span> <span class=k>as</span> <span class=n>FormDataSource</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>formDataSource</span><span class=p>.</span><span class=n>validTimeStateAutoQuery</span><span class=p>()</span> <span class=p>==</span> <span class=n>_from</span> <span class=p>&amp;&amp;</span> <span class=k>new</span> <span class=n>DictTable</span><span class=p>(</span><span class=n>formDataSource</span><span class=p>.</span><span class=n>table</span><span class=p>()).</span><span class=n>isValidTimeStateTable</span><span class=p>())</span>
</span></span><span class=line><span class=cl>            <span class=p>{</span>
</span></span><span class=line><span class=cl>                <span class=n>formDataSource</span><span class=p>.</span><span class=n>validTimeStateAutoQuery</span><span class=p>(</span><span class=n>_to</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                <span class=k>switch</span> <span class=p>(</span><span class=n>_to</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=p>{</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>AsOfDate</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>validTimeStateAutoQuery</span><span class=p>(</span><span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>AsOfDate</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>query</span><span class=p>().</span><span class=n>resetValidTimeStateQueryType</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>allowDelete</span><span class=p>(</span><span class=n>_allowDelete</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=k>case</span> <span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>DateRange</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>validTimeStateAutoQuery</span><span class=p>(</span><span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>DateRange</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>query</span><span class=p>().</span><span class=n>validTimeStateDateTimeRange</span><span class=p>(</span><span class=n>DateTimeUtil</span><span class=p>::</span><span class=n>minValue</span><span class=p>(),</span> <span class=n>DateTimeUtil</span><span class=p>::</span><span class=n>maxValue</span><span class=p>());</span>
</span></span><span class=line><span class=cl>                        <span class=n>formDataSource</span><span class=p>.</span><span class=n>allowDelete</span><span class=p>(</span><span class=n>_allowDelete</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                <span class=p>}</span>
</span></span><span class=line><span class=cl>                <span class=n>formDataSource</span><span class=p>.</span><span class=n>executeQuery</span><span class=p>();</span>
</span></span><span class=line><span class=cl>            <span class=p>}</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>_fbc</span><span class=p>.</span><span class=n>labelText</span><span class=p>()</span> <span class=p>==</span> <span class=s>&#34;@SYS110266&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>changeDataSources</span><span class=p>(</span><span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>AsOfDate</span><span class=p>,</span> <span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>DateRange</span><span class=p>,</span> <span class=k>false</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_fbc</span><span class=p>.</span><span class=n>text</span><span class=p>(</span><span class=s>&#34;Stoping History&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_fbc</span><span class=p>.</span><span class=n>normalImage</span><span class=p>(</span><span class=s>&#34;10006&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>changeDataSources</span><span class=p>(</span><span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>DateRange</span><span class=p>,</span> <span class=n>ValidTimeStateAutoQuery</span><span class=p>::</span><span class=n>AsOfDate</span><span class=p>,</span> <span class=k>true</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>_fbc</span><span class=p>.</span><span class=n>Text</span><span class=p>(</span><span class=s>&#34;@SYS110266
</span></span></span><span class=line><span class=cl><span class=s></span>        <span class=n>_fbc</span><span class=p>.</span><span class=n>normalImage</span><span class=p>(</span><span class=s>&#34;10007&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// this method is used to create filenameTimeStamp.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>static</span> <span class=n>FileName</span> <span class=n>createFilenameTimeStamp</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>FileName</span>    <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Microsoft</span><span class=p>.</span><span class=n>Dynamics</span><span class=p>.</span><span class=n>IntegrationFramework</span><span class=p>.</span><span class=n>Adapter</span><span class=p>.</span><span class=n>FileSystem</span>       <span class=n>fileSystem</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span><span class=n>Aif</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fileSystem</span>      <span class=p>=</span> <span class=n>AifUtil</span><span class=p>::</span><span class=n>getClrObject</span><span class=p>(</span><span class=err>#</span><span class=n>FileSystemProgId</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=p>=</span> <span class=n>fileSystem</span><span class=p>.</span><span class=n>GetCurrentTimestamp</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// This method is used to split the string, and returns the conatiner with the position defined in the parameter</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>rsaStrSplit</span><span class=p>(</span><span class=n>str</span> <span class=n>_splitString</span><span class=p>,</span><span class=n>str</span> <span class=n>_splitchar</span><span class=p>,</span><span class=kt>int</span> <span class=n>_pos</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>List</span> <span class=n>strlist</span><span class=p>=</span><span class=k>new</span> <span class=n>List</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>String</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>ListIterator</span>    <span class=n>iterator</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>container</span>       <span class=n>packedList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>strlist</span><span class=p>=</span><span class=n>strSplit</span><span class=p>(</span><span class=n>_splitString</span><span class=p>,</span><span class=n>_splitchar</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>iterator</span> <span class=p>=</span> <span class=k>new</span> <span class=n>ListIterator</span><span class=p>(</span><span class=n>strlist</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span><span class=p>(</span><span class=n>iterator</span><span class=p>.</span><span class=n>more</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>packedList</span> <span class=p>+=</span> <span class=n>iterator</span><span class=p>.</span><span class=k>value</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>iterator</span><span class=p>.</span><span class=n>next</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>conPeek</span><span class=p>(</span><span class=n>packedList</span><span class=p>,</span><span class=n>_pos</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>encrypt</span><span class=p>(</span><span class=n>str</span> <span class=n>_input</span><span class=p>,</span> <span class=n>str</span> <span class=n>_salt</span> <span class=p>=</span> <span class=err>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Security</span><span class=p>.</span><span class=n>Cryptography</span><span class=p>.</span><span class=n>SHA512Managed</span>  <span class=n>sha512managed</span> <span class=p>=</span> <span class=k>new</span> <span class=n>System</span><span class=p>.</span><span class=n>Security</span><span class=p>.</span><span class=n>Cryptography</span><span class=p>.</span><span class=n>SHA512Managed</span><span class=p>();</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>Encoding</span>                        <span class=n>encoding</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Text</span><span class=p>.</span><span class=n>Encoding</span><span class=p>::</span><span class=n>get_UTF8</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Byte</span><span class=p>[]</span>                               <span class=n>inputBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Byte</span><span class=p>[]</span>                               <span class=n>resultBytes</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>                                         <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span>                                         <span class=n>returnString</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>).</span><span class=n>assert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>inputBytes</span> <span class=p>=</span> <span class=n>encoding</span><span class=p>.</span><span class=n>GetBytes</span><span class=p>(</span><span class=n>strLwr</span><span class=p>(</span><span class=n>_salt</span><span class=p>)</span> <span class=p>+</span> <span class=n>_input</span><span class=p>);</span> <span class=c1>// Convert lower case salt + input into byte array</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// The input is hashed 1024 times for attack resiliency</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=m>1024</span><span class=p>;</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>resultBytes</span> <span class=p>=</span> <span class=n>resultBytes</span> <span class=p>?</span> <span class=n>resultBytes</span> <span class=p>:</span> <span class=n>inputBytes</span><span class=p>;</span> <span class=c1>// First loop uses input for hashing</span>
</span></span><span class=line><span class=cl>        <span class=n>resultBytes</span> <span class=p>=</span> <span class=n>sha512managed</span><span class=p>.</span><span class=n>ComputeHash</span><span class=p>(</span><span class=n>resultBytes</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>returnString</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>Convert</span><span class=p>::</span><span class=n>ToBase64String</span><span class=p>(</span><span class=n>resultBytes</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>returnString</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>private</span> <span class=k>static</span> <span class=n>Map</span> <span class=n>fileGetList</span><span class=p>(</span><span class=n>FilePath</span>            <span class=n>_filePathArchive</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>    <span class=n>Map</span>                 <span class=n>mapFiles</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>InteropPermission</span>   <span class=n>interopPermission</span> <span class=p>=</span> <span class=k>new</span> <span class=n>InteropPermission</span><span class=p>(</span><span class=n>InteropKind</span><span class=p>::</span><span class=n>ClrInterop</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>Set</span>                 <span class=n>interopPermissionSet</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Set</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>Class</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=p>.</span><span class=n>Array</span>        <span class=n>arrayFiles</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span>                 <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Granting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>interopPermissionSet</span><span class=p>.</span><span class=k>add</span><span class=p>(</span><span class=n>interopPermission</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>assertMultiple</span><span class=p>(</span><span class=n>interopPermissionSet</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>mapFiles</span> <span class=p>=</span> <span class=k>new</span> <span class=n>Map</span><span class=p>(</span><span class=n>Types</span><span class=p>::</span><span class=n>String</span><span class=p>,</span> <span class=n>Types</span><span class=p>::</span><span class=n>String</span><span class=p>);</span> <span class=c1>// Key = return file | Value = archive path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(!</span><span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>Directory</span><span class=p>::</span><span class=n>Exists</span><span class=p>(</span><span class=n>_filePathArchive</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=k>throw</span>  <span class=n>error</span><span class=p>(</span><span class=s>&#34;Path doesnt exist&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>arrayFiles</span> <span class=p>=</span> <span class=n>System</span><span class=p>.</span><span class=n>IO</span><span class=p>.</span><span class=n>Directory</span><span class=p>::</span><span class=n>GetFiles</span><span class=p>(</span><span class=n>_filePathArchive</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// CLRInterop::getAnyTypeForObject method is used to handle difference in AX and System types (e.g. System.Int32 != int)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=n>i</span> <span class=p>=</span> <span class=m>0</span><span class=p>;</span> <span class=n>i</span> <span class=p>&lt;</span> <span class=n>CLRInterop</span><span class=p>::</span><span class=n>getAnyTypeForObject</span><span class=p>(</span><span class=n>arrayFiles</span><span class=p>.</span><span class=n>get_Length</span><span class=p>());</span> <span class=n>i</span><span class=p>++)</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>       <span class=n>mapFiles</span><span class=p>.</span><span class=n>insert</span><span class=p>(</span><span class=n>CLRInterop</span><span class=p>::</span><span class=n>getAnyTypeForObject</span><span class=p>(</span><span class=n>arrayFiles</span><span class=p>.</span><span class=n>GetValue</span><span class=p>(</span><span class=n>i</span><span class=p>)),</span> <span class=n>_filePathArchive</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Reverting file permission rights</span>
</span></span><span class=line><span class=cl>    <span class=n>CodeAccessPermission</span><span class=p>::</span><span class=n>revertAssert</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>mapFiles</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>///  Gets the SenderID from AIF xml .</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/summary&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;param name=&#34;messagePartsXml&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// An &lt;c&gt;AifXml&lt;/c&gt; value.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/param&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;returns&gt;</span>
</span></span><span class=line><span class=cl><span class=cs>/// An instance of the &lt;c&gt;str document Namespace&lt;/c&gt; class.</span>
</span></span><span class=line><span class=cl><span class=cs>/// &lt;/returns&gt;</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>static</span> <span class=n>str</span> <span class=n>getSenderIDValue</span><span class=p>(</span><span class=n>AifXml</span> <span class=n>messagePartsXml</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>     <span class=n>XmlTextReader</span>               <span class=n>xmlReader</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>str</span> <span class=k>value</span><span class=p>,</span><span class=n>currentElement</span><span class=p>,</span><span class=n>pureElement</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=err>#</span><span class=n>Aif</span>
</span></span><span class=line><span class=cl>    <span class=n>xmlReader</span> <span class=p>=</span> <span class=n>XmlTextReader</span><span class=p>::</span><span class=n>newXml</span><span class=p>(</span><span class=n>messagePartsXml</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=p>(</span><span class=n>xmlReader</span><span class=p>.</span><span class=n>Read</span><span class=p>())</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>switch</span> <span class=p>(</span><span class=n>xmlReader</span><span class=p>.</span><span class=n>nodeType</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=p>{</span>
</span></span><span class=line><span class=cl>             <span class=k>case</span> <span class=n>XmlNodeType</span><span class=p>::</span><span class=n>Element</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                  <span class=n>currentElement</span> <span class=p>=</span> <span class=n>xmlReader</span><span class=p>.</span><span class=n>name</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                 <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>             <span class=k>case</span> <span class=n>XmlNodeType</span><span class=p>::</span><span class=n>Text</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                  <span class=n>pureElement</span> <span class=p>=</span> <span class=n>subStr</span><span class=p>(</span><span class=n>currentElement</span><span class=p>,</span><span class=n>strFind</span><span class=p>(</span><span class=n>currentElement</span><span class=p>,</span><span class=sc>&#39;:&#39;</span><span class=p>,</span><span class=m>1</span><span class=p>,</span><span class=m>256</span><span class=p>)+</span><span class=m>1</span><span class=p>,</span><span class=m>256</span><span class=p>);</span>
</span></span><span class=line><span class=cl>                    <span class=k>switch</span> <span class=p>(</span><span class=n>pureElement</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                    <span class=p>{</span>
</span></span><span class=line><span class=cl>                       <span class=k>case</span> <span class=s>&#34;SenderId&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                        <span class=p>{</span>
</span></span><span class=line><span class=cl>                            <span class=k>value</span><span class=p>=</span><span class=n>xmlReader</span><span class=p>.</span><span class=k>value</span><span class=p>();</span>
</span></span><span class=line><span class=cl>                            <span class=k>return</span> <span class=k>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        <span class=p>}</span>
</span></span><span class=line><span class=cl>                        <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                    <span class=p>}</span>
</span></span><span class=line><span class=cl>              <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=k>value</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on December 30, 2016</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/2016-12-30-useful-functions-to-use-in-ax-2012/index.md target=_blank>Read Markdown</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-title="Useful functions to use in AX 2012" data-hashtags=xpp><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-hashtag=xpp><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Linkedin" data-sharer=linkedin data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/><i class="fab fa-linkedin fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on WhatsApp" data-sharer=whatsapp data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-title="Useful functions to use in AX 2012" data-web><i class="fab fa-whatsapp fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-title="Useful functions to use in AX 2012"><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-title="Useful functions to use in AX 2012"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on " data-sharer=weibo data-url=https://nuxulu.com/2016-12-30-useful-functions-to-use-in-ax-2012/ data-title="Useful functions to use in AX 2012"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/xpp/>xpp</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/2016-12-29-crud-purchase-requisition-using-aif-in-dynamics-ax-2012-r3/ class=prev rel=prev title="CRUD Purchase Requisition using AIF in Dynamics AX 2012 R3"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>CRUD Purchase Requisition using AIF in Dynamics AX 2012 R3</a>
<a href=/2017-01-01-difference-between-queryfilter-and-querybuildrange/ class=next rel=next title="Difference between QueryFilter and QueryBuildRrange">Difference between QueryFilter and QueryBuildRrange<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=disqus_thread class=comment></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://disqus.com/?ref_noscript>Disqus</a>.</noscript></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><a href=https://www.buymeacoffee.com/maxnguyen target=_blank><img src="https://img.buymeacoffee.com/button-api/?text=Buy me a coffee&emoji=&slug=maxnguyen&button_colour=eacd61&font_colour=000000&font_family=Cookie&outline_colour=000000&coffee_colour=FFDD00"></a></div><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.111.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2013 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/about/ target=_blank>Max Nguyen</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/css/lightgallery-bundle.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://https-dynamics365-github-io.disqus.com/embed.js defer></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/lightgallery.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/thumbnail/lg-thumbnail.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lightgallery@2.5.0/plugins/zoom/lg-zoom.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:300},comment:{},lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",maxResultLength:10,noResultsFound:"No results found",snippetLength:30,type:"lunr"},twemoji:!0}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-57379422-3",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-57379422-3" async></script></body></html>