<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="noodp"/><title>Create and write to XML file in Dynamics AX | </title><meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content=""/>
<meta name="twitter:title" content="Create and write to XML file in Dynamics AX"/>
<meta name="twitter:description" content="Create and write to XML file in Dynamics AX"/><meta name="Description" content="Create and write to XML file in Dynamics AX"><meta property="og:title" content="Create and write to XML file in Dynamics AX" />
<meta property="og:description" content="Create and write to XML file in Dynamics AX" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://nuxulu.com/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax/" /><meta property="og:image" content="https://nuxulu.com/Icon/mstile-150x150.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2015-02-04T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2015-02-04T00:00:00&#43;00:00" />

<meta name="application-name" content="UBlogger">
<meta name="apple-mobile-web-app-title" content="UBlogger"><meta name="msapplication-TileColor" content="#da532c"><link rel="icon" href="/Icon/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://nuxulu.com/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax/" /><script data-ad-client="pub-3534873375492458" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><meta name="google-site-verification" content="f08c47fec0942fa0" /><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Create and write to XML file in Dynamics AX",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/nuxulu.com\/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax\/"
        },"genre": "posts","keywords": "trick, xpp, programming","wordCount":  501 ,
        "url": "https:\/\/nuxulu.com\/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax\/","datePublished": "2015-02-04T00:00:00+00:00","dateModified": "2015-02-04T00:00:00+00:00","description": "Create and write to XML file in Dynamics AX"
    }
    </script><script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https:\/\/nuxulu.com"
        },{
            "@type": "ListItem",
            "position": 2,
            "name": "ax2012",
            "item": "https://nuxulu.com/categories/ax2012/"
        },{
                "@type": "ListItem",
                "position": 3,
                "name": "Create and write to XML file in Dynamics AX"
            }]
    }
</script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script>(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Dynamics 365 &amp; Power Platform | NUXULU" class="header-logo logo-svg"><img loading="lazy" decoding="async"
         src="/Icon/favicon-32x32.png"
         alt="/Icon/favicon-32x32.png"
         title="/Icon/favicon-32x32.png"
    />Finance Operations &amp; Power Platform Archive</a>
        </div>
        <div class="menu">
            <nav>
                <ul class="menu-inner"><li>
                        <a class="menu-item" href="/posts/"> Posts </a>
                    </li><li>
                        <a class="menu-item" href="/tags/"> Tags </a>
                    </li><li>
                        <a class="menu-item" href="/categories/"> Categories </a>
                    </li><li>
                        <a class="menu-item" href="/about/"> About </a>
                    </li></ul>
            </nav><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <span class="svg-icon icon-search"></span>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <span class="svg-icon icon-cancel"></span>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <span class="svg-icon icon-loading"></span>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <span class="svg-icon icon-moon"></span>
                </a>
            </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Dynamics 365 &amp; Power Platform | NUXULU" class="header-logo"><img loading="lazy" decoding="async"
         src="/Icon/favicon-32x32.png"
         alt="/Icon/favicon-32x32.png"
         title="/Icon/favicon-32x32.png"
    />Finance Operations &amp; Power Platform Archive</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <span class="svg-icon icon-search"></span>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <span class="svg-icon icon-cancel"></span>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <span class="svg-icon icon-loading"></span>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><nav>
                <ul><li>
                        <a class="menu-item" href="/posts/" title="">Posts</a>
                    </li><li>
                        <a class="menu-item" href="/tags/" title="">Tags</a>
                    </li><li>
                        <a class="menu-item" href="/categories/" title="">Categories</a>
                    </li><li>
                        <a class="menu-item" href="/about/" title="">About</a>
                    </li></ul>
            </nav>
            <a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <span class="svg-icon icon-moon"></span>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
<div class="container content-article page-toc theme-classic"><div class="toc" id="toc-auto">
            <div class="toc-title">Contents</div>
            <div class="toc-content" id="toc-content-auto"></div>
        </div>

    <div class="header-post">

        

        
        <div class="post-title">

                <div class="post-all-meta">
                    <nav class="breadcrumbs">
    <ol>
        <li><a href="/">Home </a></li><li><a href="/categories/ax2012/">ax2012 </a></li><li>Create and write to XML file in Dynamics AX</li>
    </ol>
</nav>
                    <h1 class="single-title flipInX">Create and write to XML file in Dynamics AX</h1><div class="post-meta">
                        <div class="post-meta-line"><span class="post-category">
                                <a href="/categories/ax2012/"><i class="svg-icon icon-folder"></i>ax2012</a>&nbsp;<a href="/categories/trick/"><i class="svg-icon icon-folder"></i>trick</a>
                            </span><span class="post-meta-date">
                                <i class="svg-icon icon-clock"></i><time class="timeago" datetime="2015-02-04">February 4, 2015</time>
                            </span><span class="post-meta-words">
                                <i class="svg-icon icon-pencil"></i>501 words
                            </span>
                            <span class="post-meta-reading">
                                <i class="svg-icon icon-stopwatch"></i>3 minutes
                            </span>
                        </div>
                    </div>
                </div>

            </div>

            </div>

    <article class="single toc-start">

        <div class="content-block content-block-first content-block-position">

        <div class="post"><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><p>In this post let&rsquo;s explore creating XML using X++ code in Dynamics AX.</p>
<p>The following example shows how to create and write data to an XML file by using the <code>XmlDocument</code>, <code>XmlElement</code>, and <code>XmlWriter</code> classes. It loops through all of the records in the <code>CarTable</code> and find all the fields in the table automatically by using the <code>DictTable</code> and <code>DictField</code> classes.</p>
<p>{% highlight csharp %}
static void WriteXml(Args _args)
{</p>
<pre><code>XmlDocument xmlDoc;
XmlElement xmlRoot;
XmlElement xmlField;
XmlElement xmlRecord;
XMLWriter xmlWriter;

CarTable carTable;
DictTable dTable = new DictTable(tablenum(CarTable));
DictField dField;
int i, fieldId;
str value;
; 

#CarsXmlTags 

// Create a new object of the XmlDocument class
xmlDoc = XmlDocument::newBlank();

// Create the root node
xmlRoot = xmlDoc.createElement(#CarRootNode);

// Loop through all the records in the carTable
while select carTable
{
    // Create a XmlElement (record) to hold the
    // contents of the current record.
    xmlRecord = xmlDoc.createElement(#CarRecords);
    // Loop through all the fields in the record

    for (i=1; i&lt;=dTable.fieldCnt(); i++)
    {
        // Get the fieldId from the field-count
        fieldId = dTable.fieldCnt2Id(i);
        
        // Find the DictField object that matches the fieldId
        dField = dTable.fieldObject(fieldId);
        
        // Skip system fields
        if (dField.isSystem())
        continue;

        // Create a new XmlElement (field) and
        // have the name equal to the name of the
        // dictField
        xmlField = xmlDoc.createElement(dField.name());
        
        // Convert values to string. I have just added
        // a couple of conversion as an example.
        // Use tableName.(fieldId) instead of fieldname
        // to get the content of the field.
        switch (dField.baseType())
        {
            case Types::Int64 :
                value = int642str(carTable.(fieldId));
            break;
            case Types::Integer :
                value = int2str(carTable.(fieldId));
            break;
            default :
                value = carTable.(fieldId);
            break;
        }

        // Set the innerText of the XmlElement (field)
        // to the value from the table
        xmlField.innerText(value);
         
        // Append the field as a child node to the record
        xmlRecord.appendChild(xmlField);
    }
     // Add the record as a child node to the root
    xmlRoot.appendChild(xmlRecord);
}
// Add the root to the XmlDocument
xmlDoc.appendChild(xmlRoot);
// Create a new object of the XmlWriter class
// in order to be able to write the xml to a file
xmlWriter = XMLWriter::newFile(@&quot;c:tempcars.xml&quot;);
// Write the content of the XmlDocument to the
// file as specified by the XmlWriter
xmlDoc.writeTo(xmlWriter);
</code></pre>
<p>}
{% endhighlight %}</p>
<p>The file that is created looks like the one in the following screenshot(only first part of the file is shown):</p>
<p>




<img loading="lazy" decoding="async"
         src="/imagesposts/create-and-write-to-xml-file-in-dynamics-ax_1.png#center"
         alt="/imagesposts/create-and-write-to-xml-file-in-dynamics-ax_1.png#center"
         title="create-and-write-to-xml-file-in-dynamics-ax_1.png#center"
    /></p>
<p>As you can see, this file is based on a standard XML format with tags and values only. You can, however, use tag attributes as well. To put the values from the table into tag attributes instead of their own tags, simply change the following code snippet in the example above</p>
<p>{% highlight csharp %}</p>
<p>// Set the innerText of the XmlElement (field)
// to the value from the table
xmlField.innerText(value);</p>
<p>// Append the field as a child node to the record
xmlRecord.appendChild(xmlField);</p>
<p>{% endhighlight %}</p>
<p>With these lines:</p>
<p>{% highlight csharp %}
// Add the attribute to the record
xmlRecord.setAttribute(dField.name(), value);
{% endhighlight %}</p>
<p>The file that is created now looks like the one in the following screenshot:</p>
<p>




<img loading="lazy" decoding="async"
         src="/imagesposts/create-and-write-to-xml-file-in-dynamics-ax_2.png#center"
         alt="/imagesposts/create-and-write-to-xml-file-in-dynamics-ax_2.png#center"
         title="create-and-write-to-xml-file-in-dynamics-ax_2.png#center"
    /></p></div>

            <div class="post" style="padding-top: 0">


<div class="post-share"><div class="share-link">
        <a class="share-icon share-twitter" href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://nuxulu.com/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax/" data-title="Create and write to XML file in Dynamics AX" data-hashtags="trick,xpp,programming"><span class="svg-social-icon icon-twitter"></span></a>
    </div><div class="share-link">
        <a class="share-icon share-facebook" href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://nuxulu.com/2015-02-04-create-and-write-to-xml-file-in-dynamics-ax/" data-hashtag="trick"><span class="svg-social-icon icon-facebook"></span></a>
    </div></div>
<div class="post-tags"><a href="/tags/trick/" class="tag">trick</a><a href="/tags/xpp/" class="tag">xpp</a><a href="/tags/programming/" class="tag">programming</a></div></div>
        </div>
    <div id="toc-final"></div>
    </article><div class="page single comments content-block-position"></div></div>

</main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Have a nice day!</div><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.83.1">Hugo</a> | Theme - <a href="https://ublogger.netlify.app/?utm_source=https://nuxulu.com&utm_medium=footer&utm_campaign=config&utm_term=2.0.1" target="_blank" title="uBlogger 2.0.1">uBlogger</a>
                </div><div class="footer-line"><i class="svg-icon icon-copyright"></i><span>2013 - 2021</span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="svg-icon icon-arrow-up"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="svg-icon icon-comments-fixed"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script src="/lib/autocomplete/autocomplete.min.js"></script><script src="/lib/lunr/lunr.min.js"></script><script src="/lib/clipboard/clipboard.min.js"></script><script src="/lib/sharer/sharer.min.js"></script><script src="/lib/katex/katex.min.js"></script><script src="/lib/katex/auto-render.min.js"></script><script src="/lib/katex/copy-tex.min.js"></script><script src="/lib/katex/mhchem.min.js"></script><script src="/lib/cookieconsent/cookieconsent.min.js"></script><script>window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":100},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script src="/js/theme.min.js"></script><script>
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

	        ga('create', 'UA-57379422-3', 'auto');
	        ga('set', 'anonymizeIp', true);
	        ga('send', 'pageview');
	    </script></body>
</html>
