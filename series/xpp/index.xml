<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title>xpp - series - Dynamics 365 Finance &amp; Operations | nuxulu.com</title><link>https://nuxulu.com/series/xpp/</link><description>xpp - series - Dynamics 365 Finance &amp; Operations | nuxulu.com</description><generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>luan52@outlook.com (Max Nguyen)</managingEditor><webMaster>luan52@outlook.com (Max Nguyen)</webMaster><lastBuildDate>Sat, 19 Nov 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://nuxulu.com/series/xpp/" rel="self" type="application/rss+xml"/><item><title>Developing business events with x++ from scratch</title><link>https://nuxulu.com/dev/2100-01-01-developing-business-events-with-xpp-from-scratch/</link><pubDate>Sat, 19 Nov 2022 00:00:00 +0000</pubDate><author>false</author><guid>https://nuxulu.com/dev/2100-01-01-developing-business-events-with-xpp-from-scratch/</guid><description><![CDATA[<p>Business events provide a mechanism that allow external system receives notifications from Microsoft Dynamics 365 Finance and operations.
or example – When you are posting a purchase invoice then you can send notifications/ payload / message to an external system.</p>
<p>You can use existing standard business events which are available in the D365 FO or you can also develop and customize new business events as per your need.</p>
<p></p>
<p>There are 2 ways you can consume business events:</p>
<ol>
<li>Power automate (Microsoft Flow)</li>
<li>Azure messaging services.</li>
</ol>
<h2 id="scenario">Scenario</h2>
<p>In this example, I am going to show you how we can develop a new custom business event from scratch. In my scenario, business event in D365 FO should be triggered when a user is posting purchase invoice in Microsoft dynamics 365 for finance and operations.</p>
<p>There a 2 standard and base classes which i will use to develop custom business events</p>
<ul>
<li><code>BusinessEventsContract</code> ( Use for developing/defining payload message)</li>
<li><code>BusinessEventsBase</code> ( Use for triggering custom business event)</li>
</ul>
<p>Create a <code>PAAPurchInvoiceJournalPostBusinessEventContract</code> class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="na">[DataContract]</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PAAPurchInvoiceJournalPostBusinessEventContract</span> <span class="n">extends</span> <span class="n">BusinessEventsContract</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="n">VendAccount</span> <span class="n">vendAccount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="n">PurchId</span> <span class="n">purchid</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="n">InvoiceId</span> <span class="n">invoiceId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">void</span> <span class="n">initialize</span><span class="p">(</span><span class="n">VendInvoiceJour</span> <span class="n">_vendInvoiceJour</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">vendAccount</span> <span class="p">=</span> <span class="n">_vendInvoiceJour</span><span class="p">.</span><span class="n">OrderAccount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">purchid</span> <span class="p">=</span> <span class="n">_vendInvoiceJour</span><span class="p">.</span><span class="n">PurchId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">invoiceId</span> <span class="p">=</span> <span class="n">_vendInvoiceJour</span><span class="p">.</span><span class="n">InvoiceId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="n">PAAPurchInvoiceJournalPostBusinessEventContract</span> <span class="n">newFromVendInvoiceJour</span><span class="p">(</span><span class="n">VendInvoiceJour</span> <span class="n">_vendInvoiceJour</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PAAPurchInvoiceJournalPostBusinessEventContract</span> <span class="n">contract</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PAAPurchInvoiceJournalPostBusinessEventContract</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">contract</span><span class="p">.</span><span class="n">initialize</span><span class="p">(</span><span class="n">_vendInvoiceJour</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">contract</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">void</span> <span class="k">new</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [DataMember(‘VendAccount’), BusinessEventsDataMember(‘VendAccount’)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">vendAccount</span> <span class="n">parmvendAccount</span><span class="p">(</span><span class="n">vendAccount</span> <span class="n">_vendAccount</span> <span class="p">=</span> <span class="n">vendAccount</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">vendAccount</span> <span class="p">=</span> <span class="n">_vendAccount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">vendAccount</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [DataMember(‘PurchId’), BusinessEventsDataMember(“PurchId”)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">PurchId</span> <span class="n">parmPurchId</span><span class="p">(</span><span class="n">PurchId</span> <span class="n">_purchId</span> <span class="p">=</span> <span class="n">purchId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">purchId</span> <span class="p">=</span> <span class="n">_purchId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">purchId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [DataMember(‘InvoiceId’), BusinessEventsDataMember(“InvoiceId”)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">InvoiceId</span> <span class="n">parmInvoiceId</span><span class="p">(</span><span class="n">InvoiceId</span> <span class="n">_invoiceId</span> <span class="p">=</span> <span class="n">invoiceId</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">invoiceId</span> <span class="p">=</span> <span class="n">_invoiceId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">invoiceId</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Create a <code>PAAPurchInvoiceJournalPostBusinessEvent</code> class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="na">[BusinessEvents(classStr(PAAPurchInvoiceJournalPostBusinessEventContract),
</span></span></span><span class="line"><span class="cl"><span class="na">                &#34;Custom Vendor Invoice Post Business Event&#34;,
</span></span></span><span class="line"><span class="cl"><span class="na">                &#34;This business event is triggering during the time purchase invoice posting&#34;,
</span></span></span><span class="line"><span class="cl"><span class="na">                ModuleAxapta::AccountsPayable)]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="nc">PAAPurchInvoiceJournalPostBusinessEvent</span> <span class="n">extends</span> <span class="n">BusinessEventsBase</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="n">VendInvoiceJour</span> <span class="n">vendInvoiceJour</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">static</span> <span class="k">public</span> <span class="n">PAAPurchInvoiceJournalPostBusinessEvent</span> <span class="n">newFromVendInvoiceJour</span><span class="p">(</span><span class="n">VendInvoiceJour</span> <span class="n">_vendInvoiceJour</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PAAPurchInvoiceJournalPostBusinessEvent</span> <span class="n">businessEvent</span> <span class="p">=</span> <span class="k">new</span> <span class="n">PAAPurchInvoiceJournalPostBusinessEvent</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">businessEvent</span><span class="p">.</span><span class="n">parmVendInvoiceJour</span><span class="p">(</span><span class="n">_vendInvoiceJour</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">businessEvent</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="n">VendInvoiceJour</span> <span class="n">parmVendInvoiceJour</span><span class="p">(</span><span class="n">VendInvoiceJour</span> <span class="n">_vendInvoiceJour</span> <span class="p">=</span> <span class="n">vendInvoiceJour</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">vendInvoiceJour</span> <span class="p">=</span> <span class="n">_vendInvoiceJour</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">vendInvoiceJour</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">private</span> <span class="k">void</span> <span class="k">new</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="na">
</span></span></span><span class="line"><span class="cl"><span class="na">    [Wrappable(true), Replaceable(true)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="n">BusinessEventsContract</span> <span class="n">buildContract</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">PAAPurchInvoiceJournalPostBusinessEventContract</span><span class="p">::</span><span class="n">newFromVendInvoiceJour</span><span class="p">(</span><span class="n">vendInvoiceJour</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>You must add below block of code in purchase invoice posting routine class. Also business must be activated or enabled in that company. Business event will trigger when purchase invoice posting will take place.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="n">VendInvoiceJour</span> <span class="n">vendInvoiceJour</span> <span class="p">=</span> <span class="k">this</span><span class="p">;</span> <span class="c1">// vendInvoiceJour buffer</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="n">BusinessEventsConfigurationReader</span><span class="p">::</span><span class="n">isBusinessEventEnabled</span><span class="p">(</span><span class="n">classStr</span><span class="p">(</span><span class="n">PAAPurchInvoiceJournalPostBusinessEvent</span><span class="p">)))</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">PAAPurchInvoiceJournalPostBusinessEvent</span><span class="p">::</span><span class="n">newFromVendInvoiceJour</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="n">send</span> <span class="p">()</span> <span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Build your project solution and navigate to path <code>[System administration–&gt; Setup –&gt; Business Events –&gt; Business Events Catalog]</code> to see and activate your business event.</p>
<p></p>
]]></description></item><item><title>Override Form Control Lookup</title><link>https://nuxulu.com/dev/2100-01-01-override-form-control-lookup/</link><pubDate>Wed, 16 Nov 2022 00:00:00 +0000</pubDate><author>false</author><guid>https://nuxulu.com/dev/2100-01-01-override-form-control-lookup/</guid><description><![CDATA[<h2 id="scenario">Scenario</h2>
<p>In FreeText invoice form, create a lookup invoice list of current customer in the freeText invoice line.</p>
<h3 id="copy-event-handler-method"><strong>Copy Event Handler method:</strong></h3>
<p>I created a string control for the new field and want to override <code>OnLookup</code> event.  Under the form control, go to <code>Events &gt; OnLookup &gt; right click &gt; Copy event handler method</code>.</p>
<p></p>
<h2 id="event-handler-class">Event Handler Class</h2>
<p>Create a class to project and paste code.  It will create a method with <code>FormControlEventType::Loopup</code>. This lookup will be used in another form.  So, I create another extension class sending the <code>FormControl</code>, its <code>EventAgrs</code> and <code>InvoiceAccount</code> as parameters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Handles events raised by &lt;c&gt;CustFreeInvoice&lt;/c&gt; form.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">[ExtensionOf(FormStr(CustFreeInvoice))]</span>
</span></span><span class="line"><span class="cl"><span class="n">final</span> <span class="k">public</span> <span class="k">class</span> <span class="nc">MAX_CustFreeInvoiceEventHandler_Extension</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Adds a lookup to the &lt;c&gt;RefInvId&lt;/c&gt; control on &lt;c&gt;CustInvoiceLine&lt;/c&gt; form.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;_sender&#34;&gt;The source of the event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;_e&#34;&gt;Arguments of the OnLookup event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [FormControlEventHandler(formControlStr(CustFreeInvoice, CustInvoiceLine_RefInvId), FormControlEventType::Lookup)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">CustInvoiceLine_MAX_RefInvId_OnLookup</span><span class="p">(</span><span class="n">FormControl</span> <span class="n">_sender</span><span class="p">,</span> <span class="n">FormControlEventArgs</span> <span class="n">_e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">FormRun</span>                 <span class="n">form</span> <span class="p">=</span> <span class="n">_sender</span><span class="p">.</span><span class="n">formRun</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">FormDataSource</span>          <span class="n">custInvoiceTable_ds</span> <span class="p">=</span> <span class="n">form</span><span class="p">.</span><span class="n">dataSource</span><span class="p">(</span><span class="n">formDataSourceStr</span><span class="p">(</span><span class="n">CustFreeInvoice</span><span class="p">,</span> <span class="n">CustInvoiceTable</span><span class="p">))</span> <span class="k">as</span> <span class="n">FormDataSource</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">CustInvoiceTable</span>        <span class="n">custInvoiceTable</span> <span class="p">=</span> <span class="n">custInvoiceTable_ds</span><span class="p">.</span><span class="n">cursor</span><span class="p">();</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">MAX_CustInvoiceTable_Extension</span><span class="p">::</span><span class="n">lookup_RefInvId</span><span class="p">(</span><span class="n">_sender</span><span class="p">,</span> <span class="n">_e</span><span class="p">,</span> <span class="n">custInvoiceTable</span><span class="p">.</span><span class="n">InvoiceAccount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Extend <strong>CustInvoiceTable_Extension</strong> class</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c#" data-lang="c#"><span class="line"><span class="cl"><span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// Method extension for &lt;c&gt;CustInvoiceTable&lt;/c&gt; table.</span>
</span></span><span class="line"><span class="cl"><span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">MAX_CustInvoiceTable_Extension</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// Adds an InvoiceId lookup from CustInvoiceJour.</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;/summary&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;_sender&#34;&gt;The source of the event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="cs">/// &lt;param name=&#34;_e&#34;&gt;Arguments of the OnLookup event.&lt;/param&gt;</span>
</span></span><span class="line"><span class="cl"><span class="na">    [SysClientCacheDataMethodAttribute(true)]</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">lookup_RefInvId</span><span class="p">(</span><span class="n">FormControl</span> <span class="n">_sender</span><span class="p">,</span> <span class="n">FormControlEventArgs</span> <span class="n">_e</span><span class="p">,</span> <span class="n">CustInvoiceAccount</span> <span class="n">_invoiceAccount</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SysTableLookup</span> <span class="n">sysTableLookup</span> <span class="p">=</span> <span class="n">SysTableLookup</span><span class="p">::</span><span class="n">newParameters</span><span class="p">(</span><span class="n">tablenum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">),</span> <span class="n">_sender</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Query</span> <span class="n">query</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Query</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">sysTableLookup</span><span class="p">.</span><span class="n">addLookupfield</span><span class="p">(</span><span class="n">fieldnum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">,</span> <span class="n">InvoiceId</span><span class="p">),</span> <span class="k">true</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">sysTableLookup</span><span class="p">.</span><span class="n">addLookupfield</span><span class="p">(</span><span class="n">fieldnum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">,</span> <span class="n">InvoiceAccount</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">sysTableLookup</span><span class="p">.</span><span class="n">addLookupfield</span><span class="p">(</span><span class="n">fieldnum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">,</span> <span class="n">InvoiceDate</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">QueryBuildDataSource</span> <span class="n">qbds</span> <span class="p">=</span> <span class="n">query</span><span class="p">.</span><span class="n">addDataSource</span><span class="p">(</span><span class="n">tablenum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">QueryBuildRange</span> <span class="n">qdr</span> <span class="p">=</span> <span class="n">qbds</span><span class="p">.</span><span class="n">addRange</span><span class="p">(</span><span class="n">fieldnum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">,</span> <span class="n">InvoiceAccount</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">qdr</span><span class="p">.</span><span class="k">value</span><span class="p">(</span><span class="n">queryValue</span><span class="p">(</span><span class="n">_invoiceAccount</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">qdr</span> <span class="p">=</span> <span class="n">qbds</span><span class="p">.</span><span class="n">addRange</span><span class="p">(</span><span class="n">fieldnum</span><span class="p">(</span><span class="n">CustInvoiceJour</span><span class="p">,</span> <span class="n">InvoiceId</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">qdr</span><span class="p">.</span><span class="k">value</span><span class="p">(</span><span class="n">sysQuery</span><span class="p">::</span><span class="n">valueNotEmptyString</span><span class="p">());</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">sysTableLookup</span><span class="p">.</span><span class="n">parmQuery</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">sysTableLookup</span><span class="p">.</span><span class="n">performFormLookup</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">FormControlCancelableSuperEventArgs</span> <span class="n">ce</span> <span class="p">=</span> <span class="n">_e</span> <span class="k">as</span> <span class="n">FormControlCancelableSuperEventArgs</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//cancel super() to prevent error.</span>
</span></span><span class="line"><span class="cl">        <span class="n">ce</span><span class="p">.</span><span class="n">CancelSuperCall</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>Ciellos Developer Toolbox for D365 F&amp;O - User Guide</title><link>https://nuxulu.com/dev/2100-01-01-developer-toolbox/</link><pubDate>Mon, 10 Oct 2022 00:00:00 +0000</pubDate><author>false</author><guid>https://nuxulu.com/dev/2100-01-01-developer-toolbox/</guid><description><![CDATA[<ul>
<li><a href="#1-development-tools-menu" rel="">1. <strong>Development tools menu</strong></a></li>
<li><a href="#2-development-tools-options" rel="">2. <strong>Development tools options</strong></a></li>
<li><a href="#3-development-tools" rel="">3. <strong>Development tools</strong></a>
<ul>
<li><a href="#31-create-methods-from-template" rel="">3.1. <strong>Create methods from template</strong></a>
<ul>
<li><a href="#311-create-parm--method" rel="">3.1.1. <strong>Create parm – method</strong></a></li>
<li><a href="#312-create-a-find-method-for-tables-for-primary-key" rel="">3.1.2. Create a find method for tables for primary key</a></li>
<li><a href="#313-create-find-method-for-tables-for-alternate-key" rel="">3.1.3. Create find method for tables for alternate key</a></li>
<li><a href="#314-create-exist-method-for-tables" rel="">3.1.4. Create exist method for tables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#4-create-a-data-contract-class-from-json" rel="">4. <strong>Create a Data Contract class from JSON</strong></a></li>
<li><a href="#5-create-task-comment" rel="">5. <strong>Create task comment</strong></a></li>
<li><a href="#6-create-a-label" rel="">6. <strong>Create a label</strong></a></li>
<li><a href="#7-aot-tools" rel="">7. <strong>AOT Tools</strong></a></li>
<li><a href="#8-metadata-reports" rel="">8. <strong>Metadata Reports</strong></a></li>
<li><a href="#9-data-entity-metadata" rel="">9. <strong>Data Entity Metadata</strong></a></li>
<li><a href="#10-configuration--simple-mode" rel="">10. <strong>Configuration – Simple mode</strong></a></li>
<li><a href="#11-configuration--adding-real-data" rel="">11. <strong>Configuration – Adding real data</strong></a></li>
</ul>
<p><strong>Summary</strong></p>
<p>These tools will be used in the Visual Studio development environment for improving development. Using these tools will reduce tedious processes and the productivity of developers will be increased. These tools will be applied only for Dynamics 365 for Finance and Operations (D365FFO) development framework.</p>
<p><strong>About Ciellos</strong></p>
<h6 id="000001-000at-ciellos-we-advise-and-guide-customers-and-partners-in-business-systems-change-cloud-infrastructure-and-systems-implementationdeployment-solution-development-migrations-and-upgrading-and-ongoing-support-focusing-on-microsoft-dynamics-and-azurefor-software-vendors-our-services-include-developing-and-managing-products-and-integrations-to-microsoft-dynamics-with-a-focus-on-systems-sustainability-and-rapid-go-to-market-response">0.0.0.0.0.1. 0.0.0.At Ciellos, we advise and guide customers and partners in Business Systems Change, Cloud Infrastructure and Systems Implementation/Deployment, Solution Development, Migrations and Upgrading, and Ongoing Support, focusing on Microsoft Dynamics and Azure. For software vendors, our services include developing and managing products and integrations to Microsoft Dynamics, with a focus on systems sustainability and rapid go-to market response.</h6>
<p>###### </p>
<h6 id="000002-we-welcome-the-opportunity-to-learn-more-about-your-business-and-present-options-on-how-best-to-collaborate-and-assist-with-your-business-transformation-plans-connect-with-us-via-infocielloscom-or-find-more-information-online-at-wwwcielloscomhttpwwwcielloscom">0.0.0.0.0.2. We welcome the opportunity to learn more about your business and present options on how best to collaborate and assist with your business transformation plans. Connect with us via <a href="mailto:info@ciellos.com" rel="">info@ciellos.com</a> or find more information online at <a href="http://www.ciellos.com" target="_blank" rel="noopener noreffer ">www.ciellos.com</a>.</h6>
<h6 id="000003-">0.0.0.0.0.3. <strong>​</strong></h6>
<p><strong>We focus on Microsoft Dynamics Technologies</strong>​</p>
<ul>
<li>Dynamics 365 for Finance and Operations, Retail, Talent</li>
<li>Dynamics 365 Customer Engagement (Sales, Customer Service, Field Service, PSA, Marketing)</li>
<li>Dynamics 365 Business Central</li>
<li>Dynamics AX | NAV | CRM (All Versions)</li>
<li>Power Platform (Power Apps, Power BI, Power Automate, AI Builder)</li>
<li>Azure, Azure Logic Apps, Azure DevOps, Azure Micro Services</li>
<li>Common Data Services (CDM/CDS/CDA)</li>
<li>Customer and Product Insights</li>
</ul>
<h1 id="1-development-tools-menu">1. <strong>Development tools menu</strong></h1>
<p>Dropdown menu with tools set appeared in Visual studio main menu after Dynamics 365 menu item. This menu item has ‘Ciellos D365FFO tools’</p>
<p></p>
<p>Each tool represented as a menu item drop-down menu.  Additionally, tools could be called from the user interface from the context menu. If features can’t be used in the current context menu item with this tool can be disabled.</p>
<p></p>
<h1 id="2-development-tools-options">2. <strong>Development tools options</strong></h1>
<p>Ciellos Development tools parameters are called from the ‘Options’ menu item from the Ciellos D365 Tools menu. Standard ‘Options’ form from Visual Studio is displayed in this case.</p>
<p></p>
<p>User can enable or disable a tool that will be used in Visual Studio.</p>
<h1 id="3-development-tools">3. <strong>Development tools</strong></h1>
<h2 id="31-create-methods-from-template">3.1. <strong>Create methods from template</strong></h2>
<h3 id="311-create-parm--method">3.1.1. <strong>Create parm – method</strong></h3>
<p>This tool generates a standard parm method for the current class.</p>
<p>Prerequisites:</p>
<ul>
<li>The solution must be opened;</li>
<li>The current window must be code view for one of the classes from solution;</li>
</ul>
<p>If any of the prerequisites won’t fit corresponding error message will pop up.</p>
<p>The tool could be opened from the ‘Ciellos D365FFO Tools’ menu and context menu of the code view window.</p>
<p></p>
<p>Example of context menu below</p>
<p></p>
<p>After choosing the Parm - method tool dialog form will open.</p>
<p></p>
<p>Class variables are retrieved from open class. Developer could select one or more variables and the parm method will be created for each of them. Method parameter type and type that method returns will be obtained from the class variable declaration.</p>
<p>Parm method will be created like in the picture below.</p>
<p></p>
<h3 id="312-create-a-find-method-for-tables-for-primary-key">3.1.2. Create a find method for tables for primary key</h3>
<p>This tool generates a standard find method for the D365FFO table.</p>
<p>Prerequisites:</p>
<ul>
<li>The solution must be opened;</li>
<li>The current window must be code view for table element from AOT;</li>
</ul>
<p>If any of the prerequisites won’t fit running of this tool shouldn’t be available.</p>
<p>The tool could be opened from the ‘Ciellos D365FFO Tools’ menu and context menu of the code view window.</p>
<p></p>
<p>Example of context menu below</p>
<p></p>
<p>X++ code will be created in the code window after choosing a menu item.</p>
<p></p>
<p>The procedure analyzes the primary key of this table and creates input parameters of find method regarding primary key.</p>
<p>If the surrogate key used as primary key find method will be created by RecId.</p>
<h3 id="313-create-find-method-for-tables-for-alternate-key">3.1.3. Create find method for tables for alternate key</h3>
<p>The functionality of this tool will be almost the same as for the primary key but the alternate key will be used to find method creation.</p>
<h3 id="314-create-exist-method-for-tables">3.1.4. Create exist method for tables</h3>
<p>This tool generates a standard exist method for the D365FFO table.</p>
<p>Prerequisites:</p>
<ul>
<li>The solution must be opened;</li>
<li>The current window must be code view for table element from AOT;</li>
</ul>
<p>If any of the prerequisites won’t fit running of this tool shouldn’t be available.</p>
<p>The tool could be opened from the ‘Ciellos D365FFO Tools’ menu and context menu of the code view window.</p>
<p></p>
<p>Please find the example of context menu below</p>
<p></p>
<p>X++ code will be created in the code window after choosing a menu item.</p>
<p></p>
<p>The procedure analyzes the primary key of this table and creates input parameters of exist method regarding the primary key.</p>
<p>If the surrogate key used as primary key exist method will be created by RecId.</p>
<h1 id="4-create-a-data-contract-class-from-json">4. <strong>Create a Data Contract class from JSON</strong></h1>
<p>This tool can be called only from the top-level menu. It generates standard X++ Data Contract class (or several classes) with variables and park methods by the JSON example. This class will be inserted into the current project/solution. If no open project/solution create the error message “Solution/project should be opened”</p>
<p>This tool is running from the ‘Ciellos D365FFO Tools’ menu</p>
<p></p>
<p>Tool processing is created in wizard style. Processing performs several steps:</p>
<ul>
<li>Step 1: Enter startup parameters;</li>
<li>Step 2: Preview class structure that will be created. Possibilities to change parameters</li>
<li>Step 3: Data contract class creation</li>
</ul>
<p>Form for the first step showed below</p>
<p></p>
<p>This tool could create one or more Data Contracts classed in depends on the structure of JSON. The name of the base (top-level) class will be populated in the ‘Base class name’ field. When developer press Next content of the ‘JSON’ field will be analyzed and the structure of classes will be created.</p>
<p>Form for setup 2 showed below</p>
<p></p>
<p>Parsed JSON is represented in a tree view. Here could be two types of elements: Classes and Attributes. If the element type is ‘Class’ class will be created in the current solution. If the element type is ‘Attribute’ – class member variable will be created and correspondent parm – a method for class member variable will be created.</p>
<p>We have several parameters for all elements</p>
<ul>
<li><strong>Create</strong> –applied for both element types. If value equals True – element will be created; Otherwise – element will be skipped. This value is True by default.</li>
<li><strong>Name</strong> –applied for both element types. If this is a class element here will be the class name. For root class value populates from the ‘Root class name’ field from step If this is an attribute element – here will be class member variable name. Change this value is allowed to the user.</li>
<li><strong>Type</strong> –applied only for the attributes element type. This value could be initially populated from data mapping parameters. The type could be modified by a developer. Here is used D365FFO EDT or Enum type.</li>
</ul>
<p>Form in step 3 presented below</p>
<p></p>
<p>Code of class or classes will be created after pressing the ‘Finish’ button
<strong>Initial mapping</strong>
Initial mapping for types that receive from JSON to D365FFO types are in VS Options</p>
<p></p>
<h1 id="5-create-task-comment">5. <strong>Create task comment</strong></h1>
<p>This tool generates comments for code for D365FFO elements (classes, tables, forms, etc ). This comment includes the solution name, developer name, modification date.</p>
<p>Prerequisites:</p>
<ul>
<li>The solution must be opened;</li>
<li>The current window must be code view for classes, forms, tables, SSR reports elements from AOT;</li>
</ul>
<p>If any of the prerequisites won’t fit running of this tool shouldn’t be available.</p>
<p>The tool could be opened from the ‘Ciellos D365FFO Tools’ menu and context menu of the code view window.</p>
<p></p>
<p>The following window will be opened after choosing the menu item</p>
<p></p>
<p>The solution name field is populated with the name of the current solution.</p>
<p>The developer name field is populated with the name of the developer from the VS account.</p>
<p>The developer field in comment template could set up a template of the newly created comment.</p>
<p>Here is a possibility to change all four fields.</p>
<p>Comment in X++ code will be created after pressing the OK button.</p>
<p></p>
<h1 id="6-create-a-label">6. <strong>Create a label</strong></h1>
<p>This tool generates or inserts labels to the label file from the X++ code for D365FFO elements (classes, tables, forms, etc ).</p>
<p>Prerequisites:</p>
<ul>
<li>The solution must be opened;</li>
<li>The current window must be code view for classes, forms, tables, SSR reports elements from AOT;</li>
<li>The text should be selected</li>
</ul>
<p>If any of the prerequisites won’t fit running of this tool shouldn’t be available.</p>
<p>The tool could be used after choosing a menu item.</p>
<p></p>
<p>The label is created in label files from the current project model. If there is more then one label file, it will be opened dialog form with a list of label files, where could be created label.</p>
<p></p>
<p>The text will be changed using the label id.</p>
<p></p>
<h1 id="7-aot-tools">7. <strong>AOT Tools</strong></h1>
<p>For AOT are created some manipulation tools:</p>
<ul>
<li>Copy Name</li>
<li>Copy AOT Path</li>
<li>Copy File Path</li>
<li>Create CoC</li>
</ul>
<p>The tool could be used after choosing a menu item.</p>
<p></p>
<p>Copy Name – copy the name of the AOT element.
Copy AOT Path - copy path of the element from AOT. Example: AOT/Data Model/Tables/SalesTable
Copy File Path - copy the local path of the element from the AOS folder. Example: C:\AOSService\PackagesLocalDirectory\ApplicationSuite\Foundation\AxTable\SalesTable.xml
Create CoC – the functionality for the class extension, or class augmentation, using Chain of Commands.</p>
<p><strong>Create CoC</strong></p>
<p>This tool generates a class for D365FFO elements (classes, tables, forms, etc. ), using the CoC principle.</p>
<p>The tool could be used after choosing a menu item.</p>
<p></p>
<p>Class and X++ Code will be created in the code window after choosing a menu item.</p>
<p></p>
<p><strong>ERD Diagram</strong>
This tool generates ERD Diagram flow for visualization of table relations.</p>
<p>The tool could be used after choosing a menu item.</p>
<p></p>
<p>After menu item selection will be showed dialog with parameters:</p>
<p></p>
<ul>
<li>Depth – table relation depth (warning: tool can freeze VS if the depth is too large).</li>
<li>Show country region fields – visibility of country region fields.</li>
<li>Show deleted fields - visibility of deleted fields with prefix ‘DEL_’.</li>
<li>Show Table inheritance – show tables that inherited (used dotted line).</li>
</ul>
<p>Example:</p>
<p></p>
<p>ERD Diagram can be saved selecting menu item ‘Save as’ from the context menu (right mouse click).</p>
<p></p>
<p>And diagram can be saved only as an image.</p>
<p></p>
<h1 id="8-metadata-reports">8. <strong>Metadata Reports</strong></h1>
<p></p>
<p>For now, we have only one report – Data Entity metadata</p>
<h1 id="9-data-entity-metadata">9. <strong>Data Entity Metadata</strong></h1>
<p></p>
<p>This report contains a description of each specified Data Entity. Description means, a list of fields with details, like data type, Label, Data source, and other metadata.</p>
<p>This report is good to use in Integration projects.</p>
<p>This report will generate data for any custom or extended Data Entities.</p>
<h1 id="10-configuration--simple-mode">10. <strong>Configuration – Simple mode</strong></h1>
<p></p>
<p>For simple mode, you should specify the following</p>
<ul>
<li><strong>Report type</strong>. Select “Data entity metadata”</li>
<li><strong>Specify an Excel file name with the full path</strong>, like “c:\temp\a.xlsx”</li>
<li>Specify a filter
<ul>
<li><strong>All</strong> – Will generate a report on all data entities. Please note that it may take a while.</li>
<li><strong>List of objects</strong> – Will generate a report against provided data entities. For example, “CustomerPostalAddressEntity,DirPartyLocationPostalAddressV2Entity,DirPartyContactEntity,EcoResProductV2Entity,EcoResReleasedProductV2Entity,EcoResReleasedDistinctProductV2Entity,CustCustomerV3Entity,smmContactPersonV2Entity”</li>
</ul>
</li>
<li>Click on <strong>Generate</strong> button</li>
<li>You may enrich the metadata report by adding examples of the data from a real environment. To do this, you should enable web requests. The report generator will call OData endpoints and get the first 3 lines for each Data Entity. Then these values will be inserted to the grid as Value 1, Value 2, Value 3 columns and as JSON example on the bottom on the report page.</li>
</ul>
<h1 id="11-configuration--adding-real-data">11. <strong>Configuration – Adding real data</strong></h1>
<p>You may enrich the metadata report by adding examples of the data from a real environment. To do this, you should enable web requests. The report generator will call OData endpoints and get the first 3 lines for each Data Entity. Then these values will be inserted to the grid as Value 1, Value 2, Value 3 columns and as JSON example on the bottom on the report page.</p>
<p></p>
<p>First of all, you should enable “Allow web requests”, then provide the following information</p>
<ul>
<li><strong>Host URL</strong>. URL of you D365FO instance, like “https://usnconeboxax1aos.cloud.onebox.dynamics.com”</li>
<li><strong>Tenant Id</strong>. Your tenant Id, GUID code.</li>
<li><strong>App Client Id</strong>, Azure Application Client Id, GUID code.</li>
<li><strong>App Client Secret</strong>, Azure Application secret key, like a password.</li>
</ul>
<p>Before generating a report with data examples, you should enable this Azure Application Id on the D365FO side, on the form System Administration à Setup à Azure Active Directory applications</p>
<p></p>
<p>Please find more information on how to create Azure Application here <a href="https://vmoskalenkoblog.wordpress.com/2018/06/25/reading-odata-from-dynamics-365/" target="_blank" rel="noopener noreffer ">https://vmoskalenkoblog.wordpress.com/2018/06/25/reading-odata-from-dynamics-365/</a></p>
<p>Copyright © 2019 Ciellos Inc.![A close up of a logo</p>
<p>Description automatically generated](Aspose.Words.8ab9fd81-6e1e-49ce-ae71-8fe52f0b2e0a.045.png)</p>
]]></description></item><item><title>How to use query::insert_recordset?</title><link>https://nuxulu.com/dev/2100-01-01-using-query-insert_recordset/</link><pubDate>Mon, 10 Oct 2022 00:00:00 +0000</pubDate><author>false</author><guid>https://nuxulu.com/dev/2100-01-01-using-query-insert_recordset/</guid><description><![CDATA[<p>How we can use the <code>Insert_RecordSet</code> function with Query, which is one of the batch SQL operations we frequently use in X++.</p>
<p>I want to insert two fields of all records in <code>DmrBillsIncomingHeader</code> table into <code>DmrBillsIncominTest</code> table. I have to create a Query and query the <code>DmrBillsIncomingHeader</code> table.</p>
<p>Also, which fields I want to insert, I have to mark them using Map. I should have written it with the classical method as follows.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="n">insert_recordset</span> <span class="n">billsIncominTest</span> <span class="p">(</span><span class="n">BillsIncomingId</span><span class="p">,</span> <span class="n">Description</span>  <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">select</span> <span class="n">BillsIncomingId</span><span class="p">,</span> <span class="n">Description</span> <span class="k">from</span> <span class="n">DmrBillsIncomingHeader</span> <span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now let&rsquo;s write this with Query.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="k">internal</span> <span class="n">final</span> <span class="k">class</span> <span class="nc">DmrFDJobQueryInsertRecordList</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="n">main</span><span class="p">(</span><span class="n">Args</span> <span class="n">_args</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">DmrBillsIncominTest</span>     <span class="n">billsIncominTest</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Map</span>                     <span class="n">fieldMap</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Query</span>                   <span class="n">q</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">QueryBuildDataSource</span>    <span class="n">qbdsBillsIncomingHeader</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">QueryBuildFieldList</span>     <span class="n">flBills</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">delete_from</span> <span class="n">billsIncominTest</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">q</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Query</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">qbdsBillsIncomingHeader</span> <span class="p">=</span> <span class="n">q</span><span class="p">.</span><span class="n">addDataSource</span><span class="p">(</span><span class="n">tableNum</span><span class="p">(</span><span class="n">DmrBillsIncomingHeader</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">flBills</span> <span class="p">=</span> <span class="n">qbdsBillsIncomingHeader</span><span class="p">.</span><span class="n">fields</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">flBills</span><span class="p">.</span><span class="n">addField</span><span class="p">(</span><span class="n">fieldNum</span><span class="p">(</span><span class="n">DmrBillsIncomingHeader</span><span class="p">,</span> <span class="n">BillsIncomingId</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">        <span class="n">flBills</span><span class="p">.</span><span class="n">addField</span><span class="p">(</span><span class="n">fieldNum</span><span class="p">(</span><span class="n">DmrBillsIncomingHeader</span><span class="p">,</span> <span class="n">Description</span><span class="p">));</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">fieldMap</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Map</span><span class="p">(</span><span class="n">Types</span><span class="p">::</span><span class="n">String</span><span class="p">,</span> <span class="n">Types</span><span class="p">::</span><span class="n">Container</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">fieldMap</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span> <span class="n">fieldStr</span><span class="p">(</span><span class="n">DmrBillsIncominTest</span><span class="p">,</span> <span class="n">BillsIncomingId</span><span class="p">),</span> <span class="p">[</span><span class="n">qbdsBillsIncomingHeader</span><span class="p">.</span><span class="n">uniqueId</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">fieldStr</span><span class="p">(</span><span class="n">DmrBillsIncomingHeader</span><span class="p">,</span> <span class="n">BillsIncomingId</span><span class="p">)]);</span>
</span></span><span class="line"><span class="cl">        <span class="n">fieldMap</span><span class="p">.</span><span class="n">insert</span><span class="p">(</span><span class="n">fieldStr</span><span class="p">(</span><span class="n">DmrBillsIncominTest</span><span class="p">,</span> <span class="n">Description</span><span class="p">),</span> <span class="p">[</span><span class="n">qbdsBillsIncomingHeader</span><span class="p">.</span><span class="n">uniqueId</span><span class="p">(),</span>
</span></span><span class="line"><span class="cl">                                    <span class="n">fieldStr</span><span class="p">(</span><span class="n">DmrBillsIncomingHeader</span><span class="p">,</span> <span class="n">Description</span><span class="p">)]);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">        <span class="n">query</span><span class="p">::</span><span class="n">insert_recordset</span><span class="p">(</span><span class="n">billsIncominTest</span><span class="p">,</span> <span class="n">fieldMap</span><span class="p">,</span> <span class="n">q</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item><item><title>Date time function Dynamics 365 Finance Operations</title><link>https://nuxulu.com/dev/2022-10-10-date-time-function/</link><pubDate>Wed, 28 Sep 2022 00:00:00 +0000</pubDate><author>Max Nguyen</author><guid>https://nuxulu.com/dev/2022-10-10-date-time-function/</guid><description><![CDATA[<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-C#" data-lang="C#"><span class="line"><span class="cl"><span class="p">--</span> <span class="kt">string</span> <span class="n">to</span> <span class="n">date</span> <span class="n">and</span> <span class="n">time</span>
</span></span><span class="line"><span class="cl"><span class="n">str</span> <span class="n">dateStrYMD</span> <span class="p">=</span> <span class="err">&#39;</span><span class="m">2022</span><span class="p">-</span><span class="m">04</span><span class="p">-</span><span class="m">12</span><span class="n">T13</span><span class="p">:</span><span class="m">34</span><span class="p">:</span><span class="m">30</span><span class="err">&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">UtcDateTime</span> <span class="n">datetime</span> <span class="p">=</span> <span class="n">DateTimeUtil</span><span class="p">::</span><span class="n">anyToDateTime</span><span class="p">(</span><span class="n">dateStrYMD</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">--</span> <span class="n">Year</span> <span class="n">difference</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">timeDiff</span> <span class="p">=</span> <span class="n">Global</span><span class="p">::</span><span class="n">yearDiff</span><span class="p">(</span><span class="n">DateTimeUtil</span><span class="p">::</span><span class="n">getSystemDateTime</span><span class="p">(),</span> <span class="n">DateTimeUtil</span><span class="p">::</span><span class="n">date</span><span class="p">(</span><span class="n">_myTable</span><span class="p">.</span><span class="n">myUTCDateTime</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">--</span> <span class="n">datetime</span> <span class="n">compare</span>
</span></span><span class="line"><span class="cl"><span class="n">DateTimeUtil</span><span class="p">::</span><span class="n">newDateTime</span><span class="p">(</span><span class="n">today</span><span class="p">()-</span><span class="m">3</span><span class="p">,</span> <span class="m">0</span><span class="p">,</span> <span class="n">DateTimeUtil</span><span class="p">::</span><span class="n">getCompanyTimeZone</span><span class="p">())</span> <span class="p">&gt;</span> <span class="n">datetime</span>
</span></span></code></pre></td></tr></table>
</div>
</div>]]></description></item></channel></rss>