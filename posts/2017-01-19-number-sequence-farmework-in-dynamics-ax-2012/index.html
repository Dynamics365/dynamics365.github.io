<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Number sequence farmework overview in Dynamics AX 2012 | Dynamics 365 Finance Operations & Power Platform</title><meta name=keywords content="X++,numbersequence,programming"><meta name=description content="
For this demo, I will create New module along with NumberSequence, about creating Number Sequence without module you also use same steps just leave some steps base on Design picture above.
ETD
Create ETD ContosoId extends num datatype.
Table
Create Contoso Table with ContosoId field.
Enum
Create a new enum value Contoso in BaseEnum NumberSeqModule.
This value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form."><meta name=author content="Max Nguyen"><link rel=canonical href=https://nuxulu.com/posts/2017-01-19-number-sequence-farmework-in-dynamics-ax-2012/><link href=/assets/css/stylesheet.min.css rel="preload stylesheet" as=style><link rel=icon href=https://nuxulu.com/Icon/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://nuxulu.com/Icon/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://nuxulu.com/Icon/favicon-32x32.png><link rel=apple-touch-icon href=https://nuxulu.com/Icon/favicon-32x32.png><link rel=mask-icon href=https://nuxulu.com/Icon/favicon-16x16.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.83.1"><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-57379422-3','auto'),ga('send','pageview'))</script><script async src=https://www.google-analytics.com/analytics.js></script><meta property="og:title" content="Number sequence farmework overview in Dynamics AX 2012"><meta property="og:description" content="
For this demo, I will create New module along with NumberSequence, about creating Number Sequence without module you also use same steps just leave some steps base on Design picture above.
ETD
Create ETD ContosoId extends num datatype.
Table
Create Contoso Table with ContosoId field.
Enum
Create a new enum value Contoso in BaseEnum NumberSeqModule.
This value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form."><meta property="og:type" content="article"><meta property="og:url" content="https://nuxulu.com/posts/2017-01-19-number-sequence-farmework-in-dynamics-ax-2012/"><meta property="og:image" content="https://nuxulu.com/47"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-01-19T00:00:00+00:00"><meta property="article:modified_time" content="2017-01-19T00:00:00+00:00"><meta property="og:site_name" content="Dynamics 365 Finance Operations & Power Platform"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://nuxulu.com/47"><meta name=twitter:title content="Number sequence farmework overview in Dynamics AX 2012"><meta name=twitter:description content="
For this demo, I will create New module along with NumberSequence, about creating Number Sequence without module you also use same steps just leave some steps base on Design picture above.
ETD
Create ETD ContosoId extends num datatype.
Table
Create Contoso Table with ContosoId field.
Enum
Create a new enum value Contoso in BaseEnum NumberSeqModule.
This value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Posts","item":"https://nuxulu.com/posts/"},{"@type":"ListItem","position":3,"name":"Number sequence farmework overview in Dynamics AX 2012","item":"https://nuxulu.com/posts/2017-01-19-number-sequence-farmework-in-dynamics-ax-2012/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Number sequence farmework overview in Dynamics AX 2012","name":"Number sequence farmework overview in Dynamics AX 2012","description":"For this demo, I will create New module along with NumberSequence, about creating Number Sequence without module you also use same steps just leave some steps base on Design picture above.\nETD Create ETD ContosoId extends num datatype.\nTable Create Contoso Table with ContosoId field.\nEnum Create a new enum value Contoso in BaseEnum NumberSeqModule.\nThis value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form.\n","keywords":["X++","numbersequence","programming"],"articleBody":"For this demo, I will create New module along with NumberSequence, about creating Number Sequence without module you also use same steps just leave some steps base on Design picture above.\nETD Create ETD ContosoId extends num datatype.\nTable Create Contoso Table with ContosoId field.\nEnum Create a new enum value Contoso in BaseEnum NumberSeqModule.\nThis value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form.\nNumberSeqModule Class Create NumberSeqModuleXXX class\nCreate a new NumberSeqModuleXXX class, such as NumberSeqModuleContoso, which extends the NumberSeqApplicationModule class. The sample code for creating this class is as follows:\n{% highlight csharp %} public class NumberSeqModuleContoso extends NumberSeqApplicationModule { }\nprotected void loadModule() { NumberSeqDatatype datatype = NumberSeqDatatype::construct(); ;\n/* Contoso Id */\rdatatype.parmDatatypeId(extendedtypenum(ContosoId));\rdatatype.parmReferenceHelp(\"ContosoId\");\rdatatype.parmWizardIsContinuous(true);\rdatatype.parmWizardIsManual(NoYes::No);\rdatatype.parmWizardIsChangeDownAllowed(NoYes::No);\rdatatype.parmWizardIsChangeUpAllowed(NoYes::No);\rdatatype.parmWizardHighest(999999);\rdatatype.addParameterType(NumberSeqParameterType::DataArea, true, false);\rthis.create(datatype);\r }\npublic NumberSeqModule numberSeqModule() { ; return NumberSeqModule::Contoso; } {% endhighlight %}\nUse of the DataArea segment in Step 4 to describe the default segment for the extended data types used for ContosoId.\nNote In Microsoft Dynamics AX 2009, number sequence references could be initialized by restarting the Application Object Server (AOS). In Microsoft Dynamics AX 2012, the initialization of references to populate the NumberSequenceDatatype and NumberSequenceParameterType tables has moved to the initialization checklist. To initialize the newly created references, run a job that executes the LoadModule method likes below.\n{% highlight csharp %} static void loadNumSeq (Args _args) { //define the class variable NumberSeqModuleContoso seqMod = new NumberSeqModuleContoso (); //load the number sequences that were not generated seqMod.load(); } {% endhighlight %}\nYou can also reinitialize all references by running a job that executes the LoadAll method in the NumberSequenceModuleSetup class. However, for reinitializing all references, you must ensure that there are no existing number sequences already defined in the system.\nThen run the wizard in Organization Administration  CommonForms  Numbersequences  Numbersequences  Generate  run the wizard.\nParameters Table and Form Create a Number sequences page in the parameters form of the new module.\nYou need to Create ContosoParameters Table along with form, See existing forms such as CustParameters or LedgerParameters for examples of the implementation.\nThese forms are using DetailsFormMaster form parten as Best Practice for Setup form.\nCreate ContosoParameters Table   Add field key, Extends from ParametersKey\n  Properties on Field key Visible = false, AllowEdit = false, AllowEditOnCreate = false\n  Create index name Key with AllowDuplicate = No.\n  Set table properties.\n  TableContent = Default data\n  ConfigurationKey\n  CacheLookup = Found\n  TableGroup = Parameter\n  PrimaryKey = Key\n  ClusterKey = Key\n  The sample code for creating method this table as below:\n{% highlight csharp %} void delete() { throw error(\"@SYS23721\"); } public void initValue() { ; super(); // Key is set to mandatory so set it to 1 this.Key = 1; } static ContosoParameters find(boolean _forupdate = false) { ContosoParameters parameter;\nif (_forupdate)\r{\rparameter.selectForUpdate(_forupdate);\r}\rselect firstonly RecId from parameter\rwhere parameter.Key == 1;\rif (!parameter \u0026\u0026 !parameter.isTmp())\r{\rCompany::createParameter(parameter);\r}\rreturn parameter;\r } client server static NumberSeqModule numberSeqModule() { ; return NumberSeqModule::Contoso; } public server static NumberSequenceReference numRefContosoId() { ; NumberSeqScopeFactory::CreateDataAreaScope(curext()); return NumberSeqReference::findReference(extendedtypenum (ContosoId));\n} {% endhighlight %}\nCreate ContosoParameters form Note This form can only be used for references that have a scope of DataArea. The administration forms described in the Setup and Administration of number sequences section can be used for references that have any scope. These forms can be found in Organization Administration  Common  Number Sequences\nThe data source of Parameters form likes picture below, you can also refer to CustParameters form for design.\nCode example for form methods:\n{% highlight csharp %} public class FormRun extends ObjectRun { NumberSeqReference numberSeqReference; boolean runExecuteDirect; TmpIdRef tmpIdRef; NumberSeqScope scope; NumberSeqApplicationModule numberSeqApplicationModule; container numberSequenceModules; }\nvoid init() { ; this.numberSeqPreInit(); super(); ContosoParameters::find(); this.numberSeqPostInit(); }\nvoid numberSeqPostInit() { numberSequenceReference_ds.object(fieldNum(NumberSequenceReference, AllowSameAs)).visible(numberSeqApplicationModule.sameAsActive()); referenceSameAsLabel.visible(numberSeqApplicationModule.sameAsActive()); }\nvoid numberSeqPreInit() { ; runExecuteDirect = false;\nnumberSequenceModules = [NumberSeqModule::Contoso];\rnumberSeqApplicationModule = new NumberSeqModuleContoso ();\rscope = NumberSeqScopeFactory::createDataAreaScope();\rNumberSeqApplicationModule::createReferencesMulti(numberSequenceModules, scope);\rtmpIdRef.setTmpData(NumberSequenceReference::configurationKeyTableMulti(numberSequenceModules));\r } {% endhighlight %}\nCode example for NumberSequenceReference data source methods\n{% highlight csharp %} void removeFilter() { ; runExecuteDirect = false; numbersequenceReference_ds.executeQuery(); }\nvoid executeQuery() { if (runExecuteDirect) { super(); } else { runExecuteDirect = true; this.queryRun(NumberSeqReference::buildQueryRunMulti(numberSequenceReference, tmpIdRef, numberSequenceTable, numberSequenceModules, scope)); numbersequenceReference_ds.research(); } } {% endhighlight %}\nHow to use on Table Set number sequence in Contoso Table\n{% highlight csharp %} private void setContosoId() { NumberSeq num; NumberSequenceReference numberSequenceReference; ; numberSequenceReference = CVRParameters::numRefContosoId();\nif (numberSequenceReference)\r{\rnum = NumberSeq::newGetNum(numberSequenceReference);\rthis.Id = num.num();\r}\r } {% endhighlight %}\nOptional method – in case you don’t want to expose Number sequence on Form Level\n{% highlight csharp %} public void initValue() { ; super();\n// Initialise the title id\rthis. setContosoId ();\r }\npublic void insert() { ; if(!this.Id) { this. setContosoId (); }\nsuper();\r } {% endhighlight %}\nFrom now on you can create new record in Contoso Table with number sequence.\nHow to use on Form How to use on form level (In case you don’t want to expose NS in Table Level)\n In the class declaration of the form that will be accessing data, add a variable declaration for the number sequence handler. The following example shows the variable definition for a number sequence handler.  {% highlight csharp %} public class FormRun extends ObjectRun { NumberSeqFormHandler numberSeqFormHandlerContosoId; } {% endhighlight %}\n Add the NumberSeqFormHandler method to the form. The code in this method will create an instance of the number sequence form handler and return it.  {% highlight csharp %} public NumberSeqFormHandler numSeqFormHandlerContosoId() { if (!numberSeqFormHandlerContosoId) { numberSeqFormHandlerContosoId = NumberSeqFormHandler::newForm(ContosoParameters:: numRefContosoId().NumberSequenceId, element, Contoso_ds, fieldNum(Contoso, ContosoId) ); } return numberSeqFormHandlerContosoId; } {% endhighlight %}\n Add create, delete, and write methods to the data source of the table that contains the field for which the number sequence is being used. The following code examples show these methods that are added to the data source for the Contoso table to support the number sequence for the ContosoId field.  {% highlight csharp %} public void create(boolean _append = false) { //before create, (ensure the number seuence has not run out of numbers) element.numSeqFormHandlerContosoId().formMethodDataSourceCreatePre();\n// start: inherited table code\r// we need to let the create happen so the user can\r// choose the type\rsuper(_append);\r//number sequence, create action, (get next number)\relement.numSeqFormHandlerContosoId().formMethodDataSourceCreate();\r } public void delete() { //release the number sequence value. element. numSeqFormHandlerContosoId().formMethodDataSourceDelete();\n//delete the record\rsuper();\r } public void write() { super(); element. numSeqFormHandlerContosoId().formMethodDataSourceWrite(); }\npublic boolean validateWrite() { boolean ret; ret = super(); ret = element.numberSeqFormHandler().formMethodDataSourceValidateWrite(ret) \u0026\u0026 ret; if (ret) { Contoso.validateWrite(); } return ret; } Link Active() public void linkActive() { ; element.numberSeqFormHandler().formMethodDataSourceLinkActive(); super(); } {% endhighlight %}\nOptional method Continuous sequence\nTo avoid having gaps for continuous sequence you should add this code to the delete of the table.\n{% highlight csharp %} public void delete() { super(); NumberSeq::releaseNumber(ContosoParameters::numRefContosoId().NumberSequenceId, this.ContosoId); } {% endhighlight %}\nTesting Testing Number sequence by Job\n{% highlight csharp %} static void Max_numberSeqRefCustAccount(Args _args) { NumberSequenceReference numberSeqRefCustAccount = CustParameters::numRefCustAccount(); NumberSeq numSeqCustAccount; try { //Use the TTS level to decide whether sequence is consumed or not. ttsBegin; if (numberSeqRefCustAccount) { numSeqCustAccount = NumberSeq::newGetNum(numberSeqRefCustAccount); if (numSeqCustAccount) { info(numSeqCustAccount.num()); } } ttsCommit; } catch (Exception::Error) { info(“Caught ‘Exception::Error’.\"); } } {% endhighlight %}\nThank you for reading!\n","wordCount":"1201","inLanguage":"en","datePublished":"2017-01-19T00:00:00Z","dateModified":"2017-01-19T00:00:00Z","author":{"@type":"Person","name":"Max Nguyen"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://nuxulu.com/posts/2017-01-19-number-sequence-farmework-in-dynamics-ax-2012/"},"publisher":{"@type":"Organization","name":"Dynamics 365 Finance Operations \u0026 Power Platform","logo":{"@type":"ImageObject","url":"https://nuxulu.com/Icon/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:#1d1e20;--entry:#2e2e33;--primary:rgba(255, 255, 255, 0.84);--secondary:rgba(255, 255, 255, 0.56);--tertiary:rgba(255, 255, 255, 0.16);--content:rgba(255, 255, 255, 0.74);--hljs-bg:#2e2e33;--code-bg:#37383e;--border:#333}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><header class=header><nav class=nav><div class=logo><a href=https://nuxulu.com accesskey=h title="Dynamics 365 & Power Platform (Alt + H)"><img src=/Icon//favicon-32x32.png alt=logo aria-label=logo height=35>Dynamics 365 & Power Platform</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()><li><a href=https://nuxulu.com/archives/ title=Archive><span>Archive</span></a></li><li><a href=https://nuxulu.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://nuxulu.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://nuxulu.com/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://nuxulu.com>Home</a>&nbsp;»&nbsp;<a href=https://nuxulu.com/posts/>Posts</a></div><h1 class=post-title>Number sequence farmework overview in Dynamics AX 2012</h1><div class=post-meta>January 19, 2017&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Max Nguyen
|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts%5c2017-01-19-number-sequence-farmework-in-Dynamics-AX-2012.markdown rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><div class=details>Table of Contents</div></summary><div class=inner><ul><li><a href=#etd aria-label=ETD>ETD</a></li><li><a href=#table aria-label=Table>Table</a></li><li><a href=#enum aria-label=Enum>Enum</a></li><li><a href=#numberseqmodule-class aria-label="NumberSeqModule Class">NumberSeqModule Class</a></li><li><a href=#parameters-table-and-form aria-label="Parameters Table and Form">Parameters Table and Form</a><ul><li><a href=#create-contosoparameters-table aria-label="Create ContosoParameters Table">Create <code>ContosoParameters</code> Table</a></li><li><a href=#create-contosoparameters-form aria-label="Create ContosoParameters form">Create <code>ContosoParameters</code> form</a></li></ul></li><li><a href=#how-to-use-on-table aria-label="How to use on Table">How to use on Table</a></li><li><a href=#how-to-use-on-form aria-label="How to use on Form">How to use on Form</a></li><li><a href=#optional-method aria-label="Optional method">Optional method</a></li><li><a href=#testing aria-label=Testing>Testing</a></li></ul></div></details></div><div class=post-content><p>For this demo, I will create New module along with NumberSequence, about creating Number Sequence <em>without</em> module you also use same steps just leave some steps base on Design picture above.</p><h2 id=etd>ETD<a hidden class=anchor aria-hidden=true href=#etd>#</a></h2><p>Create ETD <code>ContosoId</code> extends <code>num</code> datatype.</p><h2 id=table>Table<a hidden class=anchor aria-hidden=true href=#table>#</a></h2><p>Create <code>Contoso</code> Table with <code>ContosoId</code> field.</p><h2 id=enum>Enum<a hidden class=anchor aria-hidden=true href=#enum>#</a></h2><p>Create a new enum value <code>Contoso</code> in BaseEnum <code>NumberSeqModule</code>.</p><p>This value will be used to link number sequence to the module and to restrict displayed number sequence by module in Form.</p><h2 id=numberseqmodule-class>NumberSeqModule Class<a hidden class=anchor aria-hidden=true href=#numberseqmodule-class>#</a></h2><p>Create <code>NumberSeqModuleXXX</code> class</p><p>Create a new <code>NumberSeqModuleXXX</code> class, such as <code>NumberSeqModuleContoso</code>, which extends the <code>NumberSeqApplicationModule</code> class. The sample code for creating this class is as follows:</p><p>{% highlight csharp %}
public class NumberSeqModuleContoso extends NumberSeqApplicationModule
{
}</p><p>protected void loadModule()
{
NumberSeqDatatype datatype = NumberSeqDatatype::construct();
;</p><pre><code>/* Contoso Id */
datatype.parmDatatypeId(extendedtypenum(ContosoId));
datatype.parmReferenceHelp(&quot;ContosoId&quot;);
datatype.parmWizardIsContinuous(true);
datatype.parmWizardIsManual(NoYes::No);
datatype.parmWizardIsChangeDownAllowed(NoYes::No);
datatype.parmWizardIsChangeUpAllowed(NoYes::No);
datatype.parmWizardHighest(999999);
datatype.addParameterType(NumberSeqParameterType::DataArea, true, false);
this.create(datatype);
</code></pre><p>}</p><p>public NumberSeqModule numberSeqModule()
{
;
return NumberSeqModule::Contoso;
}
{% endhighlight %}</p><p>Use of the <code>DataArea</code> segment in <em>Step 4</em> to describe the default segment for the extended data types used for <code>ContosoId</code>.</p><p>Note In <strong>Microsoft Dynamics AX 2009</strong>, number sequence references could be initialized by restarting the Application Object Server (AOS). In <strong>Microsoft Dynamics AX 2012</strong>, the initialization of references to populate the <code>NumberSequenceDatatype</code> and <code>NumberSequenceParameterType</code> tables has moved to the initialization checklist. To initialize the newly created references, run a job that executes the <code>LoadModule</code> method likes below.</p><p>{% highlight csharp %}
static void loadNumSeq (Args _args)
{
//define the class variable
NumberSeqModuleContoso seqMod = new NumberSeqModuleContoso ();
//load the number sequences that were not generated
seqMod.load();
}
{% endhighlight %}</p><p>You can also reinitialize all references by running a job that executes the <code>LoadAll</code> method in the <code>NumberSequenceModuleSetup</code> class. However, for reinitializing all references, you must ensure that there are no existing number sequences already defined in the system.</p><p>Then run the wizard in <em>Organization Administration > CommonForms > Numbersequences > Numbersequences > Generate > run the wizard</em>.</p><h2 id=parameters-table-and-form>Parameters Table and Form<a hidden class=anchor aria-hidden=true href=#parameters-table-and-form>#</a></h2><p>Create a Number sequences page in the parameters form of the new module.</p><p>You need to Create <code>ContosoParameters</code> Table along with form, See existing forms such as <code>CustParameters</code> or <code>LedgerParameters</code> for examples of the implementation.</p><p><em>These forms are using <strong>DetailsFormMaster</strong> form parten as Best Practice for Setup form.</em></p><h3 id=create-contosoparameters-table>Create <code>ContosoParameters</code> Table<a hidden class=anchor aria-hidden=true href=#create-contosoparameters-table>#</a></h3><ul><li><p>Add field key, Extends from <code>ParametersKey</code></p></li><li><p>Properties on Field key Visible = false, AllowEdit = false, AllowEditOnCreate = false</p></li><li><p>Create index name Key with AllowDuplicate = No.</p></li><li><p>Set table properties.</p></li><li><p>TableContent = Default data</p></li><li><p>ConfigurationKey</p></li><li><p>CacheLookup = Found</p></li><li><p>TableGroup = Parameter</p></li><li><p>PrimaryKey = Key</p></li><li><p>ClusterKey = Key</p></li></ul><p>The sample code for creating method this table as below:</p><p>{% highlight csharp %}
void delete()
{
throw error("@SYS23721");
}
public void initValue()
{
;
super();
// Key is set to mandatory so set it to 1
this.Key = 1;
}
static ContosoParameters find(boolean _forupdate = false)
{
ContosoParameters parameter;</p><pre><code>if (_forupdate)
{
	parameter.selectForUpdate(_forupdate);
}

select firstonly RecId from parameter
	where parameter.Key == 1;

if (!parameter &amp;&amp; !parameter.isTmp())
{
	Company::createParameter(parameter);
}

return parameter;
</code></pre><p>}
client server static NumberSeqModule numberSeqModule()
{
;
return NumberSeqModule::Contoso;
}
public server static NumberSequenceReference numRefContosoId()
{
;
NumberSeqScopeFactory::CreateDataAreaScope(curext());
return NumberSeqReference::findReference(extendedtypenum (ContosoId));</p><p>}
{% endhighlight %}</p><h3 id=create-contosoparameters-form>Create <code>ContosoParameters</code> form<a hidden class=anchor aria-hidden=true href=#create-contosoparameters-form>#</a></h3><p>Note This form can only be used for references that have a scope of DataArea. The administration forms described in the Setup and Administration of number sequences section can be used for references that have any scope. These forms can be found in <em>Organization Administration > Common > Number Sequences</em></p><p>The data source of Parameters form likes picture below, you can also refer to <code>CustParameters</code> form for design.</p><p>Code example for form methods:</p><p>{% highlight csharp %}
public class FormRun extends ObjectRun
{
NumberSeqReference numberSeqReference;
boolean runExecuteDirect;
TmpIdRef tmpIdRef;
NumberSeqScope scope;
NumberSeqApplicationModule numberSeqApplicationModule;
container numberSequenceModules;
}</p><p>void init()
{
;
this.numberSeqPreInit();
super();
ContosoParameters::find();
this.numberSeqPostInit();
}</p><p>void numberSeqPostInit()
{
numberSequenceReference_ds.object(fieldNum(NumberSequenceReference, AllowSameAs)).visible(numberSeqApplicationModule.sameAsActive());
referenceSameAsLabel.visible(numberSeqApplicationModule.sameAsActive());
}</p><p>void numberSeqPreInit()
{
;
runExecuteDirect = false;</p><pre><code>numberSequenceModules       = [NumberSeqModule::Contoso];
numberSeqApplicationModule  = new NumberSeqModuleContoso ();
scope                       = NumberSeqScopeFactory::createDataAreaScope();
NumberSeqApplicationModule::createReferencesMulti(numberSequenceModules, scope);

tmpIdRef.setTmpData(NumberSequenceReference::configurationKeyTableMulti(numberSequenceModules));
</code></pre><p>}
{% endhighlight %}</p><p>Code example for <code>NumberSequenceReference</code> data source methods</p><p>{% highlight csharp %}
void removeFilter()
{
;
runExecuteDirect = false;
numbersequenceReference_ds.executeQuery();
}</p><p>void executeQuery()
{
if (runExecuteDirect)
{
super();
}
else
{
runExecuteDirect = true;
this.queryRun(NumberSeqReference::buildQueryRunMulti(numberSequenceReference,
tmpIdRef,
numberSequenceTable,
numberSequenceModules,
scope));
numbersequenceReference_ds.research();
}
}
{% endhighlight %}</p><h2 id=how-to-use-on-table>How to use on Table<a hidden class=anchor aria-hidden=true href=#how-to-use-on-table>#</a></h2><p>Set number sequence in Contoso Table</p><p>{% highlight csharp %}
private void setContosoId()
{
NumberSeq num;
NumberSequenceReference numberSequenceReference;
;
numberSequenceReference = CVRParameters::numRefContosoId();</p><pre><code>if (numberSequenceReference)
{
	num = NumberSeq::newGetNum(numberSequenceReference);
	this.Id = num.num();
}
</code></pre><p>}
{% endhighlight %}</p><p>Optional method – in case you don’t want to expose Number sequence on Form Level</p><p>{% highlight csharp %}
public void initValue()
{
;
super();</p><pre><code>// Initialise the title id
this. setContosoId ();
</code></pre><p>}</p><p>public void insert()
{
;
if(!this.Id)
{
this. setContosoId ();
}</p><pre><code>super();
</code></pre><p>}
{% endhighlight %}</p><p>From now on you can create new record in Contoso Table with number sequence.</p><h2 id=how-to-use-on-form>How to use on Form<a hidden class=anchor aria-hidden=true href=#how-to-use-on-form>#</a></h2><p>How to use on form level (In case you don’t want to expose NS in Table Level)</p><ul><li>In the class declaration of the form that will be accessing data, add a variable declaration for the number sequence handler. The following example shows the variable definition for a number sequence handler.</li></ul><p>{% highlight csharp %}
public class FormRun extends ObjectRun
{
NumberSeqFormHandler numberSeqFormHandlerContosoId;
}
{% endhighlight %}</p><ul><li>Add the <code>NumberSeqFormHandler</code> method to the form. The code in this method will create an instance of the number sequence form handler and return it.</li></ul><p>{% highlight csharp %}
public NumberSeqFormHandler numSeqFormHandlerContosoId()
{
if (!numberSeqFormHandlerContosoId)
{
numberSeqFormHandlerContosoId = NumberSeqFormHandler::newForm(ContosoParameters:: numRefContosoId().NumberSequenceId,
element,
Contoso_ds,
fieldNum(Contoso, ContosoId)
);
}
return numberSeqFormHandlerContosoId;
}
{% endhighlight %}</p><ul><li>Add <strong>create, delete, and write</strong> methods to the data source of the table that contains the field for which the number sequence is being used. The following code examples show these methods that are added to the data source for the Contoso table to support the number sequence for the <code>ContosoId</code> field.</li></ul><p>{% highlight csharp %}
public void create(boolean _append = false)
{
//before create, (ensure the number seuence has not run out of numbers)
element.numSeqFormHandlerContosoId().formMethodDataSourceCreatePre();</p><pre><code>// start: inherited table code
// we need to let the create happen so the user can
// choose the type
super(_append);

//number sequence, create action, (get next number)
element.numSeqFormHandlerContosoId().formMethodDataSourceCreate();
</code></pre><p>}
public void delete()
{
//release the number sequence value.
element. numSeqFormHandlerContosoId().formMethodDataSourceDelete();</p><pre><code>//delete the record
super();
</code></pre><p>}
public void write()
{
super();
element. numSeqFormHandlerContosoId().formMethodDataSourceWrite();
}</p><p>public boolean validateWrite()
{
boolean ret;
ret = super();
ret = element.numberSeqFormHandler().formMethodDataSourceValidateWrite(ret) && ret;
if (ret)
{
Contoso.validateWrite();
}
return ret;
}
Link Active()
public void linkActive()
{
;
element.numberSeqFormHandler().formMethodDataSourceLinkActive();
super();
}
{% endhighlight %}</p><h2 id=optional-method>Optional method<a hidden class=anchor aria-hidden=true href=#optional-method>#</a></h2><p>Continuous sequence</p><p>To avoid having gaps for continuous sequence you should add this code to the delete of the table.</p><p>{% highlight csharp %}
public void delete()
{
super();
NumberSeq::releaseNumber(ContosoParameters::numRefContosoId().NumberSequenceId, this.ContosoId);
}
{% endhighlight %}</p><h2 id=testing>Testing<a hidden class=anchor aria-hidden=true href=#testing>#</a></h2><p>Testing Number sequence by Job</p><p>{% highlight csharp %}
static void Max_numberSeqRefCustAccount(Args _args)
{
NumberSequenceReference numberSeqRefCustAccount = CustParameters::numRefCustAccount();
NumberSeq numSeqCustAccount;
try
{
//Use the TTS level to decide whether sequence is consumed or not.
ttsBegin;
if (numberSeqRefCustAccount)
{
numSeqCustAccount = NumberSeq::newGetNum(numberSeqRefCustAccount);
if (numSeqCustAccount)
{
info(numSeqCustAccount.num());
}
}
ttsCommit;
}
catch (Exception::Error)
{
info(&ldquo;Caught &lsquo;Exception::Error&rsquo;.");
}
}
{% endhighlight %}</p><p>Thank you for reading!</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://nuxulu.com/tags/x++/>X++</a></li><li><a href=https://nuxulu.com/tags/numbersequence/>numbersequence</a></li><li><a href=https://nuxulu.com/tags/programming/>programming</a></li></ul><nav class=paginav><a class=prev href=https://nuxulu.com/posts/2017-03-29-how-to-create-main-menu-in-dynamics-ax-2012/><span class=title>« Prev Page</span><br><span>How to create main menu in Dynamics AX 2012</span></a>
<a class=next href=https://nuxulu.com/posts/2017-01-19-overview-delete-action-in-dyanmics-ax-2012/><span class=title>Next Page »</span><br><span>Overview delete action in Dyanmics AX 2012</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on twitter" href="https://twitter.com/intent/tweet/?text=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012&url=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f&hashtags=X%2b%2b%2cnumbersequence%2cprogramming"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f&title=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012&summary=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012&source=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on reddit" href="https://reddit.com/submit?url=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f&title=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on whatsapp" href="https://api.whatsapp.com/send?text=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012%20-%20https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Number sequence farmework overview in Dynamics AX 2012 on telegram" href="https://telegram.me/share/url?text=Number%20sequence%20farmework%20overview%20in%20Dynamics%20AX%202012&url=https%3a%2f%2fnuxulu.com%2fposts%2f2017-01-19-number-sequence-farmework-in-dynamics-ax-2012%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2021 <a href=https://nuxulu.com>Dynamics 365 Finance Operations & Power Platform</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script>window.onload=function(){localStorage.getItem("menu-scroll-position")&&(document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position"))};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft)}document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script></body></html>